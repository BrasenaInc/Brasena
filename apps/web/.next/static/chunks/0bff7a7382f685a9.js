(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,20670,e=>{"use strict";let t;var i,s,r,a,n,l,o,h,u,c,d,p,_,f,v,b,w,y,m,g,S,R,O,k,E=e.i(53425),x=e.i(73987),C=e.i(10704),M=e.i(243),T=e.i(97663);function q(){return(q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e}).apply(this,arguments)}var W=e.i(15424),P=e.i(94388),Q=e.i(53940),j=e.i(75091),U=e.i(50342),F=e.i(3994),I=e.i(55324),D=e.i(86523),A=e.i(40976),L=(i=new WeakMap,s=new WeakMap,r=new WeakMap,a=new WeakMap,n=new WeakMap,l=new WeakMap,o=new WeakMap,h=new WeakMap,u=new WeakMap,c=new WeakMap,d=new WeakMap,p=new WeakMap,_=new WeakMap,f=new WeakMap,v=new WeakMap,b=new WeakSet,w=new WeakSet,y=new WeakSet,m=new WeakSet,g=new WeakSet,S=new WeakSet,R=new WeakSet,O=new WeakSet,k=new WeakSet,class extends F.Subscribable{bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&((0,E._)(this,s).addObserver(this),H((0,E._)(this,s),this.options)?(0,M._)(this,b,z).call(this):this.updateResult(),(0,M._)(this,g,X).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return K((0,E._)(this,s),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return K((0,E._)(this,s),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,(0,M._)(this,S,Y).call(this),(0,M._)(this,R,Z).call(this),(0,E._)(this,s).removeObserver(this)}setOptions(e){let t=this.options,r=(0,E._)(this,s);if(this.options=(0,E._)(this,i).defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,D.resolveEnabled)(this.options.enabled,(0,E._)(this,s)))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");(0,M._)(this,O,$).call(this),(0,E._)(this,s).setOptions(this.options),t._defaulted&&!(0,D.shallowEqualObjects)(this.options,t)&&(0,E._)(this,i).getQueryCache().notify({type:"observerOptionsUpdated",query:(0,E._)(this,s),observer:this});let a=this.hasListeners();a&&B((0,E._)(this,s),r,this.options,t)&&(0,M._)(this,b,z).call(this),this.updateResult(),a&&((0,E._)(this,s)!==r||(0,D.resolveEnabled)(this.options.enabled,(0,E._)(this,s))!==(0,D.resolveEnabled)(t.enabled,(0,E._)(this,s))||(0,D.resolveStaleTime)(this.options.staleTime,(0,E._)(this,s))!==(0,D.resolveStaleTime)(t.staleTime,(0,E._)(this,s)))&&(0,M._)(this,w,V).call(this);let n=(0,M._)(this,y,G).call(this);a&&((0,E._)(this,s)!==r||(0,D.resolveEnabled)(this.options.enabled,(0,E._)(this,s))!==(0,D.resolveEnabled)(t.enabled,(0,E._)(this,s))||n!==(0,E._)(this,f))&&(0,M._)(this,m,J).call(this,n)}getOptimisticResult(e){var t,r;let o=(0,E._)(this,i).getQueryCache().build((0,E._)(this,i),e),h=this.createResult(o,e);return t=this,r=h,(0,D.shallowEqualObjects)(t.getCurrentResult(),r)||((0,C._)(this,a,h),(0,C._)(this,l,this.options),(0,C._)(this,n,(0,E._)(this,s).state)),h}getCurrentResult(){return(0,E._)(this,a)}trackResult(e,t){return new Proxy(e,{get:(e,i)=>(this.trackProp(i),null==t||t(i),"promise"===i&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==(0,E._)(this,o).status||(0,E._)(this,o).reject(Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,i))})}trackProp(e){(0,E._)(this,v).add(e)}getCurrentQuery(){return(0,E._)(this,s)}refetch(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,[t={}]=[e],{}=t,i=q({},t);return this.fetch((0,W._)({},i))}fetchOptimistic(e){let t=(0,E._)(this,i).defaultQueryOptions(e),s=(0,E._)(this,i).getQueryCache().build((0,E._)(this,i),t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){var t;return(0,M._)(this,b,z).call(this,(0,P._)((0,W._)({},e),{cancelRefetch:null==(t=e.cancelRefetch)||t})).then(()=>(this.updateResult(),(0,E._)(this,a)))}createResult(e,t){let i,p=(0,E._)(this,s),_=this.options,f=(0,E._)(this,a),v=(0,E._)(this,n),b=(0,E._)(this,l),w=e!==p?e.state:(0,E._)(this,r),{state:y}=e,m=(0,W._)({},y),g=!1;if(t._optimisticResults){let i=this.hasListeners(),s=!i&&H(e,t),r=i&&B(e,p,t,_);(s||r)&&(m=(0,W._)({},m,(0,U.fetchState)(y.data,e.options))),"isRestoring"===t._optimisticResults&&(m.fetchStatus="idle")}let{error:S,errorUpdatedAt:R,status:O}=m;i=m.data;let k=!1;if(void 0!==t.placeholderData&&void 0===i&&"pending"===O){let e;if((null==f?void 0:f.isPlaceholderData)&&t.placeholderData===(null==b?void 0:b.placeholderData))e=f.data,k=!0;else{var x;e="function"==typeof t.placeholderData?t.placeholderData(null==(x=(0,E._)(this,d))?void 0:x.state.data,(0,E._)(this,d)):t.placeholderData}void 0!==e&&(O="success",i=(0,D.replaceData)(null==f?void 0:f.data,e,t),g=!0)}if(t.select&&void 0!==i&&!k)if(f&&i===(null==v?void 0:v.data)&&t.select===(0,E._)(this,u))i=(0,E._)(this,c);else try{(0,C._)(this,u,t.select),i=t.select(i),i=(0,D.replaceData)(null==f?void 0:f.data,i,t),(0,C._)(this,c,i),(0,C._)(this,h,null)}catch(e){(0,C._)(this,h,e)}(0,E._)(this,h)&&(S=(0,E._)(this,h),i=(0,E._)(this,c),R=Date.now(),O="error");let M="fetching"===m.fetchStatus,T="pending"===O,q="error"===O,P=T&&M,Q=void 0!==i,j={status:O,fetchStatus:m.fetchStatus,isPending:T,isSuccess:"success"===O,isError:q,isInitialLoading:P,isLoading:P,data:i,dataUpdatedAt:m.dataUpdatedAt,error:S,errorUpdatedAt:R,failureCount:m.fetchFailureCount,failureReason:m.fetchFailureReason,errorUpdateCount:m.errorUpdateCount,isFetched:m.dataUpdateCount>0||m.errorUpdateCount>0,isFetchedAfterMount:m.dataUpdateCount>w.dataUpdateCount||m.errorUpdateCount>w.errorUpdateCount,isFetching:M,isRefetching:M&&!T,isLoadingError:q&&!Q,isPaused:"paused"===m.fetchStatus,isPlaceholderData:g,isRefetchError:q&&Q,isStale:N(e,t),refetch:this.refetch,promise:(0,E._)(this,o),isEnabled:!1!==(0,D.resolveEnabled)(t.enabled,e)};if(this.options.experimental_prefetchInRender){let t=void 0!==j.data,i="error"===j.status&&!t,s=e=>{i?e.reject(j.error):t&&e.resolve(j.data)},r=()=>{s((0,C._)(this,o,j.promise=(0,I.pendingThenable)()))},a=(0,E._)(this,o);switch(a.status){case"pending":e.queryHash===p.queryHash&&s(a);break;case"fulfilled":(i||j.data!==a.value)&&r();break;case"rejected":i&&j.error===a.reason||r()}}return j}updateResult(){let e=(0,E._)(this,a),t=this.createResult((0,E._)(this,s),this.options);if((0,C._)(this,n,(0,E._)(this,s).state),(0,C._)(this,l,this.options),void 0!==(0,E._)(this,n).data&&(0,C._)(this,d,(0,E._)(this,s)),(0,D.shallowEqualObjects)(t,e))return;(0,C._)(this,a,t);let i=()=>{if(!e)return!0;let{notifyOnChangeProps:t}=this.options,i="function"==typeof t?t():t;if("all"===i||!i&&!(0,E._)(this,v).size)return!0;let s=new Set(null!=i?i:(0,E._)(this,v));return this.options.throwOnError&&s.add("error"),Object.keys((0,E._)(this,a)).some(t=>(0,E._)(this,a)[t]!==e[t]&&s.has(t))};(0,M._)(this,k,ee).call(this,{listeners:i()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&(0,M._)(this,g,X).call(this)}constructor(e,t){super(),(0,T._)(this,b),(0,T._)(this,w),(0,T._)(this,y),(0,T._)(this,m),(0,T._)(this,g),(0,T._)(this,S),(0,T._)(this,R),(0,T._)(this,O),(0,T._)(this,k),(0,x._)(this,i,{writable:!0,value:void 0}),(0,x._)(this,s,{writable:!0,value:void 0}),(0,x._)(this,r,{writable:!0,value:void 0}),(0,x._)(this,a,{writable:!0,value:void 0}),(0,x._)(this,n,{writable:!0,value:void 0}),(0,x._)(this,l,{writable:!0,value:void 0}),(0,x._)(this,o,{writable:!0,value:void 0}),(0,x._)(this,h,{writable:!0,value:void 0}),(0,x._)(this,u,{writable:!0,value:void 0}),(0,x._)(this,c,{writable:!0,value:void 0}),(0,x._)(this,d,{writable:!0,value:void 0}),(0,x._)(this,p,{writable:!0,value:void 0}),(0,x._)(this,_,{writable:!0,value:void 0}),(0,x._)(this,f,{writable:!0,value:void 0}),(0,x._)(this,v,{writable:!0,value:new Set}),this.options=t,(0,C._)(this,i,e),(0,C._)(this,h,null),(0,C._)(this,o,(0,I.pendingThenable)()),this.bindMethods(),this.setOptions(t)}});function H(e,t){return!1!==(0,D.resolveEnabled)(t.enabled,e)&&void 0===e.state.data&&("error"!==e.state.status||!1!==t.retryOnMount)||void 0!==e.state.data&&K(e,t,t.refetchOnMount)}function K(e,t,i){if(!1!==(0,D.resolveEnabled)(t.enabled,e)&&"static"!==(0,D.resolveStaleTime)(t.staleTime,e)){let s="function"==typeof i?i(e):i;return"always"===s||!1!==s&&N(e,t)}return!1}function B(e,t,i,s){return(e!==t||!1===(0,D.resolveEnabled)(s.enabled,e))&&(!i.suspense||"error"!==e.state.status)&&N(e,i)}function N(e,t){return!1!==(0,D.resolveEnabled)(t.enabled,e)&&e.isStaleByTime((0,D.resolveStaleTime)(t.staleTime,e))}function z(e){(0,M._)(this,O,$).call(this);let t=(0,E._)(this,s).fetch(this.options,e);return(null==e?void 0:e.throwOnError)||(t=t.catch(D.noop)),t}function V(){(0,M._)(this,S,Y).call(this);let e=(0,D.resolveStaleTime)(this.options.staleTime,(0,E._)(this,s));if(D.isServer||(0,E._)(this,a).isStale||!(0,D.isValidTimeout)(e))return;let t=(0,D.timeUntilStale)((0,E._)(this,a).dataUpdatedAt,e);(0,C._)(this,p,A.timeoutManager.setTimeout(()=>{(0,E._)(this,a).isStale||this.updateResult()},t+1))}function G(){var e;return null!=(e="function"==typeof this.options.refetchInterval?this.options.refetchInterval((0,E._)(this,s)):this.options.refetchInterval)&&e}function J(e){(0,M._)(this,R,Z).call(this),(0,C._)(this,f,e),!D.isServer&&!1!==(0,D.resolveEnabled)(this.options.enabled,(0,E._)(this,s))&&(0,D.isValidTimeout)((0,E._)(this,f))&&0!==(0,E._)(this,f)&&(0,C._)(this,_,A.timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||Q.focusManager.isFocused())&&(0,M._)(this,b,z).call(this)},(0,E._)(this,f)))}function X(){(0,M._)(this,w,V).call(this),(0,M._)(this,m,J).call(this,(0,M._)(this,y,G).call(this))}function Y(){(0,E._)(this,p)&&(A.timeoutManager.clearTimeout((0,E._)(this,p)),(0,C._)(this,p,void 0))}function Z(){(0,E._)(this,_)&&(A.timeoutManager.clearInterval((0,E._)(this,_)),(0,C._)(this,_,void 0))}function $(){let e=(0,E._)(this,i).getQueryCache().build((0,E._)(this,i),this.options);if(e===(0,E._)(this,s))return;let t=(0,E._)(this,s);(0,C._)(this,s,e),(0,C._)(this,r,e.state),this.hasListeners()&&(null==t||t.removeObserver(this),e.addObserver(this))}function ee(e){j.notifyManager.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e((0,E._)(this,a))}),(0,E._)(this,i).getQueryCache().notify({query:(0,E._)(this,s),type:"observerResultsUpdated"})})}e.i(12174);var et=e.i(68645),ei=e.i(51980);e.i(26557);var es=et.createContext((t=!1,{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t})),er=et.createContext(!1);er.Provider;var ea=(e,t,i)=>t.fetchOptimistic(e).catch(()=>{i.clearReset()});function en(e,t){return function(e,t,i){var s,r,a,n;let l,o=et.useContext(er),h=et.useContext(es),u=(0,ei.useQueryClient)(i),c=u.defaultQueryOptions(e);null==(r=u.getDefaultOptions().queries)||null==(s=r._experimental_beforeQuery)||s.call(r,c);let d=u.getQueryCache().get(c.queryHash);if(c._optimisticResults=o?"isRestoring":"optimistic",c.suspense){let e=e=>"static"===e?e:Math.max(null!=e?e:1e3,1e3),t=c.staleTime;c.staleTime="function"==typeof t?function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return e(t(...s))}:e(t),"number"==typeof c.gcTime&&(c.gcTime=Math.max(c.gcTime,1e3))}l=(null==d?void 0:d.state.error)&&"function"==typeof c.throwOnError?(0,D.shouldThrowError)(c.throwOnError,[d.state.error,d]):c.throwOnError,(c.suspense||c.experimental_prefetchInRender||l)&&!h.isReset()&&(c.retryOnMount=!1),et.useEffect(()=>{h.clearReset()},[h]);let p=!u.getQueryCache().get(c.queryHash),[_]=et.useState(()=>new t(u,c)),f=_.getOptimisticResult(c),v=!o&&!1!==e.subscribed;if(et.useSyncExternalStore(et.useCallback(e=>{let t=v?_.subscribe(j.notifyManager.batchCalls(e)):D.noop;return _.updateResult(),t},[_,v]),()=>_.getCurrentResult(),()=>_.getCurrentResult()),et.useEffect(()=>{_.setOptions(c)},[c,_]),(null==c?void 0:c.suspense)&&f.isPending)throw ea(c,_,h);if((e=>{let{result:t,errorResetBoundary:i,throwOnError:s,query:r,suspense:a}=e;return t.isError&&!i.isReset()&&!t.isFetching&&r&&(a&&void 0===t.data||(0,D.shouldThrowError)(s,[t.error,r]))})({result:f,errorResetBoundary:h,throwOnError:c.throwOnError,query:d,suspense:c.suspense}))throw f.error;if(null==(n=u.getDefaultOptions().queries)||null==(a=n._experimental_afterQuery)||a.call(n,c,f),c.experimental_prefetchInRender&&!D.isServer&&f.isLoading&&f.isFetching&&!o){let e=p?ea(c,_,h):null==d?void 0:d.promise;null==e||e.catch(D.noop).finally(()=>{_.updateResult()})}return c.notifyOnChangeProps?f:_.trackResult(f)}(e,L,t)}e.s(["useQuery",()=>en],20670)},73650,e=>{"use strict";var t=e.i(15424),i=e.i(94388),s=e.i(20670),r=e.i(71386);function a(e,s){var r,a;let n=[...s].sort((e,t)=>e.weight_lbs-t.weight_lbs),l=null!=(r=null==(a=n[0])?void 0:a.price_per_lb)?r:0,o=n.map(e=>{let s=e.weight_lbs*e.price_per_lb,r=e.weight_lbs*l,a=r-s;return(0,i._)((0,t._)({},e),{total_price:s,savings_amount:a,savings_percent:l>0?a/r*100:0})});return(0,i._)((0,t._)({},e),{weight_tiers:o})}function n(e){let t=(0,r.useSupabase)(),{data:i,isLoading:n,error:l}=(0,s.useQuery)({queryKey:["products",null!=e?e:"all"],queryFn:async()=>{let i=t.from("products").select("*").eq("in_stock",!0).order("created_at",{ascending:!1}).limit(12);e&&"All"!==e&&(i=i.eq("category",e));let{data:s,error:r}=await i;if(r)throw r;if(!(null==s?void 0:s.length))return[];let n=s.map(e=>e.id),{data:l,error:o}=await t.from("weight_tiers").select("*").in("product_id",n).order("weight_lbs",{ascending:!0});if(o)throw o;let h=(null!=l?l:[]).reduce((e,t)=>(e[t.product_id]||(e[t.product_id]=[]),e[t.product_id].push(t),e),{});return s.map(e=>{var t;let i=null!=(t=h[e.id])?t:[];return a(e,i)})}});return{data:i,isLoading:n,error:l}}function l(e){let t=(0,r.useSupabase)(),{data:i,isLoading:n,error:l}=(0,s.useQuery)({queryKey:["product",e],queryFn:async()=>{let{data:i,error:s}=await t.from("products").select("*").eq("slug",e).maybeSingle();if(s)throw s;if(!i)return;let{data:r,error:n}=await t.from("weight_tiers").select("*").eq("product_id",i.id).order("weight_lbs",{ascending:!0});if(n)throw n;return a(i,null!=r?r:[])},enabled:!!e});return{data:i,isLoading:n,error:l}}function o(){let e=(0,r.useSupabase)(),{data:t,isLoading:i,error:n}=(0,s.useQuery)({queryKey:["featured-product"],queryFn:async()=>{let{data:t,error:i}=await e.from("products").select("*").eq("featured",!0).eq("in_stock",!0).limit(1).maybeSingle();if(i)throw i;if(!t)return;let{data:s,error:r}=await e.from("weight_tiers").select("*").eq("product_id",t.id).order("weight_lbs",{ascending:!0});if(r)throw r;return a(t,null!=s?s:[])}});return{data:t,isLoading:i,error:n}}function h(){let e=(0,r.useSupabase)(),{data:t,isLoading:i,error:a}=(0,s.useQuery)({queryKey:["active-promotion"],queryFn:async()=>{let{data:t,error:i}=await e.from("promotions").select("*").eq("is_active",!0).gt("expires_at",new Date().toISOString()).limit(1).maybeSingle();if(i){if("42P01"===i.code)return null;throw i}return t}});return{data:t,isLoading:i,error:a}}e.s(["useActivePromotion",()=>h,"useFeaturedProduct",()=>o,"useProduct",()=>l,"useProducts",()=>n])},82579,e=>{"use strict";var t=e.i(26557),i=e.i(37621),s=e.i(593),r=e.i(73650);e.i(67547);var a=e.i(80714),n=e.i(51795);function l(){var e;let l=(0,i.useParams)(),o="string"==typeof l.slug?l.slug:"",{data:h,isLoading:u}=(0,r.useProduct)(o);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.TopNav,{backHref:s.ROUTES.SHOP,title:null!=(e=null==h?void 0:h.name)?e:"Product",showCart:!0}),(0,t.jsxs)("main",{className:"flex-1 p-4",children:[u&&(0,t.jsx)("p",{style:{color:"var(--text3)"},children:"Loading…"}),!u&&h&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-display font-semibold",style:{color:"var(--text-primary)"},children:h.name}),(0,t.jsx)("p",{className:"text-sm mt-1",style:{color:"var(--text3)"},children:"Product detail — Sprint 4."})]}),!u&&!h&&o&&(0,t.jsx)("p",{style:{color:"var(--text3)"},children:"Product not found."})]}),(0,t.jsx)(n.BottomNav,{})]})}e.s(["default",()=>l])}]);