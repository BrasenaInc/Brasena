(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52132,e=>{"use strict";var r=e.i(15424),s=e.i(26557),t=e.i(68645),a=e.i(33201),l=e.i(37621),i=e.i(22233),d=e.i(43217),o=e.i(70718),n=e.i(78600),m=e.i(593),c=e.i(28256),u=e.i(71386),x=e.i(24415),p=e.i(52629),g=e.i(94545),h=e.i(41217),b=e.i(50898);let f={name:"",email:"",phone:"",password:"",profileType:"residential",preferredLanguage:"en",birthday:"",deliveryAddress:{street:"",apt:"",city:"",state:"",zip:""},agreeToTerms:!1};function y(){var e,y,v,j,N,w,A,F,S,_,T,C,L,E;let O=(0,l.useRouter)(),{t:q}=(0,c.useLanguage)(),z=(0,u.useSupabase)(),[P,k]=(0,t.useState)(!1),[R,U]=(0,t.useState)(null),{register:B,handleSubmit:I,watch:D,setValue:G,formState:{errors:H,isSubmitting:K}}=(0,i.useForm)({resolver:(0,d.zodResolver)(x.signupWithAddressSchema),defaultValues:f}),W=D("preferredLanguage");async function Z(e){U(null);try{var r,s;let{data:t,error:a}=await z.auth.signUp({email:e.email,password:e.password,options:{data:{name:e.name,phone:e.phone,profile_type:"residential",preferred_language:e.preferredLanguage}}});if(a)return void U(a.message);let l=null==(s=t.user)?void 0:s.id;if(!l)return void U("Account created but session not found. Please sign in.");let i=new Date().toISOString(),d={id:l,email:e.email,full_name:e.name,phone:e.phone,role:"customer",profile_type:"residential",preferred_language:e.preferredLanguage,created_at:i,updated_at:i},{error:o}=await z.from("profiles").insert(d);if(o)return void U(o.message);let n={user_id:l,street:e.deliveryAddress.street,apt:e.deliveryAddress.apt||null,city:e.deliveryAddress.city,state:e.deliveryAddress.state,zip:e.deliveryAddress.zip,instructions:null!=(r=e.deliveryAddress.instructions)?r:null,is_default:!0},{error:c}=await z.from("addresses").insert(n);if(c)return void U(c.message);O.push(m.ROUTES.SHOP)}catch(e){U(e instanceof Error?e.message:"Something went wrong")}}return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"mb-6 flex justify-center",children:(0,s.jsx)(p.BrasenaLogo,{size:"sm"})}),(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)(a.default,{href:m.ROUTES.SIGNUP,className:"text-text-secondary hover:text-brand-sage text-sm font-medium min-h-touch flex items-center",children:"← Back"}),(0,s.jsx)(a.default,{href:m.ROUTES.LOGIN,className:"text-text-secondary hover:text-brand-sage text-sm font-medium min-h-touch flex items-center",children:"Sign in"})]}),(0,s.jsx)("p",{className:"text-brand-sage text-sm font-medium mb-6",children:q("signup.step2")}),(0,s.jsx)("h1",{className:"font-display text-2xl font-semibold text-text-primary mb-1",children:"Tell us about yourself"}),(0,s.jsx)("p",{className:"text-text-secondary text-base mb-6",children:"We'll use this for delivery and account security."}),(0,s.jsxs)("form",{onSubmit:I(Z),className:"flex flex-col gap-4",children:[(0,s.jsx)(g.FormField,(0,r._)({label:"Full name",required:!0,error:null==(e=H.name)?void 0:e.message},B("name"))),(0,s.jsx)(g.FormField,(0,r._)({label:"Email address",type:"email",autoComplete:"email",required:!0,error:null==(y=H.email)?void 0:y.message},B("email"))),(0,s.jsx)(g.FormField,(0,r._)({label:"Phone number",type:"tel",autoComplete:"tel",required:!0,error:null==(v=H.phone)?void 0:v.message},B("phone"))),(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-text-primary mb-1.5",children:["Password ",(0,s.jsx)("span",{className:"text-brand-sage ml-0.5",children:"*"})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",(0,r._)({type:P?"text":"password",autoComplete:"new-password",className:(0,b.cn)("input pr-12",H.password&&"border-[color:var(--color-error)]")},B("password"))),(0,s.jsx)("button",{type:"button",onClick:()=>k(e=>!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-primary min-h-touch min-w-touch flex items-center justify-center","aria-label":P?"Hide password":"Show password",children:P?(0,s.jsx)(n.EyeOff,{className:"w-5 h-5"}):(0,s.jsx)(o.Eye,{className:"w-5 h-5"})})]}),H.password&&(0,s.jsx)("p",{role:"alert",className:"mt-1.5 text-sm text-[color:var(--color-error)]",children:H.password.message})]}),(0,s.jsx)(g.FormField,(0,r._)({label:"Birthday",type:"date",required:!0,error:null==(j=H.birthday)?void 0:j.message},B("birthday"))),(0,s.jsxs)("fieldset",{className:"space-y-3",children:[(0,s.jsx)("legend",{className:"text-sm font-medium text-text-primary",children:"Delivery address"}),(0,s.jsx)(g.FormField,(0,r._)({label:"Street",required:!0,error:null==(w=H.deliveryAddress)||null==(N=w.street)?void 0:N.message},B("deliveryAddress.street"))),(0,s.jsx)(g.FormField,(0,r._)({label:"Apt, suite (optional)",error:null==(F=H.deliveryAddress)||null==(A=F.apt)?void 0:A.message},B("deliveryAddress.apt"))),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(g.FormField,(0,r._)({label:"City",required:!0,error:null==(_=H.deliveryAddress)||null==(S=_.city)?void 0:S.message},B("deliveryAddress.city"))),(0,s.jsx)(g.FormField,(0,r._)({label:"State",required:!0,error:null==(C=H.deliveryAddress)||null==(T=C.state)?void 0:T.message},B("deliveryAddress.state")))]}),(0,s.jsx)(g.FormField,(0,r._)({label:"ZIP code",required:!0,error:null==(E=H.deliveryAddress)||null==(L=E.zip)?void 0:L.message},B("deliveryAddress.zip")))]}),(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("span",{className:"block text-sm font-medium text-text-primary mb-2",children:"Language preference"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:()=>G("preferredLanguage","en"),className:(0,b.cn)("flex-1 py-3 rounded-xl font-medium min-h-touch border transition-all","en"===W?"bg-brand-sage/20 border-brand-sage text-brand-sage":"bg-surface-muted border-surface-border text-text-secondary hover:border-brand-sage/40"),children:"English"}),(0,s.jsx)("button",{type:"button",onClick:()=>G("preferredLanguage","es"),className:(0,b.cn)("flex-1 py-3 rounded-xl font-medium min-h-touch border transition-all","es"===W?"bg-brand-sage/20 border-brand-sage text-brand-sage":"bg-surface-muted border-surface-border text-text-secondary hover:border-brand-sage/40"),children:"Español"})]})]}),(0,s.jsxs)("label",{className:"flex items-start gap-3 cursor-pointer",children:[(0,s.jsx)("input",(0,r._)({type:"checkbox",className:"mt-1 w-5 h-5 rounded border-surface-border bg-surface-muted text-brand-sage focus:ring-brand-sage"},B("agreeToTerms"))),(0,s.jsx)("span",{className:"text-sm text-text-secondary",children:"I agree to the terms of service and privacy policy"})]}),H.agreeToTerms&&(0,s.jsx)("p",{role:"alert",className:"text-sm text-[color:var(--color-error)]",children:H.agreeToTerms.message}),R&&(0,s.jsx)("p",{role:"alert",className:"text-sm text-[color:var(--color-error)]",children:R}),(0,s.jsx)("button",{type:"submit",disabled:K,className:"btn-primary w-full flex items-center justify-center gap-2 min-h-touch",children:K?(0,s.jsx)(h.Spinner,{size:"sm",color:"white"}):"Create account"})]})]})}e.s(["default",()=>y])}]);