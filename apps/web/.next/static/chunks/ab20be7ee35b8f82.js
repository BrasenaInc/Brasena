(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,25101,e=>{"use strict";var s=e.i(15424),r=e.i(26557),t=e.i(68645),a=e.i(33201),i=e.i(37621),l=e.i(22233),d=e.i(43217),n=e.i(70718),o=e.i(78600),m=e.i(593),u=e.i(28256),c=e.i(71386),x=e.i(24415),p=e.i(52629),b=e.i(94545),g=e.i(41217),f=e.i(50898);let h={name:"",email:"",phone:"",password:"",profileType:"business",preferredLanguage:"en",businessName:"",ein:"",birthday:"",deliveryAddress:{street:"",apt:"",city:"",state:"",zip:""},agreeToTerms:!1};function y(){var e,y,v,j,N,w,F,_,A,S,T,q,E,C,L,O;let z=(0,i.useRouter)(),{t:B}=(0,u.useLanguage)(),I=(0,c.useSupabase)(),[P,k]=(0,t.useState)(!1),[R,U]=(0,t.useState)(null),{register:D,handleSubmit:G,watch:H,setValue:K,formState:{errors:W,isSubmitting:Z}}=(0,l.useForm)({resolver:(0,d.zodResolver)(x.signupWithAddressSchema),defaultValues:h}),J=H("preferredLanguage");async function M(e){if(U(null),"business"!==e.profileType||!e.businessName||!e.ein)return void U("Business name and EIN are required.");try{var s,r;let{data:t,error:a}=await I.auth.signUp({email:e.email,password:e.password,options:{data:{name:e.name,phone:e.phone,profile_type:"business",preferred_language:e.preferredLanguage}}});if(a)return void U(a.message);let i=null==(r=t.user)?void 0:r.id;if(!i)return void U("Account created but session not found. Please sign in.");let l=new Date().toISOString(),d={id:i,email:e.email,full_name:e.name,phone:e.phone,role:"customer",profile_type:"business",preferred_language:e.preferredLanguage,created_at:l,updated_at:l},{error:n}=await I.from("profiles").insert(d);if(n)return void U(n.message);let o={user_id:i,business_name:e.businessName,ein:e.ein,verified:!1},{error:u}=await I.from("business_profiles").insert(o);if(u)return void U(u.message);let c={user_id:i,street:e.deliveryAddress.street,apt:e.deliveryAddress.apt||null,city:e.deliveryAddress.city,state:e.deliveryAddress.state,zip:e.deliveryAddress.zip,instructions:null!=(s=e.deliveryAddress.instructions)?s:null,is_default:!0},{error:x}=await I.from("addresses").insert(c);if(x)return void U(x.message);z.push(m.ROUTES.SHOP)}catch(e){U(e instanceof Error?e.message:"Something went wrong")}}return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mb-6 flex justify-center",children:(0,r.jsx)(p.BrasenaLogo,{size:"sm"})}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)(a.default,{href:m.ROUTES.SIGNUP,className:"text-text-secondary hover:text-brand-sage text-sm font-medium min-h-touch flex items-center",children:"← Back"}),(0,r.jsx)(a.default,{href:m.ROUTES.LOGIN,className:"text-text-secondary hover:text-brand-sage text-sm font-medium min-h-touch flex items-center",children:"Sign in"})]}),(0,r.jsx)("p",{className:"text-brand-sage text-sm font-medium mb-6",children:B("signup.step2")}),(0,r.jsx)("h1",{className:"font-display text-2xl font-semibold text-text-primary mb-1",children:"Tell us about your business"}),(0,r.jsx)("p",{className:"text-text-secondary text-base mb-6",children:"We'll use this for delivery and account security."}),(0,r.jsxs)("form",{onSubmit:G(M),className:"flex flex-col gap-4",children:[(0,r.jsx)(b.FormField,(0,s._)({label:"Full name",required:!0,error:null==(e=W.name)?void 0:e.message},D("name"))),(0,r.jsx)(b.FormField,(0,s._)({label:"Business name",required:!0,error:null==(y=W.businessName)?void 0:y.message},D("businessName"))),(0,r.jsx)(b.FormField,(0,s._)({label:"Business EIN / Tax ID",required:!0,error:null==(v=W.ein)?void 0:v.message},D("ein"))),(0,r.jsx)(b.FormField,(0,s._)({label:"Email address",type:"email",autoComplete:"email",required:!0,error:null==(j=W.email)?void 0:j.message},D("email"))),(0,r.jsx)(b.FormField,(0,s._)({label:"Phone number",type:"tel",autoComplete:"tel",required:!0,error:null==(N=W.phone)?void 0:N.message},D("phone"))),(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-text-primary mb-1.5",children:["Password ",(0,r.jsx)("span",{className:"text-brand-sage ml-0.5",children:"*"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",(0,s._)({type:P?"text":"password",autoComplete:"new-password",className:(0,f.cn)("input pr-12",W.password&&"border-[color:var(--color-error)]")},D("password"))),(0,r.jsx)("button",{type:"button",onClick:()=>k(e=>!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-primary min-h-touch min-w-touch flex items-center justify-center","aria-label":P?"Hide password":"Show password",children:P?(0,r.jsx)(o.EyeOff,{className:"w-5 h-5"}):(0,r.jsx)(n.Eye,{className:"w-5 h-5"})})]}),W.password&&(0,r.jsx)("p",{role:"alert",className:"mt-1.5 text-sm text-[color:var(--color-error)]",children:W.password.message})]}),(0,r.jsx)(b.FormField,(0,s._)({label:"Birthday",type:"date",required:!0,error:null==(w=W.birthday)?void 0:w.message},D("birthday"))),(0,r.jsxs)("fieldset",{className:"space-y-3",children:[(0,r.jsx)("legend",{className:"text-sm font-medium text-text-primary",children:"Delivery address"}),(0,r.jsx)(b.FormField,(0,s._)({label:"Street",required:!0,error:null==(_=W.deliveryAddress)||null==(F=_.street)?void 0:F.message},D("deliveryAddress.street"))),(0,r.jsx)(b.FormField,(0,s._)({label:"Apt, suite (optional)",error:null==(S=W.deliveryAddress)||null==(A=S.apt)?void 0:A.message},D("deliveryAddress.apt"))),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(b.FormField,(0,s._)({label:"City",required:!0,error:null==(q=W.deliveryAddress)||null==(T=q.city)?void 0:T.message},D("deliveryAddress.city"))),(0,r.jsx)(b.FormField,(0,s._)({label:"State",required:!0,error:null==(C=W.deliveryAddress)||null==(E=C.state)?void 0:E.message},D("deliveryAddress.state")))]}),(0,r.jsx)(b.FormField,(0,s._)({label:"ZIP code",required:!0,error:null==(O=W.deliveryAddress)||null==(L=O.zip)?void 0:L.message},D("deliveryAddress.zip")))]}),(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)("span",{className:"block text-sm font-medium text-text-primary mb-2",children:"Language preference"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{type:"button",onClick:()=>K("preferredLanguage","en"),className:(0,f.cn)("flex-1 py-3 rounded-xl font-medium min-h-touch border transition-all","en"===J?"bg-brand-sage/20 border-brand-sage text-brand-sage":"bg-surface-muted border-surface-border text-text-secondary hover:border-brand-sage/40"),children:"English"}),(0,r.jsx)("button",{type:"button",onClick:()=>K("preferredLanguage","es"),className:(0,f.cn)("flex-1 py-3 rounded-xl font-medium min-h-touch border transition-all","es"===J?"bg-brand-sage/20 border-brand-sage text-brand-sage":"bg-surface-muted border-surface-border text-text-secondary hover:border-brand-sage/40"),children:"Español"})]})]}),(0,r.jsxs)("label",{className:"flex items-start gap-3 cursor-pointer",children:[(0,r.jsx)("input",(0,s._)({type:"checkbox",className:"mt-1 w-5 h-5 rounded border-surface-border bg-surface-muted text-brand-sage focus:ring-brand-sage"},D("agreeToTerms"))),(0,r.jsx)("span",{className:"text-sm text-text-secondary",children:"I agree to the terms of service and privacy policy"})]}),W.agreeToTerms&&(0,r.jsx)("p",{role:"alert",className:"text-sm text-[color:var(--color-error)]",children:W.agreeToTerms.message}),R&&(0,r.jsx)("p",{role:"alert",className:"text-sm text-[color:var(--color-error)]",children:R}),(0,r.jsx)("button",{type:"submit",disabled:Z,className:"btn-primary w-full flex items-center justify-center gap-2 min-h-touch",children:Z?(0,r.jsx)(g.Spinner,{size:"sm",color:"white"}):"Create account"})]})]})}e.s(["default",()=>y])}]);