module.exports=[19866,(a,b,c)=>{"use strict";let d;Object.defineProperty(c,"__esModule",{value:!0}),c.parseCookie=l,c.parse=l,c.stringifyCookie=function(a,b){let c=b?.encode||encodeURIComponent,d=[];for(let b of Object.keys(a)){let g=a[b];if(void 0===g)continue;if(!e.test(b))throw TypeError(`cookie name is invalid: ${b}`);let h=c(g);if(!f.test(h))throw TypeError(`cookie val is invalid: ${g}`);d.push(`${b}=${h}`)}return d.join("; ")},c.stringifySetCookie=m,c.serialize=m,c.parseSetCookie=function(a,b){let c=b?.decode||q,d=a.length,e=n(a,0,d),f=o(a,0,e),g=-1===f?{name:"",value:c(p(a,0,e))}:{name:p(a,0,f),value:c(p(a,f+1,e))},h=e+1;for(;h<d;){let b=n(a,h,d),c=o(a,h,b),e=-1===c?p(a,h,b):p(a,h,c),f=-1===c?void 0:p(a,c+1,b);switch(e.toLowerCase()){case"httponly":g.httpOnly=!0;break;case"secure":g.secure=!0;break;case"partitioned":g.partitioned=!0;break;case"domain":g.domain=f;break;case"path":g.path=f;break;case"max-age":f&&i.test(f)&&(g.maxAge=Number(f));break;case"expires":if(!f)break;let j=new Date(f);Number.isFinite(j.valueOf())&&(g.expires=j);break;case"priority":if(!f)break;let k=f.toLowerCase();("low"===k||"medium"===k||"high"===k)&&(g.priority=k);break;case"samesite":if(!f)break;let l=f.toLowerCase();("lax"===l||"strict"===l||"none"===l)&&(g.sameSite=l)}h=b+1}return g},c.stringifySetCookie=m,c.serialize=m;let e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,f=/^[\u0021-\u003A\u003C-\u007E]*$/,g=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,h=/^[\u0020-\u003A\u003D-\u007E]*$/,i=/^-?\d+$/,j=Object.prototype.toString,k=((d=function(){}).prototype=Object.create(null),d);function l(a,b){let c=new k,d=a.length;if(d<2)return c;let e=b?.decode||q,f=0;do{let b=o(a,f,d);if(-1===b)break;let g=n(a,f,d);if(b>g){f=a.lastIndexOf(";",b-1)+1;continue}let h=p(a,f,b);void 0===c[h]&&(c[h]=e(p(a,b+1,g))),f=g+1}while(f<d)return c}function m(a,b,c){let d="object"==typeof a?a:{...c,name:a,value:String(b)},i=("object"==typeof b?b:c)?.encode||encodeURIComponent;if(!e.test(d.name))throw TypeError(`argument name is invalid: ${d.name}`);let k=d.value?i(d.value):"";if(!f.test(k))throw TypeError(`argument val is invalid: ${d.value}`);let l=d.name+"="+k;if(void 0!==d.maxAge){if(!Number.isInteger(d.maxAge))throw TypeError(`option maxAge is invalid: ${d.maxAge}`);l+="; Max-Age="+d.maxAge}if(d.domain){if(!g.test(d.domain))throw TypeError(`option domain is invalid: ${d.domain}`);l+="; Domain="+d.domain}if(d.path){if(!h.test(d.path))throw TypeError(`option path is invalid: ${d.path}`);l+="; Path="+d.path}if(d.expires){var m;if(m=d.expires,"[object Date]"!==j.call(m)||!Number.isFinite(d.expires.valueOf()))throw TypeError(`option expires is invalid: ${d.expires}`);l+="; Expires="+d.expires.toUTCString()}if(d.httpOnly&&(l+="; HttpOnly"),d.secure&&(l+="; Secure"),d.partitioned&&(l+="; Partitioned"),d.priority)switch("string"==typeof d.priority?d.priority.toLowerCase():void 0){case"low":l+="; Priority=Low";break;case"medium":l+="; Priority=Medium";break;case"high":l+="; Priority=High";break;default:throw TypeError(`option priority is invalid: ${d.priority}`)}if(d.sameSite)switch("string"==typeof d.sameSite?d.sameSite.toLowerCase():d.sameSite){case!0:case"strict":l+="; SameSite=Strict";break;case"lax":l+="; SameSite=Lax";break;case"none":l+="; SameSite=None";break;default:throw TypeError(`option sameSite is invalid: ${d.sameSite}`)}return l}function n(a,b,c){let d=a.indexOf(";",b);return -1===d?c:d}function o(a,b,c){let d=a.indexOf("=",b);return d<c?d:-1}function p(a,b,c){let d=b,e=c;do{let b=a.charCodeAt(d);if(32!==b&&9!==b)break}while(++d<e)for(;e>d;){let b=a.charCodeAt(e-1);if(32!==b&&9!==b)break;e--}return a.slice(d,e)}function q(a){if(-1===a.indexOf("%"))return a;try{return decodeURIComponent(a)}catch(b){return a}}},27922,(a,b,c)=>{},57301,99335,72943,74731,42205,97855,6354,13820,a=>{"use strict";let b,c,d;var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G=a.i(97176),H=a=>a instanceof Date,I=a=>null==a,J=a=>!I(a)&&!Array.isArray(a)&&"object"==typeof a&&!H(a);function K(a){let b;if(a instanceof Date)return new Date(a);"u">typeof FileList&&FileList;let c=Array.isArray(a);if(!c&&!(J(a)&&J(b=a.constructor&&a.constructor.prototype)&&b.hasOwnProperty("isPrototypeOf")))return a;let d=c?[]:Object.create(Object.getPrototypeOf(a));for(let b in a)Object.prototype.hasOwnProperty.call(a,b)&&(d[b]=K(a[b]));return d}var L=a=>void 0===a,M=a=>Array.isArray(a)?a.filter(Boolean):[],N=a=>M(a.replace(/["|']|\]/g,"").split(/\.|\[/)),O=(a,b,c)=>{if(!b||!J(a))return c;let d=(/^\w*$/.test(b)?[b]:N(b)).reduce((a,b)=>I(a)?a:a[b],a);return L(d)||d===a?L(a[b])?c:a[b]:d},P=a=>"function"==typeof a,Q=(a,b,c)=>{let d=-1,e=/^\w*$/.test(b)?[b]:N(b),f=e.length,g=f-1;for(;++d<f;){let b=e[d],f=c;if(d!==g){let c=a[b];f=J(c)||Array.isArray(c)?c:isNaN(+e[d+1])?{}:[]}if("__proto__"===b||"constructor"===b||"prototype"===b)return;a[b]=f,a=a[b]}};let R="onChange",S="onSubmit",T="maxLength",U="minLength",V="pattern",W="required";G.default.createContext(null).displayName="HookFormControlContext";let X=G.default.useEffect;var Y=a=>"string"==typeof a,Z=a=>I(a)||"object"!=typeof a;function $(a,b,c=new WeakSet){if(Z(a)||Z(b))return Object.is(a,b);if(H(a)&&H(b))return Object.is(a.getTime(),b.getTime());let d=Object.keys(a),e=Object.keys(b);if(d.length!==e.length)return!1;if(c.has(a)||c.has(b))return!0;for(let f of(c.add(a),c.add(b),d)){let d=a[f];if(!e.includes(f))return!1;if("ref"!==f){let a=b[f];if(H(d)&&H(a)||J(d)&&J(a)||Array.isArray(d)&&Array.isArray(a)?!$(d,a,c):!Object.is(d,a))return!1}}return!0}G.default.createContext(null).displayName="HookFormContext";var _=(a,b,c,d,e)=>b?{...c[a],types:{...c[a]&&c[a].types?c[a].types:{},[d]:e||!0}}:{},aa=a=>Array.isArray(a)?a:[a],ab=()=>{let a=[];return{get observers(){return a},next:b=>{for(let c of a)c.next&&c.next(b)},subscribe:b=>(a.push(b),{unsubscribe:()=>{a=a.filter(a=>a!==b)}}),unsubscribe:()=>{a=[]}}},ac=a=>J(a)&&!Object.keys(a).length,ad=a=>!1;function ae(a,b){let c=Array.isArray(b)?b:/^\w*$/.test(b)?[b]:N(b),d=1===c.length?a:function(a,b){let c=b.slice(0,-1).length,d=0;for(;d<c;)a=L(a)?d++:a[b[d++]];return a}(a,c),e=c.length-1,f=c[e];return d&&delete d[f],0!==e&&(J(d)&&ac(d)||Array.isArray(d)&&function(a){for(let b in a)if(a.hasOwnProperty(b)&&!L(a[b]))return!1;return!0}(d))&&ae(a,c.slice(0,-1)),a}function af(a){return Array.isArray(a)||J(a)&&!(a=>{for(let b in a)if(P(a[b]))return!0;return!1})(a)}function ag(a,b={}){for(let c in a){let d=a[c];af(d)?(b[c]=Array.isArray(d)?[]:{},ag(d,b[c])):L(d)||(b[c]=!0)}return b}function ah(a,b,c){for(let d in c||(c=ag(b)),a){let e=a[d];if(af(e))L(b)||Z(c[d])?c[d]=ag(e,Array.isArray(e)?[]:{}):ah(e,I(b)?{}:b[d],c[d]);else{let a=b[d];c[d]=!$(e,a)}}return c}let ai={value:!1,isValid:!1},aj={value:!0,isValid:!0};var ak=a=>{if(Array.isArray(a)){if(a.length>1){let b=a.filter(a=>a&&a.checked&&!a.disabled).map(a=>a.value);return{value:b,isValid:!!b.length}}return a[0].checked&&!a[0].disabled?a[0].attributes&&!L(a[0].attributes.value)?L(a[0].value)||""===a[0].value?aj:{value:a[0].value,isValid:!0}:aj:ai}return ai},al=(a,{valueAsNumber:b,valueAsDate:c,setValueAs:d})=>L(a)?a:b?""===a?NaN:a?+a:a:c&&Y(a)?new Date(a):d?d(a):a;let am={isValid:!1,value:null};var an=a=>Array.isArray(a)?a.reduce((a,b)=>b&&b.checked&&!b.disabled?{isValid:!0,value:b.value}:a,am):am;function ao(a){let b=a.ref;return"file"===b.type?b.files:"radio"===b.type?an(a.refs).value:"select-multiple"===b.type?[...b.selectedOptions].map(({value:a})=>a):"checkbox"===b.type?ak(a.refs).value:al(L(b.value)?a.ref.value:b.value,a)}var ap=a=>L(a)?a:a instanceof RegExp?a.source:J(a)?a.value instanceof RegExp?a.value.source:a.value:a,aq=a=>({isOnSubmit:!a||a===S,isOnBlur:"onBlur"===a,isOnChange:a===R,isOnAll:"all"===a,isOnTouch:"onTouched"===a});let ar="AsyncFunction";var as=a=>!!a&&!!a.validate&&!!(P(a.validate)&&a.validate.constructor.name===ar||J(a.validate)&&Object.values(a.validate).find(a=>a.constructor.name===ar)),at=(a,b,c)=>!c&&(b.watchAll||b.watch.has(a)||[...b.watch].some(b=>a.startsWith(b)&&/^\.\w+/.test(a.slice(b.length))));let au=(a,b,c,d)=>{for(let e of c||Object.keys(a)){let c=O(a,e);if(c){let{_f:a,...f}=c;if(a){if(a.refs&&a.refs[0]&&b(a.refs[0],e)&&!d)return!0;else if(a.ref&&b(a.ref,a.name)&&!d)return!0;else if(au(f,b))break}else if(J(f)&&au(f,b))break}}};function av(a,b,c){let d=O(a,c);if(d||/^\w*$/.test(c))return{error:d,name:c};let e=c.split(".");for(;e.length;){let d=e.join("."),f=O(b,d),g=O(a,d);if(f&&!Array.isArray(f)&&c!==d)break;if(g&&g.type)return{name:d,error:g};if(g&&g.root&&g.root.type)return{name:`${d}.root`,error:g.root};e.pop()}return{name:c}}var aw=(a,b,c)=>{let d=aa(O(a,c));return Q(d,"root",b[c]),Q(a,c,d),a};function ax(a,b,c="validate"){if(Y(a)||Array.isArray(a)&&a.every(Y)||"boolean"==typeof a&&!a)return{type:c,message:Y(a)?a:"",ref:b}}var ay=a=>!J(a)||a instanceof RegExp?{value:a,message:""}:a,az=async(a,b,c,d,e,f)=>{let{ref:g,refs:h,required:i,maxLength:j,minLength:k,min:l,max:m,pattern:n,validate:o,name:p,valueAsNumber:q,mount:r}=a._f,s=O(c,p);if(!r||b.has(p))return{};let t=h?h[0]:g,u=a=>{e&&t.reportValidity&&(t.setCustomValidity("boolean"==typeof a?"":a||""),t.reportValidity())},v={},w="radio"===g.type,x="checkbox"===g.type,y=(q||"file"===g.type)&&L(g.value)&&L(s)||""===s||Array.isArray(s)&&!s.length,z=_.bind(null,p,d,v),A=(a,b,c,d=T,e=U)=>{let f=a?b:c;v[p]={type:a?d:e,message:f,ref:g,...z(a?d:e,f)}};if(f?!Array.isArray(s)||!s.length:i&&(!(w||x)&&(y||I(s))||"boolean"==typeof s&&!s||x&&!ak(h).isValid||w&&!an(h).isValid)){let{value:a,message:b}=Y(i)?{value:!!i,message:i}:ay(i);if(a&&(v[p]={type:W,message:b,ref:t,...z(W,b)},!d))return u(b),v}if(!y&&(!I(l)||!I(m))){let a,b,c=ay(m),e=ay(l);if(I(s)||isNaN(s)){let d=g.valueAsDate||new Date(s),f=a=>new Date(new Date().toDateString()+" "+a),h="time"==g.type,i="week"==g.type;Y(c.value)&&s&&(a=h?f(s)>f(c.value):i?s>c.value:d>new Date(c.value)),Y(e.value)&&s&&(b=h?f(s)<f(e.value):i?s<e.value:d<new Date(e.value))}else{let d=g.valueAsNumber||(s?+s:s);I(c.value)||(a=d>c.value),I(e.value)||(b=d<e.value)}if((a||b)&&(A(!!a,c.message,e.message,"max","min"),!d))return u(v[p].message),v}if((j||k)&&!y&&(Y(s)||f&&Array.isArray(s))){let a=ay(j),b=ay(k),c=!I(a.value)&&s.length>+a.value,e=!I(b.value)&&s.length<+b.value;if((c||e)&&(A(c,a.message,b.message),!d))return u(v[p].message),v}if(n&&!y&&Y(s)){let{value:a,message:b}=ay(n);if(a instanceof RegExp&&!s.match(a)&&(v[p]={type:V,message:b,ref:g,...z(V,b)},!d))return u(b),v}if(o){if(P(o)){let a=ax(await o(s,c),t);if(a&&(v[p]={...a,...z("validate",a.message)},!d))return u(a.message),v}else if(J(o)){let a={};for(let b in o){if(!ac(a)&&!d)break;let e=ax(await o[b](s,c),t,b);e&&(a={...e,...z(b,e.message)},u(e.message),d&&(v[p]=a))}if(!ac(a)&&(v[p]={ref:t,...a},!d))return v}}return u(!0),v};let aA={mode:S,reValidateMode:R,shouldFocusError:!0};function aB(a={}){let b=G.default.useRef(void 0),c=G.default.useRef(void 0),[d,e]=G.default.useState({isDirty:!1,isValidating:!1,isLoading:P(a.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:a.errors||{},disabled:a.disabled||!1,isReady:!1,defaultValues:P(a.defaultValues)?void 0:a.defaultValues});if(!b.current)if(a.formControl)b.current={...a.formControl,formState:d},a.defaultValues&&!P(a.defaultValues)&&a.formControl.reset(a.defaultValues,a.resetOptions);else{let{formControl:c,...e}=function(a={}){let b,c={...aA,...a},d={submitCount:0,isDirty:!1,isReady:!1,isLoading:P(c.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:c.errors||{},disabled:c.disabled||!1},e={},f=(J(c.defaultValues)||J(c.values))&&K(c.defaultValues||c.values)||{},g=c.shouldUnregister?{}:K(f),h={action:!1,mount:!1,watch:!1,keepIsValid:!1},i={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},j=0,k={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},l={...k},m={...l},n={array:ab(),state:ab()},o="all"===c.criteriaMode,p=async a=>{if(!h.keepIsValid&&!c.disabled&&(l.isValid||m.isValid||a)){let a;c.resolver?(a=ac((await t()).errors),q()):a=await v(e,!0),a!==d.isValid&&n.state.next({isValid:a})}},q=(a,b)=>{!c.disabled&&(l.isValidating||l.validatingFields||m.isValidating||m.validatingFields)&&((a||Array.from(i.mount)).forEach(a=>{a&&(b?Q(d.validatingFields,a,b):ae(d.validatingFields,a))}),n.state.next({validatingFields:d.validatingFields,isValidating:!ac(d.validatingFields)}))},r=(a,b,c,d)=>{let i=O(e,a);if(i){let e=O(g,a,L(c)?O(f,a):c);L(e)||d&&d.defaultChecked||b?Q(g,a,b?e:ao(i._f)):y(a,e),h.mount&&!h.action&&p()}},s=(a,b,e,g,h)=>{let i=!1,j=!1,k={name:a};if(!c.disabled){if(!e||g){(l.isDirty||m.isDirty)&&(j=d.isDirty,d.isDirty=k.isDirty=w(),i=j!==k.isDirty);let c=$(O(f,a),b);j=!!O(d.dirtyFields,a),c?ae(d.dirtyFields,a):Q(d.dirtyFields,a,!0),k.dirtyFields=d.dirtyFields,i=i||(l.dirtyFields||m.dirtyFields)&&!c!==j}if(e){let b=O(d.touchedFields,a);b||(Q(d.touchedFields,a,e),k.touchedFields=d.touchedFields,i=i||(l.touchedFields||m.touchedFields)&&b!==e)}i&&h&&n.state.next(k)}return i?k:{}},t=async a=>(q(a,!0),await c.resolver(g,c.context,((a,b,c,d)=>{let e={};for(let c of a){let a=O(b,c);a&&Q(e,c,a._f)}return{criteriaMode:c,names:[...a],fields:e,shouldUseNativeValidation:d}})(a||i.mount,e,c.criteriaMode,c.shouldUseNativeValidation))),u=async a=>{let{errors:b}=await t(a);if(q(a),a)for(let c of a){let a=O(b,c);a?Q(d.errors,c,a):ae(d.errors,c)}else d.errors=b;return b},v=async(b,e,f={valid:!0})=>{for(let h in b){let j=b[h];if(j){let{_f:b,...h}=j;if(b){let h=i.array.has(b.name),k=j._f&&as(j._f);k&&l.validatingFields&&q([b.name],!0);let m=await az(j,i.disabled,g,o,c.shouldUseNativeValidation&&!e,h);if(k&&l.validatingFields&&q([b.name]),m[b.name]&&(f.valid=!1,e||a.shouldUseNativeValidation))break;e||(O(m,b.name)?h?aw(d.errors,m,b.name):Q(d.errors,b.name,m[b.name]):ae(d.errors,b.name))}ac(h)||await v(h,e,f)}}return f.valid},w=(a,b)=>!c.disabled&&(a&&b&&Q(g,a,b),!$(E(),f)),x=(a,b,c)=>{var d,e;return d=i,e={...h.mount?g:L(b)?f:Y(a)?{[a]:b}:b},Y(a)?(c&&d.watch.add(a),O(e,a,b)):Array.isArray(a)?a.map(a=>(c&&d.watch.add(a),O(e,a))):(c&&(d.watchAll=!0),e)},y=(a,b,c={})=>{let d=O(e,a),f=b;if(d){let c=d._f;c&&(c.disabled||Q(g,a,al(b,c)),c.ref,f=b,"select-multiple"===c.ref.type?[...c.ref.options].forEach(a=>a.selected=f.includes(a.value)):c.refs?"checkbox"===c.ref.type?c.refs.forEach(a=>{a.defaultChecked&&a.disabled||(Array.isArray(f)?a.checked=!!f.find(b=>b===a.value):a.checked=f===a.value||!!f)}):c.refs.forEach(a=>a.checked=a.value===f):"file"===c.ref.type?c.ref.value="":(c.ref.value=f,c.ref.type||n.state.next({name:a,values:K(g)})))}(c.shouldDirty||c.shouldTouch)&&s(a,f,c.shouldTouch,c.shouldDirty,!0),c.shouldValidate&&D(a)},z=(a,b,c)=>{for(let d in b){if(!b.hasOwnProperty(d))return;let f=b[d],g=a+"."+d,h=O(e,g);(i.array.has(a)||J(f)||h&&!h._f)&&!H(f)?z(g,f,c):y(g,f,c)}},A=(a,b,c={})=>{let j=O(e,a),k=i.array.has(a),o=K(b);Q(g,a,o),k?(n.array.next({name:a,values:K(g)}),(l.isDirty||l.dirtyFields||m.isDirty||m.dirtyFields)&&c.shouldDirty&&n.state.next({name:a,dirtyFields:ah(f,g),isDirty:w(a,o)})):!j||j._f||I(o)?y(a,o,c):z(a,o,c),at(a,i)?n.state.next({...d,name:a,values:K(g)}):n.state.next({name:h.mount?a:void 0,values:K(g)})},B=async a=>{h.mount=!0;let f=a.target,k=f.name,r=!0,u=O(e,k),w=a=>{r=Number.isNaN(a)||H(a)&&isNaN(a.getTime())||$(a,O(g,k,a))},x=aq(c.mode),y=aq(c.reValidateMode);if(u){let h,H,L,M,N=f.type?ao(u._f):J(h=a)&&h.target?"checkbox"===h.target.type?h.target.checked:h.target.value:h,P="blur"===a.type||"focusout"===a.type,R=!((M=u._f).mount&&(M.required||M.min||M.max||M.maxLength||M.minLength||M.pattern||M.validate))&&!c.resolver&&!O(d.errors,k)&&!u._f.deps||(z=P,A=O(d.touchedFields,k),B=d.isSubmitted,C=y,!(E=x).isOnAll&&(!B&&E.isOnTouch?!(A||z):(B?C.isOnBlur:E.isOnBlur)?!z:(B?!C.isOnChange:!E.isOnChange)||z)),S=at(k,i,P);Q(g,k,N),P?f&&f.readOnly||(u._f.onBlur&&u._f.onBlur(a),b&&b(0)):u._f.onChange&&u._f.onChange(a);let T=s(k,N,P),U=!ac(T)||S;if(P||n.state.next({name:k,type:a.type,values:K(g)}),R)return(l.isValid||m.isValid)&&("onBlur"===c.mode?P&&p():P||p()),U&&n.state.next({name:k,...S?{}:T});if(!P&&S&&n.state.next({...d}),c.resolver){let{errors:a}=await t([k]);if(q([k]),w(N),r){let b=av(d.errors,e,k),c=av(a,e,b.name||k);H=c.error,k=c.name,L=ac(a)}}else q([k],!0),H=(await az(u,i.disabled,g,o,c.shouldUseNativeValidation))[k],q([k]),w(N),r&&(H?L=!1:(l.isValid||m.isValid)&&(L=await v(e,!0)));if(r){u._f.deps&&(!Array.isArray(u._f.deps)||u._f.deps.length>0)&&D(u._f.deps);var z,A,B,C,E,F=k,G=L,I=H;let a=O(d.errors,F),e=(l.isValid||m.isValid)&&"boolean"==typeof G&&d.isValid!==G;if(c.delayError&&I){let a;a=()=>{Q(d.errors,F,I),n.state.next({errors:d.errors})},(b=b=>{clearTimeout(j),j=setTimeout(a,b)})(c.delayError)}else clearTimeout(j),b=null,I?Q(d.errors,F,I):ae(d.errors,F);if((I?!$(a,I):a)||!ac(T)||e){let a={...T,...e&&"boolean"==typeof G?{isValid:G}:{},errors:d.errors,name:F};d={...d,...a},n.state.next(a)}}}},C=(a,b)=>{if(O(d.errors,b)&&a.focus)return a.focus(),1},D=async(a,b={})=>{let f,g,h=aa(a);if(c.resolver){let b=await u(L(a)?a:h);f=ac(b),g=a?!h.some(a=>O(b,a)):f}else a?((g=(await Promise.all(h.map(async a=>{let b=O(e,a);return await v(b&&b._f?{[a]:b}:b)}))).every(Boolean))||d.isValid)&&p():g=f=await v(e);return n.state.next({...!Y(a)||(l.isValid||m.isValid)&&f!==d.isValid?{}:{name:a},...c.resolver||!a?{isValid:f}:{},errors:d.errors}),b.shouldFocus&&!g&&au(e,C,a?h:i.mount),g},E=(a,b)=>{let c={...h.mount?g:f};return b&&(c=function a(b,c){let d={};for(let e in b)if(b.hasOwnProperty(e)){let f=b[e],g=c[e];if(f&&J(f)&&g){let b=a(f,g);J(b)&&(d[e]=b)}else b[e]&&(d[e]=g)}return d}(b.dirtyFields?d.dirtyFields:d.touchedFields,c)),L(a)?c:Y(a)?O(c,a):a.map(a=>O(c,a))},F=(a,b)=>({invalid:!!O((b||d).errors,a),isDirty:!!O((b||d).dirtyFields,a),error:O((b||d).errors,a),isValidating:!!O(d.validatingFields,a),isTouched:!!O((b||d).touchedFields,a)}),G=(a,b,c)=>{let f=(O(e,a,{_f:{}})._f||{}).ref,{ref:g,message:h,type:i,...j}=O(d.errors,a)||{};Q(d.errors,a,{...j,...b,ref:f}),n.state.next({name:a,errors:d.errors,isValid:!1}),c&&c.shouldFocus&&f&&f.focus&&f.focus()},N=a=>n.state.subscribe({next:b=>{let c,e,h;c=a.name,e=b.name,h=a.exact,(!c||!e||c===e||aa(c).some(a=>a&&(h?a===e:a.startsWith(e)||e.startsWith(a))))&&((a,b,c,d)=>{c(a);let{name:e,...f}=a;return ac(f)||Object.keys(f).length>=Object.keys(b).length||Object.keys(f).find(a=>b[a]===(!d||"all"))})(b,a.formState||l,Z,a.reRenderRoot)&&a.callback({values:{...g},...d,...b,defaultValues:f})}}).unsubscribe,R=(a,b={})=>{for(let h of a?aa(a):i.mount)i.mount.delete(h),i.array.delete(h),b.keepValue||(ae(e,h),ae(g,h)),b.keepError||ae(d.errors,h),b.keepDirty||ae(d.dirtyFields,h),b.keepTouched||ae(d.touchedFields,h),b.keepIsValidating||ae(d.validatingFields,h),c.shouldUnregister||b.keepDefaultValue||ae(f,h);n.state.next({values:K(g)}),n.state.next({...d,...!b.keepDirty?{}:{isDirty:w()}}),b.keepIsValid||p()},S=({disabled:a,name:b})=>{if("boolean"==typeof a&&h.mount||a||i.disabled.has(b)){let c=i.disabled.has(b);a?i.disabled.add(b):i.disabled.delete(b),!!a!==c&&h.mount&&!h.action&&p()}},T=(a,b={})=>{let d=O(e,a),g="boolean"==typeof b.disabled||"boolean"==typeof c.disabled;return(Q(e,a,{...d||{},_f:{...d&&d._f?d._f:{ref:{name:a}},name:a,mount:!0,...b}}),i.mount.add(a),d)?S({disabled:"boolean"==typeof b.disabled?b.disabled:c.disabled,name:a}):r(a,!0,b.value),{...g?{disabled:b.disabled||c.disabled}:{},...c.progressive?{required:!!b.required,min:ap(b.min),max:ap(b.max),minLength:ap(b.minLength),maxLength:ap(b.maxLength),pattern:ap(b.pattern)}:{},name:a,onChange:B,onBlur:B,ref:g=>{if(g){let c;T(a,b),d=O(e,a);let h=L(g.value)&&g.querySelectorAll&&g.querySelectorAll("input,select,textarea")[0]||g,i="radio"===(c=h).type||"checkbox"===c.type,j=d._f.refs||[];(i?j.find(a=>a===h):h===d._f.ref)||(Q(e,a,{_f:{...d._f,...i?{refs:[...j.filter(ad),h,...Array.isArray(O(f,a))?[{}]:[]],ref:{type:h.type,name:a}}:{ref:h}}}),r(a,!1,void 0,h))}else{var j;(d=O(e,a,{}))._f&&(d._f.mount=!1),(c.shouldUnregister||b.shouldUnregister)&&(j=i.array,!j.has(a.substring(0,a.search(/\.\d+(\.|$)/))||a)||!h.action)&&i.unMount.add(a)}}}},U=()=>c.shouldFocusError&&au(e,C,i.mount),V=(a,b)=>async f=>{let h;f&&(f.preventDefault&&f.preventDefault(),f.persist&&f.persist());let j=K(g);if(n.state.next({isSubmitting:!0}),c.resolver){let{errors:a,values:b}=await t();q(),d.errors=a,j=K(b)}else await v(e);if(i.disabled.size)for(let a of i.disabled)ae(j,a);if(ae(d.errors,"root"),ac(d.errors)){n.state.next({errors:{}});try{await a(j,f)}catch(a){h=a}}else b&&await b({...d.errors},f),U(),setTimeout(U);if(n.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:ac(d.errors)&&!h,submitCount:d.submitCount+1,errors:d.errors}),h)throw h},W=(a,b={})=>{let j=a?K(a):f,k=K(j),m=ac(a),o=m?f:k;if(b.keepDefaultValues||(f=j),!b.keepValues){if(b.keepDirtyValues)for(let a of Array.from(new Set([...i.mount,...Object.keys(ah(f,g))]))){let b=O(d.dirtyFields,a),c=O(g,a),e=O(o,a);b&&!L(c)?Q(o,a,c):b||L(e)||A(a,e)}else if(b.keepFieldsRef)for(let a of i.mount)A(a,O(o,a));else e={};g=c.shouldUnregister?b.keepDefaultValues?K(f):{}:K(o),n.array.next({values:{...o}}),n.state.next({values:{...o}})}i={mount:b.keepDirtyValues?i.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},h.mount=!l.isValid||!!b.keepIsValid||!!b.keepDirtyValues||!c.shouldUnregister&&!ac(o),h.watch=!!c.shouldUnregister,h.keepIsValid=!!b.keepIsValid,h.action=!1,b.keepErrors||(d.errors={}),n.state.next({submitCount:b.keepSubmitCount?d.submitCount:0,isDirty:!m&&(b.keepDirty?d.isDirty:!!(b.keepDefaultValues&&!$(a,f))),isSubmitted:!!b.keepIsSubmitted&&d.isSubmitted,dirtyFields:m?{}:b.keepDirtyValues?b.keepDefaultValues&&g?ah(f,g):d.dirtyFields:b.keepDefaultValues&&a?ah(f,a):b.keepDirty?d.dirtyFields:{},touchedFields:b.keepTouched?d.touchedFields:{},errors:b.keepErrors?d.errors:{},isSubmitSuccessful:!!b.keepIsSubmitSuccessful&&d.isSubmitSuccessful,isSubmitting:!1,defaultValues:f})},X=(a,b)=>W(P(a)?a(g):a,{...c.resetOptions,...b}),Z=a=>{d={...d,...a}},_={control:{register:T,unregister:R,getFieldState:F,handleSubmit:V,setError:G,_subscribe:N,_runSchema:t,_updateIsValidating:q,_focusError:U,_getWatch:x,_getDirty:w,_setValid:p,_setFieldArray:(a,b=[],i,j,k=!0,o=!0)=>{if(j&&i&&!c.disabled){if(h.action=!0,o&&Array.isArray(O(e,a))){let b=i(O(e,a),j.argA,j.argB);k&&Q(e,a,b)}if(o&&Array.isArray(O(d.errors,a))){let b,c=i(O(d.errors,a),j.argA,j.argB);k&&Q(d.errors,a,c),M(O(b=d.errors,a)).length||ae(b,a)}if((l.touchedFields||m.touchedFields)&&o&&Array.isArray(O(d.touchedFields,a))){let b=i(O(d.touchedFields,a),j.argA,j.argB);k&&Q(d.touchedFields,a,b)}(l.dirtyFields||m.dirtyFields)&&(d.dirtyFields=ah(f,g)),n.state.next({name:a,isDirty:w(a,b),dirtyFields:d.dirtyFields,errors:d.errors,isValid:d.isValid})}else Q(g,a,b)},_setDisabledField:S,_setErrors:a=>{d.errors=a,n.state.next({errors:d.errors,isValid:!1})},_getFieldArray:a=>M(O(h.mount?g:f,a,c.shouldUnregister?O(f,a,[]):[])),_reset:W,_resetDefaultValues:()=>P(c.defaultValues)&&c.defaultValues().then(a=>{X(a,c.resetOptions),n.state.next({isLoading:!1})}),_removeUnmounted:()=>{for(let a of i.unMount){let b=O(e,a);b&&(b._f.refs?b._f.refs.every(a=>!ad(a)):!ad(b._f.ref))&&R(a)}i.unMount=new Set},_disableForm:a=>{"boolean"==typeof a&&(n.state.next({disabled:a}),au(e,(b,c)=>{let d=O(e,c);d&&(b.disabled=d._f.disabled||a,Array.isArray(d._f.refs)&&d._f.refs.forEach(b=>{b.disabled=d._f.disabled||a}))},0,!1))},_subjects:n,_proxyFormState:l,get _fields(){return e},get _formValues(){return g},get _state(){return h},set _state(value){h=value},get _defaultValues(){return f},get _names(){return i},set _names(value){i=value},get _formState(){return d},get _options(){return c},set _options(value){c={...c,...value}}},subscribe:a=>(h.mount=!0,m={...m,...a.formState},N({...a,formState:{...k,...a.formState}})),trigger:D,register:T,handleSubmit:V,watch:(a,b)=>P(a)?n.state.subscribe({next:c=>"values"in c&&a(x(void 0,b),c)}):x(a,b,!0),setValue:A,getValues:E,reset:X,resetField:(a,b={})=>{O(e,a)&&(L(b.defaultValue)?A(a,K(O(f,a))):(A(a,b.defaultValue),Q(f,a,K(b.defaultValue))),b.keepTouched||ae(d.touchedFields,a),b.keepDirty||(ae(d.dirtyFields,a),d.isDirty=b.defaultValue?w(a,K(O(f,a))):w()),!b.keepError&&(ae(d.errors,a),l.isValid&&p()),n.state.next({...d}))},clearErrors:a=>{let b=a?aa(a):void 0;null==b||b.forEach(a=>ae(d.errors,a)),b?b.forEach(a=>{n.state.next({name:a,errors:d.errors})}):n.state.next({errors:{}})},unregister:R,setError:G,setFocus:(a,b={})=>{let c=O(e,a),d=c&&c._f;if(d){let a=d.refs?d.refs[0]:d.ref;a.focus&&setTimeout(()=>{a.focus(),b.shouldSelect&&P(a.select)&&a.select()})}},getFieldState:F};return{..._,formControl:_}}(a);b.current={...e,formState:d}}let f=b.current.control;return f._options=a,X(()=>{let a=f._subscribe({formState:f._proxyFormState,callback:()=>e({...f._formState}),reRenderRoot:!0});return e(a=>({...a,isReady:!0})),f._formState.isReady=!0,a},[f]),G.default.useEffect(()=>f._disableForm(a.disabled),[f,a.disabled]),G.default.useEffect(()=>{a.mode&&(f._options.mode=a.mode),a.reValidateMode&&(f._options.reValidateMode=a.reValidateMode)},[f,a.mode,a.reValidateMode]),G.default.useEffect(()=>{a.errors&&(f._setErrors(a.errors),f._focusError())},[f,a.errors]),G.default.useEffect(()=>{a.shouldUnregister&&f._subjects.state.next({values:f._getWatch()})},[f,a.shouldUnregister]),G.default.useEffect(()=>{if(f._proxyFormState.isDirty){let a=f._getDirty();a!==d.isDirty&&f._subjects.state.next({isDirty:a})}},[f,d.isDirty]),G.default.useEffect(()=>{var b;a.values&&!$(a.values,c.current)?(f._reset(a.values,{keepFieldsRef:!0,...f._options.resetOptions}),(null==(b=f._options.resetOptions)?void 0:b.keepIsValid)||f._setValid(),c.current=a.values,e(a=>({...a}))):f._resetDefaultValues()},[f,a.values]),G.default.useEffect(()=>{f._state.mount||(f._setValid(),f._state.mount=!0),f._state.watch&&(f._state.watch=!1,f._subjects.state.next({...f._formState})),f._removeUnmounted()}),b.current.formState=G.default.useMemo(()=>((a,b,c,d=!0)=>{let e={defaultValues:b._defaultValues};for(let f in a)Object.defineProperty(e,f,{get:()=>("all"!==b._proxyFormState[f]&&(b._proxyFormState[f]=!d||"all"),c&&(c[f]=!0),a[f])});return e})(d,f),[f,d]),b.current}a.s(["appendErrors",()=>_,"get",()=>O,"set",()=>Q,"useForm",()=>aB],57301);let aC=(a,b,c)=>{if(a&&"reportValidity"in a){let d=O(c,b);a.setCustomValidity(d&&d.message||""),a.reportValidity()}},aD=(a,b)=>{for(let c in b.fields){let d=b.fields[c];d&&d.ref&&"reportValidity"in d.ref?aC(d.ref,c,a):d.refs&&d.refs.forEach(b=>aC(b,c,a))}},aE=(a,b)=>a.some(a=>a.startsWith(b+"."));var aF=function(a,b){for(var c={};a.length;){var d=a[0],e=d.code,f=d.message,g=d.path.join(".");if(!c[g])if("unionErrors"in d){var h=d.unionErrors[0].errors[0];c[g]={message:h.message,type:h.code}}else c[g]={message:f,type:e};if("unionErrors"in d&&d.unionErrors.forEach(function(b){return b.errors.forEach(function(b){return a.push(b)})}),b){var i=c[g].types,j=i&&i[d.code];c[g]=_(g,b,c,e,j?[].concat(j,d.message):d.message)}a.shift()}return c},aG=function(a,b,c){return void 0===c&&(c={}),function(d,e,f){try{return Promise.resolve(function(e,g){try{var h=Promise.resolve(a["sync"===c.mode?"parse":"parseAsync"](d,b)).then(function(a){return f.shouldUseNativeValidation&&aD({},f),{errors:{},values:c.raw?d:a}})}catch(a){return g(a)}return h&&h.then?h.then(void 0,g):h}(0,function(a){if(Array.isArray(null==a?void 0:a.errors))return{values:{},errors:((a,b)=>{b.shouldUseNativeValidation&&aD(a,b);let c={};for(let d in a){let e=O(b.fields,d),f=Object.assign(a[d]||{},{ref:e&&e.ref});if(aE(b.names||Object.keys(a),d)){let a=Object.assign({},O(c,d));Q(a,"root",f),Q(c,d,a)}else Q(c,d,f)}return c})(aF(a.errors,!f.shouldUseNativeValidation&&"all"===f.criteriaMode),f)};throw a}))}catch(a){return Promise.reject(a)}}};a.s(["zodResolver",()=>aG],99335);var aH=a.i(43249);let aI=(0,aH.default)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);a.s(["Eye",()=>aI],72943);let aJ=(0,aH.default)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);a.s(["EyeOff",()=>aJ],74731);class aK extends Error{constructor(a,b="FunctionsError",c){super(a),this.name=b,this.context=c}}class aL extends aK{constructor(a){super("Failed to send a request to the Edge Function","FunctionsFetchError",a)}}class aM extends aK{constructor(a){super("Relay Error invoking the Edge Function","FunctionsRelayError",a)}}class aN extends aK{constructor(a){super("Edge Function returned a non-2xx status code","FunctionsHttpError",a)}}(e=r||(r={})).Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2";function aO(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c}"function"==typeof SuppressedError&&SuppressedError;class aP{constructor(a,{headers:b={},customFetch:c,region:d=r.Any}={}){this.url=a,this.headers=b,this.region=d,this.fetch=(a=>a?(...b)=>a(...b):(...a)=>fetch(...a))(c)}setAuth(a){this.headers.Authorization=`Bearer ${a}`}invoke(a){var b,c,d,e;return b=this,c=arguments,d=void 0,e=function*(a,b={}){var c;let d,e;try{let f,{headers:g,method:h,body:i,signal:j,timeout:k}=b,l={},{region:m}=b;m||(m=this.region);let n=new URL(`${this.url}/${a}`);m&&"any"!==m&&(l["x-region"]=m,n.searchParams.set("forceFunctionRegion",m)),i&&(g&&!Object.prototype.hasOwnProperty.call(g,"Content-Type")||!g)?"u">typeof Blob&&i instanceof Blob||i instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",f=i):"string"==typeof i?(l["Content-Type"]="text/plain",f=i):"u">typeof FormData&&i instanceof FormData?f=i:(l["Content-Type"]="application/json",f=JSON.stringify(i)):f=!i||"string"==typeof i||"u">typeof Blob&&i instanceof Blob||i instanceof ArrayBuffer||"u">typeof FormData&&i instanceof FormData?i:JSON.stringify(i);let o=j;k&&(e=new AbortController,d=setTimeout(()=>e.abort(),k),j?(o=e.signal,j.addEventListener("abort",()=>e.abort())):o=e.signal);let p=yield this.fetch(n.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),g),body:f,signal:o}).catch(a=>{throw new aL(a)}),q=p.headers.get("x-relay-error");if(q&&"true"===q)throw new aM(p);if(!p.ok)throw new aN(p);let r=(null!=(c=p.headers.get("Content-Type"))?c:"text/plain").split(";")[0].trim();return{data:"application/json"===r?yield p.json():"application/octet-stream"===r||"application/pdf"===r?yield p.blob():"text/event-stream"===r?p:"multipart/form-data"===r?yield p.formData():yield p.text(),error:null,response:p}}catch(a){return{data:null,error:a,response:a instanceof aN||a instanceof aM?a.context:void 0}}finally{d&&clearTimeout(d)}},new(d||(d=Promise))(function(a,f){function g(a){try{i(e.next(a))}catch(a){f(a)}}function h(a){try{i(e.throw(a))}catch(a){f(a)}}function i(b){var c;b.done?a(b.value):((c=b.value)instanceof d?c:new d(function(a){a(c)})).then(g,h)}i((e=e.apply(b,c||[])).next())})}}var aQ=class extends Error{constructor(a){super(a.message),this.name="PostgrestError",this.details=a.details,this.hint=a.hint,this.code=a.code}},aR=class{constructor(a){var b,c,d;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=null!=(b=a.shouldThrowOnError)&&b,this.signal=a.signal,this.isMaybeSingle=null!=(c=a.isMaybeSingle)&&c,this.urlLengthLimit=null!=(d=a.urlLengthLimit)?d:8e3,a.fetch?this.fetch=a.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,b){return this.headers=new Headers(this.headers),this.headers.set(a,b),this}then(a,b){var c=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let d=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var b,d,e,f;let g=null,h=null,i=null,j=a.status,k=a.statusText;if(a.ok){if("HEAD"!==c.method){let b=await a.text();""===b||(h="text/csv"===c.headers.get("Accept")||c.headers.get("Accept")&&(null==(e=c.headers.get("Accept"))?void 0:e.includes("application/vnd.pgrst.plan+text"))?b:JSON.parse(b))}let f=null==(b=c.headers.get("Prefer"))?void 0:b.match(/count=(exact|planned|estimated)/),l=null==(d=a.headers.get("content-range"))?void 0:d.split("/");f&&l&&l.length>1&&(i=parseInt(l[1])),c.isMaybeSingle&&"GET"===c.method&&Array.isArray(h)&&(h.length>1?(g={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,i=null,j=406,k="Not Acceptable"):h=1===h.length?h[0]:null)}else{let b=await a.text();try{g=JSON.parse(b),Array.isArray(g)&&404===a.status&&(h=[],g=null,j=200,k="OK")}catch(c){404===a.status&&""===b?(j=204,k="No Content"):g={message:b}}if(g&&c.isMaybeSingle&&(null==g||null==(f=g.details)?void 0:f.includes("0 rows"))&&(g=null,j=200,k="OK"),g&&c.shouldThrowOnError)throw new aQ(g)}return{error:g,data:h,count:i,status:j,statusText:k}});return this.shouldThrowOnError||(d=d.catch(a=>{var b,c,d,e,f,g;let h="",i="",j="",k=null==a?void 0:a.cause;if(k){let b=null!=(c=null==k?void 0:k.message)?c:"",g=null!=(d=null==k?void 0:k.code)?d:"";h=`${null!=(e=null==a?void 0:a.name)?e:"FetchError"}: ${null==a?void 0:a.message}

Caused by: ${null!=(f=null==k?void 0:k.name)?f:"Error"}: ${b}`,g&&(h+=` (${g})`),(null==k?void 0:k.stack)&&(h+=`
${k.stack}`)}else h=null!=(g=null==a?void 0:a.stack)?g:"";let l=this.url.toString().length;return(null==a?void 0:a.name)==="AbortError"||(null==a?void 0:a.code)==="ABORT_ERR"?(j="",i="Request was aborted (timeout or manual cancellation)",l>this.urlLengthLimit&&(i+=`. Note: Your request URL is ${l} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):((null==k?void 0:k.name)==="HeadersOverflowError"||(null==k?void 0:k.code)==="UND_ERR_HEADERS_OVERFLOW")&&(j="",i="HTTP headers exceeded server limits (typically 16KB)",l>this.urlLengthLimit&&(i+=`. Your request URL is ${l} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${null!=(b=null==a?void 0:a.name)?b:"FetchError"}: ${null==a?void 0:a.message}`,details:h,hint:i,code:j},data:null,count:null,status:0,statusText:""}})),d.then(a,b)}returns(){return this}overrideTypes(){return this}},aS=class extends aR{select(a){let b=!1,c=(null!=a?a:"*").split("").map(a=>/\s/.test(a)&&!b?"":('"'===a&&(b=!b),a)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:b=!0,nullsFirst:c,foreignTable:d,referencedTable:e=d}={}){let f=e?`${e}.order`:"order",g=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${g?`${g},`:""}${a}.${b?"asc":"desc"}${void 0===c?"":c?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:b,referencedTable:c=b}={}){let d=void 0===c?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${a}`),this}range(a,b,{foreignTable:c,referencedTable:d=c}={}){let e=void 0===d?"offset":`${d}.offset`,f=void 0===d?"limit":`${d}.limit`;return this.url.searchParams.set(e,`${a}`),this.url.searchParams.set(f,`${b-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:b=!1,settings:c=!1,buffers:d=!1,wal:e=!1,format:f="text"}={}){var g;let h=[a?"analyze":null,b?"verbose":null,c?"settings":null,d?"buffers":null,e?"wal":null].filter(Boolean).join("|"),i=null!=(g=this.headers.get("Accept"))?g:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${f}; for="${i}"; options=${h};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}};let aT=RegExp("[,()]");var aU=class extends aS{eq(a,b){return this.url.searchParams.append(a,`eq.${b}`),this}neq(a,b){return this.url.searchParams.append(a,`neq.${b}`),this}gt(a,b){return this.url.searchParams.append(a,`gt.${b}`),this}gte(a,b){return this.url.searchParams.append(a,`gte.${b}`),this}lt(a,b){return this.url.searchParams.append(a,`lt.${b}`),this}lte(a,b){return this.url.searchParams.append(a,`lte.${b}`),this}like(a,b){return this.url.searchParams.append(a,`like.${b}`),this}likeAllOf(a,b){return this.url.searchParams.append(a,`like(all).{${b.join(",")}}`),this}likeAnyOf(a,b){return this.url.searchParams.append(a,`like(any).{${b.join(",")}}`),this}ilike(a,b){return this.url.searchParams.append(a,`ilike.${b}`),this}ilikeAllOf(a,b){return this.url.searchParams.append(a,`ilike(all).{${b.join(",")}}`),this}ilikeAnyOf(a,b){return this.url.searchParams.append(a,`ilike(any).{${b.join(",")}}`),this}regexMatch(a,b){return this.url.searchParams.append(a,`match.${b}`),this}regexIMatch(a,b){return this.url.searchParams.append(a,`imatch.${b}`),this}is(a,b){return this.url.searchParams.append(a,`is.${b}`),this}isDistinct(a,b){return this.url.searchParams.append(a,`isdistinct.${b}`),this}in(a,b){let c=Array.from(new Set(b)).map(a=>"string"==typeof a&&aT.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(a,`in.(${c})`),this}notIn(a,b){let c=Array.from(new Set(b)).map(a=>"string"==typeof a&&aT.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(a,`not.in.(${c})`),this}contains(a,b){return"string"==typeof b?this.url.searchParams.append(a,`cs.${b}`):Array.isArray(b)?this.url.searchParams.append(a,`cs.{${b.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(b)}`),this}containedBy(a,b){return"string"==typeof b?this.url.searchParams.append(a,`cd.${b}`):Array.isArray(b)?this.url.searchParams.append(a,`cd.{${b.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(b)}`),this}rangeGt(a,b){return this.url.searchParams.append(a,`sr.${b}`),this}rangeGte(a,b){return this.url.searchParams.append(a,`nxl.${b}`),this}rangeLt(a,b){return this.url.searchParams.append(a,`sl.${b}`),this}rangeLte(a,b){return this.url.searchParams.append(a,`nxr.${b}`),this}rangeAdjacent(a,b){return this.url.searchParams.append(a,`adj.${b}`),this}overlaps(a,b){return"string"==typeof b?this.url.searchParams.append(a,`ov.${b}`):this.url.searchParams.append(a,`ov.{${b.join(",")}}`),this}textSearch(a,b,{config:c,type:d}={}){let e="";"plain"===d?e="pl":"phrase"===d?e="ph":"websearch"===d&&(e="w");let f=void 0===c?"":`(${c})`;return this.url.searchParams.append(a,`${e}fts${f}.${b}`),this}match(a){return Object.entries(a).forEach(([a,b])=>{this.url.searchParams.append(a,`eq.${b}`)}),this}not(a,b,c){return this.url.searchParams.append(a,`not.${b}.${c}`),this}or(a,{foreignTable:b,referencedTable:c=b}={}){let d=c?`${c}.or`:"or";return this.url.searchParams.append(d,`(${a})`),this}filter(a,b,c){return this.url.searchParams.append(a,`${b}.${c}`),this}},aV=class{constructor(a,{headers:b={},schema:c,fetch:d,urlLengthLimit:e=8e3}){this.url=a,this.headers=new Headers(b),this.schema=c,this.fetch=d,this.urlLengthLimit=e}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(a,b){let{head:c=!1,count:d}=null!=b?b:{},e=!1,f=(null!=a?a:"*").split("").map(a=>/\s/.test(a)&&!e?"":('"'===a&&(e=!e),a)).join(""),{url:g,headers:h}=this.cloneRequestState();return g.searchParams.set("select",f),d&&h.append("Prefer",`count=${d}`),new aU({method:c?"HEAD":"GET",url:g,headers:h,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(a,{count:b,defaultToNull:c=!0}={}){var d;let{url:e,headers:f}=this.cloneRequestState();if(b&&f.append("Prefer",`count=${b}`),c||f.append("Prefer","missing=default"),Array.isArray(a)){let b=a.reduce((a,b)=>a.concat(Object.keys(b)),[]);if(b.length>0){let a=[...new Set(b)].map(a=>`"${a}"`);e.searchParams.set("columns",a.join(","))}}return new aU({method:"POST",url:e,headers:f,schema:this.schema,body:a,fetch:null!=(d=this.fetch)?d:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(a,{onConflict:b,ignoreDuplicates:c=!1,count:d,defaultToNull:e=!0}={}){var f;let{url:g,headers:h}=this.cloneRequestState();if(h.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),void 0!==b&&g.searchParams.set("on_conflict",b),d&&h.append("Prefer",`count=${d}`),e||h.append("Prefer","missing=default"),Array.isArray(a)){let b=a.reduce((a,b)=>a.concat(Object.keys(b)),[]);if(b.length>0){let a=[...new Set(b)].map(a=>`"${a}"`);g.searchParams.set("columns",a.join(","))}}return new aU({method:"POST",url:g,headers:h,schema:this.schema,body:a,fetch:null!=(f=this.fetch)?f:fetch,urlLengthLimit:this.urlLengthLimit})}update(a,{count:b}={}){var c;let{url:d,headers:e}=this.cloneRequestState();return b&&e.append("Prefer",`count=${b}`),new aU({method:"PATCH",url:d,headers:e,schema:this.schema,body:a,fetch:null!=(c=this.fetch)?c:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:a}={}){var b;let{url:c,headers:d}=this.cloneRequestState();return a&&d.append("Prefer",`count=${a}`),new aU({method:"DELETE",url:c,headers:d,schema:this.schema,fetch:null!=(b=this.fetch)?b:fetch,urlLengthLimit:this.urlLengthLimit})}};function aW(a){return(aW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function aX(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function aY(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?aX(Object(c),!0).forEach(function(b){!function(a,b,c){var d;(d=function(a,b){if("object"!=aW(a)||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=aW(d))return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(b,"string"),(b="symbol"==aW(d)?d:d+"")in a)?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c}(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):aX(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}var aZ=class a{constructor(a,{headers:b={},schema:c,fetch:d,timeout:e,urlLengthLimit:f=8e3}={}){this.url=a,this.headers=new Headers(b),this.schemaName=c,this.urlLengthLimit=f;const g=null!=d?d:globalThis.fetch;void 0!==e&&e>0?this.fetch=(a,b)=>{let c=new AbortController,d=setTimeout(()=>c.abort(),e),f=null==b?void 0:b.signal;if(f){if(f.aborted)return clearTimeout(d),g(a,b);let e=()=>{clearTimeout(d),c.abort()};return f.addEventListener("abort",e,{once:!0}),g(a,aY(aY({},b),{},{signal:c.signal})).finally(()=>{clearTimeout(d),f.removeEventListener("abort",e)})}return g(a,aY(aY({},b),{},{signal:c.signal})).finally(()=>clearTimeout(d))}:this.fetch=g}from(a){if(!a||"string"!=typeof a||""===a.trim())throw Error("Invalid relation name: relation must be a non-empty string.");return new aV(new URL(`${this.url}/${a}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(b){return new a(this.url,{headers:this.headers,schema:b,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(a,b={},{head:c=!1,get:d=!1,count:e}={}){var f;let g,h,i=new URL(`${this.url}/rpc/${a}`),j=a=>null!==a&&"object"==typeof a&&(!Array.isArray(a)||a.some(j)),k=c&&Object.values(b).some(j);k?(g="POST",h=b):c||d?(g=c?"HEAD":"GET",Object.entries(b).filter(([a,b])=>void 0!==b).map(([a,b])=>[a,Array.isArray(b)?`{${b.join(",")}}`:`${b}`]).forEach(([a,b])=>{i.searchParams.append(a,b)})):(g="POST",h=b);let l=new Headers(this.headers);return k?l.set("Prefer",e?`count=${e},return=minimal`:"return=minimal"):e&&l.set("Prefer",`count=${e}`),new aU({method:g,url:i,headers:l,schema:this.schemaName,body:h,fetch:null!=(f=this.fetch)?f:fetch,urlLengthLimit:this.urlLengthLimit})}};let a$=class{static detectEnvironment(){var b;if("u">typeof WebSocket)return{type:"native",constructor:WebSocket};if("u">typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if(void 0!==a.g.WebSocket)return{type:"native",constructor:a.g.WebSocket};if("u">typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("u">typeof globalThis&&globalThis.EdgeRuntime||"u">typeof navigator&&(null==(b=navigator.userAgent)?void 0:b.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};let c=globalThis.process;if(c){let a=c.versions;if(a&&a.node){let b=parseInt(a.node.replace(/^v/,"").split(".")[0]);return b>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${b} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${b} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){let a=this.detectEnvironment();if(a.constructor)return a.constructor;let b=a.error||"WebSocket not supported in this environment.";throw a.workaround&&(b+=`

Suggested solution: ${a.workaround}`),Error(b)}static createWebSocket(a,b){return new(this.getWebSocketConstructor())(a,b)}static isWebSocketSupported(){try{let a=this.detectEnvironment();return"native"===a.type||"ws"===a.type}catch(a){return!1}}},a_="2.0.0";(f=s||(s={}))[f.connecting=0]="connecting",f[f.open=1]="open",f[f.closing=2]="closing",f[f.closed=3]="closed",(g=t||(t={})).closed="closed",g.errored="errored",g.joined="joined",g.joining="joining",g.leaving="leaving",(h=u||(u={})).close="phx_close",h.error="phx_error",h.join="phx_join",h.reply="phx_reply",h.leave="phx_leave",h.access_token="access_token",(v||(v={})).websocket="websocket",(i=w||(w={})).Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed";class a0{constructor(a){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=null!=a?a:[]}encode(a,b){return a.event!==this.BROADCAST_EVENT||a.payload instanceof ArrayBuffer||"string"!=typeof a.payload.event?b(JSON.stringify([a.join_ref,a.ref,a.topic,a.event,a.payload])):b(this._binaryEncodeUserBroadcastPush(a))}_binaryEncodeUserBroadcastPush(a){var b;return this._isArrayBuffer(null==(b=a.payload)?void 0:b.payload)?this._encodeBinaryUserBroadcastPush(a):this._encodeJsonUserBroadcastPush(a)}_encodeBinaryUserBroadcastPush(a){var b,c;let d=null!=(c=null==(b=a.payload)?void 0:b.payload)?c:new ArrayBuffer(0);return this._encodeUserBroadcastPush(a,this.BINARY_ENCODING,d)}_encodeJsonUserBroadcastPush(a){var b,c;let d=null!=(c=null==(b=a.payload)?void 0:b.payload)?c:{},e=new TextEncoder().encode(JSON.stringify(d)).buffer;return this._encodeUserBroadcastPush(a,this.JSON_ENCODING,e)}_encodeUserBroadcastPush(a,b,c){let d=a.topic,e=null!=(n=a.ref)?n:"",f=null!=(o=a.join_ref)?o:"",g=a.payload.event,h=this.allowedMetadataKeys?this._pick(a.payload,this.allowedMetadataKeys):{},i=0===Object.keys(h).length?"":JSON.stringify(h);if(f.length>255)throw Error(`joinRef length ${f.length} exceeds maximum of 255`);if(e.length>255)throw Error(`ref length ${e.length} exceeds maximum of 255`);if(d.length>255)throw Error(`topic length ${d.length} exceeds maximum of 255`);if(g.length>255)throw Error(`userEvent length ${g.length} exceeds maximum of 255`);if(i.length>255)throw Error(`metadata length ${i.length} exceeds maximum of 255`);let j=this.USER_BROADCAST_PUSH_META_LENGTH+f.length+e.length+d.length+g.length+i.length,k=new ArrayBuffer(this.HEADER_LENGTH+j),l=new DataView(k),m=0;l.setUint8(m++,this.KINDS.userBroadcastPush),l.setUint8(m++,f.length),l.setUint8(m++,e.length),l.setUint8(m++,d.length),l.setUint8(m++,g.length),l.setUint8(m++,i.length),l.setUint8(m++,b),Array.from(f,a=>l.setUint8(m++,a.charCodeAt(0))),Array.from(e,a=>l.setUint8(m++,a.charCodeAt(0))),Array.from(d,a=>l.setUint8(m++,a.charCodeAt(0))),Array.from(g,a=>l.setUint8(m++,a.charCodeAt(0))),Array.from(i,a=>l.setUint8(m++,a.charCodeAt(0)));var n,o,p=new Uint8Array(k.byteLength+c.byteLength);return p.set(new Uint8Array(k),0),p.set(new Uint8Array(c),k.byteLength),p.buffer}decode(a,b){if(this._isArrayBuffer(a))return b(this._binaryDecode(a));if("string"==typeof a){let[c,d,e,f,g]=JSON.parse(a);return b({join_ref:c,ref:d,topic:e,event:f,payload:g})}return b({})}_binaryDecode(a){let b=new DataView(a),c=b.getUint8(0),d=new TextDecoder;if(c===this.KINDS.userBroadcast)return this._decodeUserBroadcast(a,b,d)}_decodeUserBroadcast(a,b,c){let d=b.getUint8(1),e=b.getUint8(2),f=b.getUint8(3),g=b.getUint8(4),h=this.HEADER_LENGTH+4,i=c.decode(a.slice(h,h+d));h+=d;let j=c.decode(a.slice(h,h+e));h+=e;let k=c.decode(a.slice(h,h+f));h+=f;let l=a.slice(h,a.byteLength),m=g===this.JSON_ENCODING?JSON.parse(c.decode(l)):l,n={type:this.BROADCAST_EVENT,event:j,payload:m};return f>0&&(n.meta=JSON.parse(k)),{join_ref:null,ref:null,topic:i,event:this.BROADCAST_EVENT,payload:n}}_isArrayBuffer(a){var b;return a instanceof ArrayBuffer||(null==(b=null==a?void 0:a.constructor)?void 0:b.name)==="ArrayBuffer"}_pick(a,b){return a&&"object"==typeof a?Object.fromEntries(Object.entries(a).filter(([a])=>b.includes(a))):{}}}class a1{constructor(a,b){this.callback=a,this.timerCalc=b,this.timer=void 0,this.tries=0,this.callback=a,this.timerCalc=b}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(j=x||(x={})).abstime="abstime",j.bool="bool",j.date="date",j.daterange="daterange",j.float4="float4",j.float8="float8",j.int2="int2",j.int4="int4",j.int4range="int4range",j.int8="int8",j.int8range="int8range",j.json="json",j.jsonb="jsonb",j.money="money",j.numeric="numeric",j.oid="oid",j.reltime="reltime",j.text="text",j.time="time",j.timestamp="timestamp",j.timestamptz="timestamptz",j.timetz="timetz",j.tsrange="tsrange",j.tstzrange="tstzrange";let a2=(a,b,c={})=>{var d;let e=null!=(d=c.skipTypes)?d:[];return b?Object.keys(b).reduce((c,d)=>(c[d]=a3(d,a,b,e),c),{}):{}},a3=(a,b,c,d)=>{let e=b.find(b=>b.name===a),f=null==e?void 0:e.type,g=c[a];return f&&!d.includes(f)?a4(f,g):a5(g)},a4=(a,b)=>{if("_"===a.charAt(0))return a9(b,a.slice(1,a.length));switch(a){case x.bool:return a6(b);case x.float4:case x.float8:case x.int2:case x.int4:case x.int8:case x.numeric:case x.oid:return a7(b);case x.json:case x.jsonb:return a8(b);case x.timestamp:return ba(b);case x.abstime:case x.date:case x.daterange:case x.int4range:case x.int8range:case x.money:case x.reltime:case x.text:case x.time:case x.timestamptz:case x.timetz:case x.tsrange:case x.tstzrange:default:return a5(b)}},a5=a=>a,a6=a=>{switch(a){case"t":return!0;case"f":return!1;default:return a}},a7=a=>{if("string"==typeof a){let b=parseFloat(a);if(!Number.isNaN(b))return b}return a},a8=a=>{if("string"==typeof a)try{return JSON.parse(a)}catch(a){}return a},a9=(a,b)=>{if("string"!=typeof a)return a;let c=a.length-1,d=a[c];if("{"===a[0]&&"}"===d){let d,e=a.slice(1,c);try{d=JSON.parse("["+e+"]")}catch(a){d=e?e.split(","):[]}return d.map(a=>a4(b,a))}return a},ba=a=>"string"==typeof a?a.replace(" ","T"):a,bb=a=>{let b=new URL(a);return b.protocol=b.protocol.replace(/^ws/i,"http"),b.pathname=b.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),""===b.pathname||"/"===b.pathname?b.pathname="/api/broadcast":b.pathname=b.pathname+"/api/broadcast",b.href};class bc{constructor(a,b,c={},d=1e4){this.channel=a,this.event=b,this.payload=c,this.timeout=d,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(a){this.timeout=a,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(a){this.payload=Object.assign(Object.assign({},this.payload),a)}receive(a,b){var c;return this._hasReceived(a)&&b(null==(c=this.receivedResp)?void 0:c.response),this.recHooks.push({status:a,callback:b}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let a=a=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=a,this._matchReceive(a)};this.channel._on(this.refEvent,{},a),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(a,b){this.refEvent&&this.channel._trigger(this.refEvent,{status:a,response:b})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:a,response:b}){this.recHooks.filter(b=>b.status===a).forEach(a=>a.callback(b))}_hasReceived(a){return this.receivedResp&&this.receivedResp.status===a}}(k=y||(y={})).SYNC="sync",k.JOIN="join",k.LEAVE="leave";class bd{constructor(a,b){this.channel=a,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const c=(null==b?void 0:b.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(c.state,{},a=>{let{onJoin:b,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=bd.syncState(this.state,a,b,c),this.pendingDiffs.forEach(a=>{this.state=bd.syncDiff(this.state,a,b,c)}),this.pendingDiffs=[],d()}),this.channel._on(c.diff,{},a=>{let{onJoin:b,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=bd.syncDiff(this.state,a,b,c),d())}),this.onJoin((a,b,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:b,newPresences:c})}),this.onLeave((a,b,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:b,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(a,b,c,d){let e=this.cloneDeep(a),f=this.transformState(b),g={},h={};return this.map(e,(a,b)=>{f[a]||(h[a]=b)}),this.map(f,(a,b)=>{let c=e[a];if(c){let d=b.map(a=>a.presence_ref),e=c.map(a=>a.presence_ref),f=b.filter(a=>0>e.indexOf(a.presence_ref)),i=c.filter(a=>0>d.indexOf(a.presence_ref));f.length>0&&(g[a]=f),i.length>0&&(h[a]=i)}else g[a]=b}),this.syncDiff(e,{joins:g,leaves:h},c,d)}static syncDiff(a,b,c,d){let{joins:e,leaves:f}={joins:this.transformState(b.joins),leaves:this.transformState(b.leaves)};return c||(c=()=>{}),d||(d=()=>{}),this.map(e,(b,d)=>{var e;let f=null!=(e=a[b])?e:[];if(a[b]=this.cloneDeep(d),f.length>0){let c=a[b].map(a=>a.presence_ref),d=f.filter(a=>0>c.indexOf(a.presence_ref));a[b].unshift(...d)}c(b,f,d)}),this.map(f,(b,c)=>{let e=a[b];if(!e)return;let f=c.map(a=>a.presence_ref);e=e.filter(a=>0>f.indexOf(a.presence_ref)),a[b]=e,d(b,e,c),0===e.length&&delete a[b]}),a}static map(a,b){return Object.getOwnPropertyNames(a).map(c=>b(c,a[c]))}static transformState(a){return Object.getOwnPropertyNames(a=this.cloneDeep(a)).reduce((b,c)=>{let d=a[c];return"metas"in d?b[c]=d.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):b[c]=d,b},{})}static cloneDeep(a){return JSON.parse(JSON.stringify(a))}onJoin(a){this.caller.onJoin=a}onLeave(a){this.caller.onLeave=a}onSync(a){this.caller.onSync=a}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(l=z||(z={})).ALL="*",l.INSERT="INSERT",l.UPDATE="UPDATE",l.DELETE="DELETE",(m=A||(A={})).BROADCAST="broadcast",m.PRESENCE="presence",m.POSTGRES_CHANGES="postgres_changes",m.SYSTEM="system",(n=B||(B={})).SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR";class be{constructor(a,b={config:{}},c){var d,e;if(this.topic=a,this.params=b,this.socket=c,this.bindings={},this.state=t.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=a.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},b.config),this.timeout=this.socket.timeout,this.joinPush=new bc(this,u.join,this.params,this.timeout),this.rejoinTimer=new a1(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=t.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=t.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=t.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=t.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=t.errored,this.rejoinTimer.scheduleTimeout())}),this._on(u.reply,{},(a,b)=>{this._trigger(this._replyEventName(b),a)}),this.presence=new bd(this),this.broadcastEndpointURL=bb(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null==(e=null==(d=this.params.config)?void 0:d.broadcast)?void 0:e.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(a,b=this.timeout){var c,d,e;if(this.socket.isConnected()||this.socket.connect(),this.state==t.closed){let{config:{broadcast:f,presence:g,private:h}}=this.params,i=null!=(d=null==(c=this.bindings.postgres_changes)?void 0:c.map(a=>a.filter))?d:[],j=!!this.bindings[A.PRESENCE]&&this.bindings[A.PRESENCE].length>0||(null==(e=this.params.config.presence)?void 0:e.enabled)===!0,k={},l={broadcast:f,presence:Object.assign(Object.assign({},g),{enabled:j}),postgres_changes:i,private:h};this.socket.accessTokenValue&&(k.access_token=this.socket.accessTokenValue),this._onError(b=>null==a?void 0:a(B.CHANNEL_ERROR,b)),this._onClose(()=>null==a?void 0:a(B.CLOSED)),this.updateJoinPayload(Object.assign({config:l},k)),this.joinedOnce=!0,this._rejoin(b),this.joinPush.receive("ok",async({postgres_changes:b})=>{var c;if(this.socket._isManualToken()||this.socket.setAuth(),void 0===b){null==a||a(B.SUBSCRIBED);return}{let d=this.bindings.postgres_changes,e=null!=(c=null==d?void 0:d.length)?c:0,f=[];for(let c=0;c<e;c++){let e=d[c],{filter:{event:g,schema:h,table:i,filter:j}}=e,k=b&&b[c];if(k&&k.event===g&&be.isFilterValueEqual(k.schema,h)&&be.isFilterValueEqual(k.table,i)&&be.isFilterValueEqual(k.filter,j))f.push(Object.assign(Object.assign({},e),{id:k.id}));else{this.unsubscribe(),this.state=t.errored,null==a||a(B.CHANNEL_ERROR,Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=f,a&&a(B.SUBSCRIBED);return}}).receive("error",b=>{this.state=t.errored,null==a||a(B.CHANNEL_ERROR,Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{null==a||a(B.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(a,b={}){return await this.send({type:"presence",event:"track",payload:a},b.timeout||this.timeout)}async untrack(a={}){return await this.send({type:"presence",event:"untrack"},a)}on(a,b,c){return this.state===t.joined&&a===A.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(a,b,c)}async httpSend(a,b,c={}){var d;if(null==b)return Promise.reject("Payload is required for httpSend()");let e={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(e.Authorization=`Bearer ${this.socket.accessTokenValue}`);let f={method:"POST",headers:e,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:b,private:this.private}]})},g=await this._fetchWithTimeout(this.broadcastEndpointURL,f,null!=(d=c.timeout)?d:this.timeout);if(202===g.status)return{success:!0};let h=g.statusText;try{let a=await g.json();h=a.error||a.message||h}catch(a){}return Promise.reject(Error(h))}async send(a,b={}){var c,d;if(this._canPush()||"broadcast"!==a.type)return new Promise(c=>{var d,e,f;let g=this._push(a.type,a,b.timeout||this.timeout);"broadcast"!==a.type||(null==(f=null==(e=null==(d=this.params)?void 0:d.config)?void 0:e.broadcast)?void 0:f.ack)||c("ok"),g.receive("ok",()=>c("ok")),g.receive("error",()=>c("error")),g.receive("timeout",()=>c("timed out"))});{console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");let{event:e,payload:f}=a,g={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(g.Authorization=`Bearer ${this.socket.accessTokenValue}`);let h={method:"POST",headers:g,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:f,private:this.private}]})};try{let a=await this._fetchWithTimeout(this.broadcastEndpointURL,h,null!=(c=b.timeout)?c:this.timeout);return await (null==(d=a.body)?void 0:d.cancel()),a.ok?"ok":"error"}catch(a){if("AbortError"===a.name)return"timed out";return"error"}}}updateJoinPayload(a){this.joinPush.updatePayload(a)}unsubscribe(a=this.timeout){this.state=t.leaving;let b=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(u.close,"leave",this._joinRef())};this.joinPush.destroy();let c=null;return new Promise(d=>{(c=new bc(this,u.leave,{},a)).receive("ok",()=>{b(),d("ok")}).receive("timeout",()=>{b(),d("timed out")}).receive("error",()=>{d("error")}),c.send(),this._canPush()||c.trigger("ok",{})}).finally(()=>{null==c||c.destroy()})}teardown(){this.pushBuffer.forEach(a=>a.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=t.closed,this.bindings={}}async _fetchWithTimeout(a,b,c){let d=new AbortController,e=setTimeout(()=>d.abort(),c),f=await this.socket.fetch(a,Object.assign(Object.assign({},b),{signal:d.signal}));return clearTimeout(e),f}_push(a,b,c=this.timeout){if(!this.joinedOnce)throw`tried to push '${a}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let d=new bc(this,a,b,c);return this._canPush()?d.send():this._addToPushBuffer(d),d}_addToPushBuffer(a){if(a.startTimeout(),this.pushBuffer.push(a),this.pushBuffer.length>100){let a=this.pushBuffer.shift();a&&(a.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${a.event}`,a.payload))}}_onMessage(a,b,c){return b}_isMember(a){return this.topic===a}_joinRef(){return this.joinPush.ref}_trigger(a,b,c){var d,e;let f=a.toLocaleLowerCase(),{close:g,error:h,leave:i,join:j}=u;if(c&&[g,h,i,j].indexOf(f)>=0&&c!==this._joinRef())return;let k=this._onMessage(f,b,c);if(b&&!k)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?null==(d=this.bindings.postgres_changes)||d.filter(a=>{var b,c,d;return(null==(b=a.filter)?void 0:b.event)==="*"||(null==(d=null==(c=a.filter)?void 0:c.event)?void 0:d.toLocaleLowerCase())===f}).map(a=>a.callback(k,c)):null==(e=this.bindings[f])||e.filter(a=>{var c,d,e,g,h,i;if(!["broadcast","presence","postgres_changes"].includes(f))return a.type.toLocaleLowerCase()===f;if("id"in a){let f=a.id,g=null==(c=a.filter)?void 0:c.event;return f&&(null==(d=b.ids)?void 0:d.includes(f))&&("*"===g||(null==g?void 0:g.toLocaleLowerCase())===(null==(e=b.data)?void 0:e.type.toLocaleLowerCase()))}{let c=null==(h=null==(g=null==a?void 0:a.filter)?void 0:g.event)?void 0:h.toLocaleLowerCase();return"*"===c||c===(null==(i=null==b?void 0:b.event)?void 0:i.toLocaleLowerCase())}}).map(a=>{if("object"==typeof k&&"ids"in k){let a=k.data,{schema:b,table:c,commit_timestamp:d,type:e,errors:f}=a;k=Object.assign(Object.assign({},{schema:b,table:c,commit_timestamp:d,eventType:e,new:{},old:{},errors:f}),this._getPayloadRecords(a))}a.callback(k,c)})}_isClosed(){return this.state===t.closed}_isJoined(){return this.state===t.joined}_isJoining(){return this.state===t.joining}_isLeaving(){return this.state===t.leaving}_replyEventName(a){return`chan_reply_${a}`}_on(a,b,c){let d=a.toLocaleLowerCase(),e={type:d,filter:b,callback:c};return this.bindings[d]?this.bindings[d].push(e):this.bindings[d]=[e],this}_off(a,b){let c=a.toLocaleLowerCase();return this.bindings[c]&&(this.bindings[c]=this.bindings[c].filter(a=>{var d;return!((null==(d=a.type)?void 0:d.toLocaleLowerCase())===c&&be.isEqual(a.filter,b))})),this}static isEqual(a,b){if(Object.keys(a).length!==Object.keys(b).length)return!1;for(let c in a)if(a[c]!==b[c])return!1;return!0}static isFilterValueEqual(a,b){return(null!=a?a:void 0)===(null!=b?b:void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(a){this._on(u.close,{},a)}_onError(a){this._on(u.error,{},b=>a(b))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(a=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=t.joining,this.joinPush.resend(a))}_getPayloadRecords(a){let b={new:{},old:{}};return("INSERT"===a.type||"UPDATE"===a.type)&&(b.new=a2(a.columns,a.record)),("UPDATE"===a.type||"DELETE"===a.type)&&(b.old=a2(a.columns,a.old_record)),b}}let bf=()=>{},bg=[1e3,2e3,5e3,1e4],bh=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class bi{constructor(a,b){var c;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=1e4,this.transport=null,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=bf,this.ref=0,this.reconnectTimer=null,this.vsn=a_,this.logger=bf,this.conn=null,this.sendBuffer=[],this.serializer=new a0,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=a=>a?(...b)=>a(...b):(...a)=>fetch(...a),!(null==(c=null==b?void 0:b.params)?void 0:c.apikey))throw Error("API key is required to connect to Realtime");this.apiKey=b.params.apikey,this.endPoint=`${a}/${v.websocket}`,this.httpEndpoint=bb(a),this._initializeOptions(b),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==b?void 0:b.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=a$.createWebSocket(this.endpointURL())}catch(b){this._setConnectionState("disconnected");let a=b.message;if(a.includes("Node.js"))throw Error(`${a}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`);throw Error(`WebSocket not available: ${a}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(a,b){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){let c=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(c),this._setConnectionState("disconnected")},"function"==typeof this.conn.close&&(a?this.conn.close(a,null!=b?b:""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(a){let b=await a.unsubscribe();return 0===this.channels.length&&this.disconnect(),b}async removeAllChannels(){let a=await Promise.all(this.channels.map(a=>a.unsubscribe()));return this.channels=[],this.disconnect(),a}log(a,b,c){this.logger(a,b,c)}connectionState(){switch(this.conn&&this.conn.readyState){case s.connecting:return w.Connecting;case s.open:return w.Open;case s.closing:return w.Closing;default:return w.Closed}}isConnected(){return this.connectionState()===w.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(a,b={config:{}}){let c=`realtime:${a}`,d=this.getChannels().find(a=>a.topic===c);if(d)return d;{let c=new be(`realtime:${a}`,b,this);return this.channels.push(c),c}}push(a){let{topic:b,event:c,payload:d,ref:e}=a,f=()=>{this.encode(a,a=>{var b;null==(b=this.conn)||b.send(a)})};this.log("push",`${b} ${c} (${e})`,d),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(a=null){this._authPromise=this._performAuth(a);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var a;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(a){this.log("error","error in heartbeat callback",a)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(a){this.log("error","error in heartbeat callback",a)}this._wasManualDisconnect=!1,null==(a=this.conn)||a.close(1e3,"heartbeat timeout"),setTimeout(()=>{var a;this.isConnected()||null==(a=this.reconnectTimer)||a.scheduleTimeout()},100);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(a){this.log("error","error in heartbeat callback",a)}this._setAuthSafely("heartbeat")}onHeartbeat(a){this.heartbeatCallback=a}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(a=>a()),this.sendBuffer=[])}_makeRef(){let a=this.ref+1;return a===this.ref?this.ref=0:this.ref=a,this.ref.toString()}_leaveOpenTopic(a){let b=this.channels.find(b=>b.topic===a&&(b._isJoined()||b._isJoining()));b&&(this.log("transport",`leaving duplicate topic "${a}"`),b.unsubscribe())}_remove(a){this.channels=this.channels.filter(b=>b.topic!==a.topic)}_onConnMessage(a){this.decode(a.data,a=>{if("phoenix"===a.topic&&"phx_reply"===a.event&&a.ref&&a.ref===this.pendingHeartbeatRef){let b=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback("ok"===a.payload.status?"ok":"error",b)}catch(a){this.log("error","error in heartbeat callback",a)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}let{topic:b,event:c,payload:d,ref:e}=a,f=e?`(${e})`:"",g=d.status||"";this.log("receive",`${g} ${b} ${c} ${f}`.trim(),d),this.channels.filter(a=>a._isMember(b)).forEach(a=>a._trigger(c,d,e)),this._triggerStateCallbacks("message",a)})}_clearTimer(a){var b;"heartbeat"===a&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===a&&(null==(b=this.reconnectTimer)||b.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=a=>this._onConnError(a),this.conn.onmessage=a=>this._onConnMessage(a),this.conn.onclose=a=>this._onConnClose(a),this.conn.readyState===s.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===s.open||this.conn.readyState===s.connecting)try{this.conn.close()}catch(a){this.log("error","Error closing connection",a)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(a=>a.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(a=>{this.log("error","error waiting for auth on connect",a),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let a=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(a),this.workerRef.onerror=a=>{this.log("worker","worker error",a.message),this._terminateWorker()},this.workerRef.onmessage=a=>{"keepAlive"===a.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(a){var b;this._setConnectionState("disconnected"),this.log("transport","close",a),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null==(b=this.reconnectTimer)||b.scheduleTimeout(),this._triggerStateCallbacks("close",a)}_onConnError(a){this._setConnectionState("disconnected"),this.log("transport",`${a}`),this._triggerChanError(),this._triggerStateCallbacks("error",a);try{this.heartbeatCallback("error")}catch(a){this.log("error","error in heartbeat callback",a)}}_triggerChanError(){this.channels.forEach(a=>a._trigger(u.error))}_appendParams(a,b){if(0===Object.keys(b).length)return a;let c=a.match(/\?/)?"&":"?",d=new URLSearchParams(b);return`${a}${c}${d}`}_workerObjectUrl(a){let b;if(a)b=a;else{let a=new Blob([bh],{type:"application/javascript"});b=URL.createObjectURL(a)}return b}_setConnectionState(a,b=!1){this._connectionState=a,"connecting"===a?this._wasManualDisconnect=!1:"disconnecting"===a&&(this._wasManualDisconnect=b)}async _performAuth(a=null){let b,c=!1;if(a)b=a,c=!0;else if(this.accessToken)try{b=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),b=this.accessTokenValue}else b=this.accessTokenValue;c?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=b&&(this.accessTokenValue=b,this.channels.forEach(a=>{let c={access_token:b,version:"realtime-js/2.97.0"};b&&a.updateJoinPayload(c),a.joinedOnce&&a._isJoined()&&a._push(u.access_token,{access_token:b})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(a="general"){this._isManualToken()||this.setAuth().catch(b=>{this.log("error",`Error setting auth in ${a}`,b)})}_triggerStateCallbacks(a,b){try{this.stateChangeCallbacks[a].forEach(c=>{try{c(b)}catch(b){this.log("error",`error in ${a} callback`,b)}})}catch(b){this.log("error",`error triggering ${a} callbacks`,b)}}_setupReconnectionTimer(){this.reconnectTimer=new a1(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},10)},this.reconnectAfterMs)}_initializeOptions(a){var b,c,d,e,f,g,h,i,j,k,l,m;switch(this.transport=null!=(b=null==a?void 0:a.transport)?b:null,this.timeout=null!=(c=null==a?void 0:a.timeout)?c:1e4,this.heartbeatIntervalMs=null!=(d=null==a?void 0:a.heartbeatIntervalMs)?d:25e3,this.worker=null!=(e=null==a?void 0:a.worker)&&e,this.accessToken=null!=(f=null==a?void 0:a.accessToken)?f:null,this.heartbeatCallback=null!=(g=null==a?void 0:a.heartbeatCallback)?g:bf,this.vsn=null!=(h=null==a?void 0:a.vsn)?h:a_,(null==a?void 0:a.params)&&(this.params=a.params),(null==a?void 0:a.logger)&&(this.logger=a.logger),((null==a?void 0:a.logLevel)||(null==a?void 0:a.log_level))&&(this.logLevel=a.logLevel||a.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!=(i=null==a?void 0:a.reconnectAfterMs)?i:a=>bg[a-1]||1e4,this.vsn){case"1.0.0":this.encode=null!=(j=null==a?void 0:a.encode)?j:(a,b)=>b(JSON.stringify(a)),this.decode=null!=(k=null==a?void 0:a.decode)?k:(a,b)=>b(JSON.parse(a));break;case a_:this.encode=null!=(l=null==a?void 0:a.encode)?l:this.serializer.encode.bind(this.serializer),this.decode=null!=(m=null==a?void 0:a.decode)?m:this.serializer.decode.bind(this.serializer);break;default:throw Error(`Unsupported serializer version: ${this.vsn}`)}this.worker&&(this.workerUrl=null==a?void 0:a.workerUrl)}}var bj=class extends Error{constructor(a,b){super(a),this.name="IcebergError",this.status=b.status,this.icebergType=b.icebergType,this.icebergCode=b.icebergCode,this.details=b.details,this.isCommitStateUnknown="CommitStateUnknownException"===b.icebergType||[500,502,504].includes(b.status)&&b.icebergType?.includes("CommitState")===!0}isNotFound(){return 404===this.status}isConflict(){return 409===this.status}isAuthenticationTimeout(){return 419===this.status}};async function bk(a){return a&&"none"!==a.type?"bearer"===a.type?{Authorization:`Bearer ${a.token}`}:"header"===a.type?{[a.name]:a.value}:"custom"===a.type?await a.getHeaders():{}:{}}function bl(a){return a.join("\x1f")}var bm=class{constructor(a,b=""){this.client=a,this.prefix=b}async listNamespaces(a){let b=a?{parent:bl(a.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:b})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(a,b){let c={namespace:a.namespace,properties:b?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:c})).data}async dropNamespace(a){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${bl(a.namespace)}`})}async loadNamespaceMetadata(a){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${bl(a.namespace)}`})).data.properties}}async namespaceExists(a){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${bl(a.namespace)}`}),!0}catch(a){if(a instanceof bj&&404===a.status)return!1;throw a}}async createNamespaceIfNotExists(a,b){try{return await this.createNamespace(a,b)}catch(a){if(a instanceof bj&&409===a.status)return;throw a}}};function bn(a){return a.join("\x1f")}var bo=class{constructor(a,b="",c){this.client=a,this.prefix=b,this.accessDelegation=c}async listTables(a){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${bn(a.namespace)}/tables`})).data.identifiers}async createTable(a,b){let c={};return this.accessDelegation&&(c["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${bn(a.namespace)}/tables`,body:b,headers:c})).data.metadata}async updateTable(a,b){let c=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${bn(a.namespace)}/tables/${a.name}`,body:b});return{"metadata-location":c.data["metadata-location"],metadata:c.data.metadata}}async dropTable(a,b){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${bn(a.namespace)}/tables/${a.name}`,query:{purgeRequested:String(b?.purge??!1)}})}async loadTable(a){let b={};return this.accessDelegation&&(b["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${bn(a.namespace)}/tables/${a.name}`,headers:b})).data.metadata}async tableExists(a){let b={};this.accessDelegation&&(b["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${bn(a.namespace)}/tables/${a.name}`,headers:b}),!0}catch(a){if(a instanceof bj&&404===a.status)return!1;throw a}}async createTableIfNotExists(a,b){try{return await this.createTable(a,b)}catch(c){if(c instanceof bj&&409===c.status)return await this.loadTable({namespace:a.namespace,name:b.name});throw c}}},bp=class{constructor(a){let b="v1";a.catalogName&&(b+=`/${a.catalogName}`);const c=a.baseUrl.endsWith("/")?a.baseUrl:`${a.baseUrl}/`;this.client=function(a){let b=a.fetchImpl??globalThis.fetch;return{async request({method:c,path:d,query:e,body:f,headers:g}){let h=function(a,b,c){let d=new URL(b,a);if(c)for(let[a,b]of Object.entries(c))void 0!==b&&d.searchParams.set(a,b);return d.toString()}(a.baseUrl,d,e),i=await bk(a.auth),j=await b(h,{method:c,headers:{...f?{"Content-Type":"application/json"}:{},...i,...g},body:f?JSON.stringify(f):void 0}),k=await j.text(),l=(j.headers.get("content-type")||"").includes("application/json"),m=l&&k?JSON.parse(k):k;if(!j.ok){let a=l?m:void 0,b=a?.error;throw new bj(b?.message??`Request failed with status ${j.status}`,{status:j.status,icebergType:b?.type,icebergCode:b?.code,details:a})}return{status:j.status,headers:j.headers,data:m}}}}({baseUrl:c,auth:a.auth,fetchImpl:a.fetch}),this.accessDelegation=a.accessDelegation?.join(","),this.namespaceOps=new bm(this.client,b),this.tableOps=new bo(this.client,b,this.accessDelegation)}async listNamespaces(a){return this.namespaceOps.listNamespaces(a)}async createNamespace(a,b){return this.namespaceOps.createNamespace(a,b)}async dropNamespace(a){await this.namespaceOps.dropNamespace(a)}async loadNamespaceMetadata(a){return this.namespaceOps.loadNamespaceMetadata(a)}async listTables(a){return this.tableOps.listTables(a)}async createTable(a,b){return this.tableOps.createTable(a,b)}async updateTable(a,b){return this.tableOps.updateTable(a,b)}async dropTable(a,b){await this.tableOps.dropTable(a,b)}async loadTable(a){return this.tableOps.loadTable(a)}async namespaceExists(a){return this.namespaceOps.namespaceExists(a)}async tableExists(a){return this.tableOps.tableExists(a)}async createNamespaceIfNotExists(a,b){return this.namespaceOps.createNamespaceIfNotExists(a,b)}async createTableIfNotExists(a,b){return this.tableOps.createTableIfNotExists(a,b)}},bq=class extends Error{constructor(a,b="storage",c,d){super(a),this.__isStorageError=!0,this.namespace=b,this.name="vectors"===b?"StorageVectorsError":"StorageError",this.status=c,this.statusCode=d}};function br(a){return"object"==typeof a&&null!==a&&"__isStorageError"in a}var bs=class extends bq{constructor(a,b,c,d="storage"){super(a,d,b,c),this.name="vectors"===d?"StorageVectorsApiError":"StorageApiError",this.status=b,this.statusCode=c}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},bt=class extends bq{constructor(a,b,c="storage"){super(a,c),this.name="vectors"===c?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=b}};let bu=a=>{if(Array.isArray(a))return a.map(a=>bu(a));if("function"==typeof a||a!==Object(a))return a;let b={};return Object.entries(a).forEach(([a,c])=>{b[a.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""))]=bu(c)}),b};function bv(a){return(bv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function bw(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function bx(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?bw(Object(c),!0).forEach(function(b){!function(a,b,c){var d;(d=function(a,b){if("object"!=bv(a)||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=bv(d))return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(b,"string"),(b="symbol"==bv(d)?d:d+"")in a)?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c}(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):bw(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}let by=a=>{var b;return a.msg||a.message||a.error_description||("string"==typeof a.error?a.error:null==(b=a.error)?void 0:b.message)||JSON.stringify(a)},bz=async(a,b,c,d)=>{if(a&&"object"==typeof a&&"status"in a&&"ok"in a&&"number"==typeof a.status&&!(null==c?void 0:c.noResolveJson)){let c=a.status||500;"function"==typeof a.json?a.json().then(a=>{let e=(null==a?void 0:a.statusCode)||(null==a?void 0:a.code)||c+"";b(new bs(by(a),c,e,d))}).catch(()=>{b(new bs(a.statusText||`HTTP ${c} error`,c,c+"",d))}):b(new bs(a.statusText||`HTTP ${c} error`,c,c+"",d))}else b(new bt(by(a),a,d))};async function bA(a,b,c,d,e,f,g){return new Promise((h,i)=>{let j;a(c,(j={method:b,headers:(null==d?void 0:d.headers)||{}},"GET"===b||"HEAD"===b||!f||((a=>{if("object"!=typeof a||null===a)return!1;let b=Object.getPrototypeOf(a);return(null===b||b===Object.prototype||null===Object.getPrototypeOf(b))&&!(Symbol.toStringTag in a)&&!(Symbol.iterator in a)})(f)?(j.headers=bx({"Content-Type":"application/json"},null==d?void 0:d.headers),j.body=JSON.stringify(f)):j.body=f,(null==d?void 0:d.duplex)&&(j.duplex=d.duplex)),bx(bx({},j),e))).then(a=>{if(!a.ok)throw a;if(null==d?void 0:d.noResolveJson)return a;if("vectors"===g){let b=a.headers.get("content-type");if("0"===a.headers.get("content-length")||204===a.status||!b||!b.includes("application/json"))return{}}return a.json()}).then(a=>h(a)).catch(a=>bz(a,i,d,g))})}function bB(a="storage"){return{get:async(b,c,d,e)=>bA(b,"GET",c,d,e,void 0,a),post:async(b,c,d,e,f)=>bA(b,"POST",c,e,f,d,a),put:async(b,c,d,e,f)=>bA(b,"PUT",c,e,f,d,a),head:async(b,c,d,e)=>bA(b,"HEAD",c,bx(bx({},d),{},{noResolveJson:!0}),e,void 0,a),remove:async(b,c,d,e,f)=>bA(b,"DELETE",c,e,f,d,a)}}let{get:bC,post:bD,put:bE,head:bF,remove:bG}=bB("storage"),bH=bB("vectors");var bI=class{constructor(a,b={},c,d="storage"){this.shouldThrowOnError=!1,this.url=a,this.headers=b,this.fetch=(a=>a?(...b)=>a(...b):(...a)=>fetch(...a))(c),this.namespace=d}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,b){return this.headers=bx(bx({},this.headers),{},{[a]:b}),this}async handleOperation(a){try{return{data:await a(),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(br(a))return{data:null,error:a};throw a}}},bJ=class{constructor(a,b){this.downloadFn=a,this.shouldThrowOnError=b}then(a,b){return this.execute().then(a,b)}async execute(){try{return{data:(await this.downloadFn()).body,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(br(a))return{data:null,error:a};throw a}}};b=Symbol.toStringTag;var bK=class{constructor(a,c){this.downloadFn=a,this.shouldThrowOnError=c,this[b]="BlobDownloadBuilder",this.promise=null}asStream(){return new bJ(this.downloadFn,this.shouldThrowOnError)}then(a,b){return this.getPromise().then(a,b)}catch(a){return this.getPromise().catch(a)}finally(a){return this.getPromise().finally(a)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){try{return{data:await (await this.downloadFn()).blob(),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(br(a))return{data:null,error:a};throw a}}};let bL={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},bM={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var bN=class extends bI{constructor(a,b={},c,d){super(a,b,d,"storage"),this.bucketId=c}async uploadOrUpdate(a,b,c,d){var e=this;return e.handleOperation(async()=>{let f,g=bx(bx({},bM),d),h=bx(bx({},e.headers),"POST"===a&&{"x-upsert":String(g.upsert)}),i=g.metadata;"u">typeof Blob&&c instanceof Blob?((f=new FormData).append("cacheControl",g.cacheControl),i&&f.append("metadata",e.encodeMetadata(i)),f.append("",c)):"u">typeof FormData&&c instanceof FormData?((f=c).has("cacheControl")||f.append("cacheControl",g.cacheControl),i&&!f.has("metadata")&&f.append("metadata",e.encodeMetadata(i))):(f=c,h["cache-control"]=`max-age=${g.cacheControl}`,h["content-type"]=g.contentType,i&&(h["x-metadata"]=e.toBase64(e.encodeMetadata(i))),("u">typeof ReadableStream&&f instanceof ReadableStream||f&&"object"==typeof f&&"pipe"in f&&"function"==typeof f.pipe)&&!g.duplex&&(g.duplex="half")),(null==d?void 0:d.headers)&&(h=bx(bx({},h),d.headers));let j=e._removeEmptyFolders(b),k=e._getFinalPath(j),l=await ("PUT"==a?bE:bD)(e.fetch,`${e.url}/object/${k}`,f,bx({headers:h},(null==g?void 0:g.duplex)?{duplex:g.duplex}:{}));return{path:j,id:l.Id,fullPath:l.Key}})}async upload(a,b,c){return this.uploadOrUpdate("POST",a,b,c)}async uploadToSignedUrl(a,b,c,d){var e=this;let f=e._removeEmptyFolders(a),g=e._getFinalPath(f),h=new URL(e.url+`/object/upload/sign/${g}`);return h.searchParams.set("token",b),e.handleOperation(async()=>{let a,b=bx({upsert:bM.upsert},d),g=bx(bx({},e.headers),{"x-upsert":String(b.upsert)});return"u">typeof Blob&&c instanceof Blob?((a=new FormData).append("cacheControl",b.cacheControl),a.append("",c)):"u">typeof FormData&&c instanceof FormData?(a=c).append("cacheControl",b.cacheControl):(a=c,g["cache-control"]=`max-age=${b.cacheControl}`,g["content-type"]=b.contentType),{path:f,fullPath:(await bE(e.fetch,h.toString(),a,{headers:g})).Key}})}async createSignedUploadUrl(a,b){var c=this;return c.handleOperation(async()=>{let d=c._getFinalPath(a),e=bx({},c.headers);(null==b?void 0:b.upsert)&&(e["x-upsert"]="true");let f=await bD(c.fetch,`${c.url}/object/upload/sign/${d}`,{},{headers:e}),g=new URL(c.url+f.url),h=g.searchParams.get("token");if(!h)throw new bq("No token returned by API");return{signedUrl:g.toString(),path:a,token:h}})}async update(a,b,c){return this.uploadOrUpdate("PUT",a,b,c)}async move(a,b,c){var d=this;return d.handleOperation(async()=>await bD(d.fetch,`${d.url}/object/move`,{bucketId:d.bucketId,sourceKey:a,destinationKey:b,destinationBucket:null==c?void 0:c.destinationBucket},{headers:d.headers}))}async copy(a,b,c){var d=this;return d.handleOperation(async()=>({path:(await bD(d.fetch,`${d.url}/object/copy`,{bucketId:d.bucketId,sourceKey:a,destinationKey:b,destinationBucket:null==c?void 0:c.destinationBucket},{headers:d.headers})).Key}))}async createSignedUrl(a,b,c){var d=this;return d.handleOperation(async()=>{let e=d._getFinalPath(a),f=await bD(d.fetch,`${d.url}/object/sign/${e}`,bx({expiresIn:b},(null==c?void 0:c.transform)?{transform:c.transform}:{}),{headers:d.headers}),g=(null==c?void 0:c.download)?`&download=${!0===c.download?"":c.download}`:"";return{signedUrl:encodeURI(`${d.url}${f.signedURL}${g}`)}})}async createSignedUrls(a,b,c){var d=this;return d.handleOperation(async()=>{let e=await bD(d.fetch,`${d.url}/object/sign/${d.bucketId}`,{expiresIn:b,paths:a},{headers:d.headers}),f=(null==c?void 0:c.download)?`&download=${!0===c.download?"":c.download}`:"";return e.map(a=>bx(bx({},a),{},{signedUrl:a.signedURL?encodeURI(`${d.url}${a.signedURL}${f}`):null}))})}download(a,b,c){let d=void 0!==(null==b?void 0:b.transform)?"render/image/authenticated":"object",e=this.transformOptsToQueryString((null==b?void 0:b.transform)||{}),f=e?`?${e}`:"",g=this._getFinalPath(a);return new bK(()=>bC(this.fetch,`${this.url}/${d}/${g}${f}`,{headers:this.headers,noResolveJson:!0},c),this.shouldThrowOnError)}async info(a){var b=this;let c=b._getFinalPath(a);return b.handleOperation(async()=>bu(await bC(b.fetch,`${b.url}/object/info/${c}`,{headers:b.headers})))}async exists(a){let b=this._getFinalPath(a);try{return await bF(this.fetch,`${this.url}/object/${b}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(br(a)&&a instanceof bt){let b=a.originalError;if([400,404].includes(null==b?void 0:b.status))return{data:!1,error:a}}throw a}}getPublicUrl(a,b){let c=this._getFinalPath(a),d=[],e=(null==b?void 0:b.download)?`download=${!0===b.download?"":b.download}`:"";""!==e&&d.push(e);let f=void 0!==(null==b?void 0:b.transform)?"render/image":"object",g=this.transformOptsToQueryString((null==b?void 0:b.transform)||{});""!==g&&d.push(g);let h=d.join("&");return""!==h&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${f}/public/${c}${h}`)}}}async remove(a){var b=this;return b.handleOperation(async()=>await bG(b.fetch,`${b.url}/object/${b.bucketId}`,{prefixes:a},{headers:b.headers}))}async list(a,b,c){var d=this;return d.handleOperation(async()=>{let e=bx(bx(bx({},bL),b),{},{prefix:a||""});return await bD(d.fetch,`${d.url}/object/list/${d.bucketId}`,e,{headers:d.headers},c)})}async listV2(a,b){var c=this;return c.handleOperation(async()=>{let d=bx({},a);return await bD(c.fetch,`${c.url}/object/list-v2/${c.bucketId}`,d,{headers:c.headers},b)})}encodeMetadata(a){return JSON.stringify(a)}toBase64(a){return"u">typeof Buffer?Buffer.from(a).toString("base64"):btoa(a)}_getFinalPath(a){return`${this.bucketId}/${a.replace(/^\/+/,"")}`}_removeEmptyFolders(a){return a.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(a){let b=[];return a.width&&b.push(`width=${a.width}`),a.height&&b.push(`height=${a.height}`),a.resize&&b.push(`resize=${a.resize}`),a.format&&b.push(`format=${a.format}`),a.quality&&b.push(`quality=${a.quality}`),b.join("&")}};let bO={"X-Client-Info":"storage-js/2.97.0"};var bP=class extends bI{constructor(a,b={},c,d){const e=new URL(a);(null==d?void 0:d.useNewHostname)&&/supabase\.(co|in|red)$/.test(e.hostname)&&!e.hostname.includes("storage.supabase.")&&(e.hostname=e.hostname.replace("supabase.","storage.supabase.")),super(e.href.replace(/\/$/,""),bx(bx({},bO),b),c,"storage")}async listBuckets(a){var b=this;return b.handleOperation(async()=>{let c=b.listBucketOptionsToQueryString(a);return await bC(b.fetch,`${b.url}/bucket${c}`,{headers:b.headers})})}async getBucket(a){var b=this;return b.handleOperation(async()=>await bC(b.fetch,`${b.url}/bucket/${a}`,{headers:b.headers}))}async createBucket(a,b={public:!1}){var c=this;return c.handleOperation(async()=>await bD(c.fetch,`${c.url}/bucket`,{id:a,name:a,type:b.type,public:b.public,file_size_limit:b.fileSizeLimit,allowed_mime_types:b.allowedMimeTypes},{headers:c.headers}))}async updateBucket(a,b){var c=this;return c.handleOperation(async()=>await bE(c.fetch,`${c.url}/bucket/${a}`,{id:a,name:a,public:b.public,file_size_limit:b.fileSizeLimit,allowed_mime_types:b.allowedMimeTypes},{headers:c.headers}))}async emptyBucket(a){var b=this;return b.handleOperation(async()=>await bD(b.fetch,`${b.url}/bucket/${a}/empty`,{},{headers:b.headers}))}async deleteBucket(a){var b=this;return b.handleOperation(async()=>await bG(b.fetch,`${b.url}/bucket/${a}`,{},{headers:b.headers}))}listBucketOptionsToQueryString(a){let b={};return a&&("limit"in a&&(b.limit=String(a.limit)),"offset"in a&&(b.offset=String(a.offset)),a.search&&(b.search=a.search),a.sortColumn&&(b.sortColumn=a.sortColumn),a.sortOrder&&(b.sortOrder=a.sortOrder)),Object.keys(b).length>0?"?"+new URLSearchParams(b).toString():""}},bQ=class extends bI{constructor(a,b={},c){super(a.replace(/\/$/,""),bx(bx({},bO),b),c,"storage")}async createBucket(a){var b=this;return b.handleOperation(async()=>await bD(b.fetch,`${b.url}/bucket`,{name:a},{headers:b.headers}))}async listBuckets(a){var b=this;return b.handleOperation(async()=>{let c=new URLSearchParams;(null==a?void 0:a.limit)!==void 0&&c.set("limit",a.limit.toString()),(null==a?void 0:a.offset)!==void 0&&c.set("offset",a.offset.toString()),(null==a?void 0:a.sortColumn)&&c.set("sortColumn",a.sortColumn),(null==a?void 0:a.sortOrder)&&c.set("sortOrder",a.sortOrder),(null==a?void 0:a.search)&&c.set("search",a.search);let d=c.toString(),e=d?`${b.url}/bucket?${d}`:`${b.url}/bucket`;return await bC(b.fetch,e,{headers:b.headers})})}async deleteBucket(a){var b=this;return b.handleOperation(async()=>await bG(b.fetch,`${b.url}/bucket/${a}`,{},{headers:b.headers}))}from(a){var b=this;if(!(!(!a||"string"!=typeof a||0===a.length||a.length>100||a.trim()!==a||a.includes("/")||a.includes("\\"))&&/^[\w!.\*'() &$@=;:+,?-]+$/.test(a)))throw new bq("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");let c=new bp({baseUrl:this.url,catalogName:a,auth:{type:"custom",getHeaders:async()=>b.headers},fetch:this.fetch}),d=this.shouldThrowOnError;return new Proxy(c,{get(a,b){let c=a[b];return"function"!=typeof c?c:async(...b)=>{try{return{data:await c.apply(a,b),error:null}}catch(a){if(d)throw a;return{data:null,error:a}}}}})}},bR=class extends bI{constructor(a,b={},c){super(a.replace(/\/$/,""),bx(bx({},bO),{},{"Content-Type":"application/json"},b),c,"vectors")}async createIndex(a){var b=this;return b.handleOperation(async()=>await bH.post(b.fetch,`${b.url}/CreateIndex`,a,{headers:b.headers})||{})}async getIndex(a,b){var c=this;return c.handleOperation(async()=>await bH.post(c.fetch,`${c.url}/GetIndex`,{vectorBucketName:a,indexName:b},{headers:c.headers}))}async listIndexes(a){var b=this;return b.handleOperation(async()=>await bH.post(b.fetch,`${b.url}/ListIndexes`,a,{headers:b.headers}))}async deleteIndex(a,b){var c=this;return c.handleOperation(async()=>await bH.post(c.fetch,`${c.url}/DeleteIndex`,{vectorBucketName:a,indexName:b},{headers:c.headers})||{})}},bS=class extends bI{constructor(a,b={},c){super(a.replace(/\/$/,""),bx(bx({},bO),{},{"Content-Type":"application/json"},b),c,"vectors")}async putVectors(a){var b=this;if(a.vectors.length<1||a.vectors.length>500)throw Error("Vector batch size must be between 1 and 500 items");return b.handleOperation(async()=>await bH.post(b.fetch,`${b.url}/PutVectors`,a,{headers:b.headers})||{})}async getVectors(a){var b=this;return b.handleOperation(async()=>await bH.post(b.fetch,`${b.url}/GetVectors`,a,{headers:b.headers}))}async listVectors(a){var b=this;if(void 0!==a.segmentCount){if(a.segmentCount<1||a.segmentCount>16)throw Error("segmentCount must be between 1 and 16");if(void 0!==a.segmentIndex&&(a.segmentIndex<0||a.segmentIndex>=a.segmentCount))throw Error(`segmentIndex must be between 0 and ${a.segmentCount-1}`)}return b.handleOperation(async()=>await bH.post(b.fetch,`${b.url}/ListVectors`,a,{headers:b.headers}))}async queryVectors(a){var b=this;return b.handleOperation(async()=>await bH.post(b.fetch,`${b.url}/QueryVectors`,a,{headers:b.headers}))}async deleteVectors(a){var b=this;if(a.keys.length<1||a.keys.length>500)throw Error("Keys batch size must be between 1 and 500 items");return b.handleOperation(async()=>await bH.post(b.fetch,`${b.url}/DeleteVectors`,a,{headers:b.headers})||{})}},bT=class extends bI{constructor(a,b={},c){super(a.replace(/\/$/,""),bx(bx({},bO),{},{"Content-Type":"application/json"},b),c,"vectors")}async createBucket(a){var b=this;return b.handleOperation(async()=>await bH.post(b.fetch,`${b.url}/CreateVectorBucket`,{vectorBucketName:a},{headers:b.headers})||{})}async getBucket(a){var b=this;return b.handleOperation(async()=>await bH.post(b.fetch,`${b.url}/GetVectorBucket`,{vectorBucketName:a},{headers:b.headers}))}async listBuckets(a={}){var b=this;return b.handleOperation(async()=>await bH.post(b.fetch,`${b.url}/ListVectorBuckets`,a,{headers:b.headers}))}async deleteBucket(a){var b=this;return b.handleOperation(async()=>await bH.post(b.fetch,`${b.url}/DeleteVectorBucket`,{vectorBucketName:a},{headers:b.headers})||{})}},bU=class extends bT{constructor(a,b={}){super(a,b.headers||{},b.fetch)}from(a){return new bV(this.url,this.headers,a,this.fetch)}async createBucket(a){return super.createBucket.call(this,a)}async getBucket(a){return super.getBucket.call(this,a)}async listBuckets(a={}){return super.listBuckets.call(this,a)}async deleteBucket(a){return super.deleteBucket.call(this,a)}},bV=class extends bR{constructor(a,b,c,d){super(a,b,d),this.vectorBucketName=c}async createIndex(a){return super.createIndex.call(this,bx(bx({},a),{},{vectorBucketName:this.vectorBucketName}))}async listIndexes(a={}){return super.listIndexes.call(this,bx(bx({},a),{},{vectorBucketName:this.vectorBucketName}))}async getIndex(a){return super.getIndex.call(this,this.vectorBucketName,a)}async deleteIndex(a){return super.deleteIndex.call(this,this.vectorBucketName,a)}index(a){return new bW(this.url,this.headers,this.vectorBucketName,a,this.fetch)}},bW=class extends bS{constructor(a,b,c,d,e){super(a,b,e),this.vectorBucketName=c,this.indexName=d}async putVectors(a){return super.putVectors.call(this,bx(bx({},a),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async getVectors(a){return super.getVectors.call(this,bx(bx({},a),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async listVectors(a={}){return super.listVectors.call(this,bx(bx({},a),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async queryVectors(a){return super.queryVectors.call(this,bx(bx({},a),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async deleteVectors(a){return super.deleteVectors.call(this,bx(bx({},a),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}},bX=class extends bP{constructor(a,b={},c,d){super(a,b,c,d)}from(a){return new bN(this.url,this.headers,a,this.fetch)}get vectors(){return new bU(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new bQ(this.url+"/iceberg",this.headers,this.fetch)}};let bY="2.97.0",bZ={"X-Client-Info":`gotrue-js/${bY}`},b$="X-Supabase-Api-Version",b_={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},b0=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class b1 extends Error{constructor(a,b,c){super(a),this.__isAuthError=!0,this.name="AuthError",this.status=b,this.code=c}}function b2(a){return"object"==typeof a&&null!==a&&"__isAuthError"in a}class b3 extends b1{constructor(a,b,c){super(a,b,c),this.name="AuthApiError",this.status=b,this.code=c}}class b4 extends b1{constructor(a,b){super(a),this.name="AuthUnknownError",this.originalError=b}}class b5 extends b1{constructor(a,b,c,d){super(a,c,d),this.name=b,this.status=c}}class b6 extends b5{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function b7(a){return b2(a)&&"AuthSessionMissingError"===a.name}class b8 extends b5{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class b9 extends b5{constructor(a){super(a,"AuthInvalidCredentialsError",400,void 0)}}class ca extends b5{constructor(a,b=null){super(a,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=b}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class cb extends b5{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class cc extends b5{constructor(a,b){super(a,"AuthRetryableFetchError",b,void 0)}}function cd(a){return b2(a)&&"AuthRetryableFetchError"===a.name}class ce extends b5{constructor(a,b,c){super(a,"AuthWeakPasswordError",b,"weak_password"),this.reasons=c}}class cf extends b5{constructor(a){super(a,"AuthInvalidJwtError",400,"invalid_jwt")}}let cg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ch=" 	\n\r=".split(""),ci=(()=>{let a=Array(128);for(let b=0;b<a.length;b+=1)a[b]=-1;for(let b=0;b<ch.length;b+=1)a[ch[b].charCodeAt(0)]=-2;for(let b=0;b<cg.length;b+=1)a[cg[b].charCodeAt(0)]=b;return a})();function cj(a,b,c){if(null!==a)for(b.queue=b.queue<<8|a,b.queuedBits+=8;b.queuedBits>=6;)c(cg[b.queue>>b.queuedBits-6&63]),b.queuedBits-=6;else if(b.queuedBits>0)for(b.queue=b.queue<<6-b.queuedBits,b.queuedBits=6;b.queuedBits>=6;)c(cg[b.queue>>b.queuedBits-6&63]),b.queuedBits-=6}function ck(a,b,c){let d=ci[a];if(d>-1)for(b.queue=b.queue<<6|d,b.queuedBits+=6;b.queuedBits>=8;)c(b.queue>>b.queuedBits-8&255),b.queuedBits-=8;else if(-2===d)return;else throw Error(`Invalid Base64-URL character "${String.fromCharCode(a)}"`)}function cl(a){let b=[],c=a=>{b.push(String.fromCodePoint(a))},d={utf8seq:0,codepoint:0},e={queue:0,queuedBits:0},f=a=>{!function(a,b,c){if(0===b.utf8seq){if(a<=127)return c(a);for(let c=1;c<6;c+=1)if((a>>7-c&1)==0){b.utf8seq=c;break}if(2===b.utf8seq)b.codepoint=31&a;else if(3===b.utf8seq)b.codepoint=15&a;else if(4===b.utf8seq)b.codepoint=7&a;else throw Error("Invalid UTF-8 sequence");b.utf8seq-=1}else if(b.utf8seq>0){if(a<=127)throw Error("Invalid UTF-8 sequence");b.codepoint=b.codepoint<<6|63&a,b.utf8seq-=1,0===b.utf8seq&&c(b.codepoint)}}(a,d,c)};for(let b=0;b<a.length;b+=1)ck(a.charCodeAt(b),e,f);return b.join("")}function cm(a){let b=[],c={queue:0,queuedBits:0},d=a=>{b.push(a)};for(let b=0;b<a.length;b+=1)ck(a.charCodeAt(b),c,d);return new Uint8Array(b)}function cn(a){let b=[],c={queue:0,queuedBits:0},d=a=>{b.push(a)};return a.forEach(a=>cj(a,c,d)),cj(null,c,d),b.join("")}let co=a=>a?(...b)=>a(...b):(...a)=>fetch(...a),cp=async(a,b,c)=>{await a.setItem(b,JSON.stringify(c))},cq=async(a,b)=>{let c=await a.getItem(b);if(!c)return null;try{return JSON.parse(c)}catch(a){return c}},cr=async(a,b)=>{await a.removeItem(b)};class cs{constructor(){this.promise=new cs.promiseConstructor((a,b)=>{this.resolve=a,this.reject=b})}}function ct(a){let b=a.split(".");if(3!==b.length)throw new cf("Invalid JWT structure");for(let a=0;a<b.length;a++)if(!b0.test(b[a]))throw new cf("JWT not in base64url format");return{header:JSON.parse(cl(b[0])),payload:JSON.parse(cl(b[1])),signature:cm(b[2]),raw:{header:b[0],payload:b[1]}}}async function cu(a){return await new Promise(b=>{setTimeout(()=>b(null),a)})}function cv(a){return("0"+a.toString(16)).substr(-2)}async function cw(a){let b=new TextEncoder().encode(a);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",b))).map(a=>String.fromCharCode(a)).join("")}async function cx(a){return"u">typeof crypto&&void 0!==crypto.subtle&&"u">typeof TextEncoder?btoa(await cw(a)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""):(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),a)}async function cy(a,b,c=!1){let d=function(){let a=new Uint32Array(56);if("u"<typeof crypto){let a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",b=a.length,c="";for(let d=0;d<56;d++)c+=a.charAt(Math.floor(Math.random()*b));return c}return crypto.getRandomValues(a),Array.from(a,cv).join("")}(),e=d;c&&(e+="/PASSWORD_RECOVERY"),await cp(a,`${b}-code-verifier`,e);let f=await cx(d),g=d===f?"plain":"s256";return[f,g]}cs.promiseConstructor=Promise;let cz=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i,cA=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function cB(a){if(!cA.test(a))throw Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function cC(){return new Proxy({},{get:(a,b)=>{if("__isUserNotAvailableProxy"===b)return!0;if("symbol"==typeof b){let a=b.toString();if("Symbol(Symbol.toPrimitive)"===a||"Symbol(Symbol.toStringTag)"===a||"Symbol(util.inspect.custom)"===a)return}throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${b}" property of the session object is not supported. Please use getUser() instead.`)},set:(a,b)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${b}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(a,b)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${b}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function cD(a){return JSON.parse(JSON.stringify(a))}let cE=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),cF=[502,503,504];async function cG(a){var b;let c,d;if(!("object"==typeof a&&null!==a&&"status"in a&&"ok"in a&&"json"in a&&"function"==typeof a.json))throw new cc(cE(a),0);if(cF.includes(a.status))throw new cc(cE(a),a.status);try{c=await a.json()}catch(a){throw new b4(cE(a),a)}let e=function(a){let b=a.headers.get(b$);if(!b||!b.match(cz))return null;try{return new Date(`${b}T00:00:00.0Z`)}catch(a){return null}}(a);if(e&&e.getTime()>=b_["2024-01-01"].timestamp&&"object"==typeof c&&c&&"string"==typeof c.code?d=c.code:"object"==typeof c&&c&&"string"==typeof c.error_code&&(d=c.error_code),d){if("weak_password"===d)throw new ce(cE(c),a.status,(null==(b=c.weak_password)?void 0:b.reasons)||[]);else if("session_not_found"===d)throw new b6}else if("object"==typeof c&&c&&"object"==typeof c.weak_password&&c.weak_password&&Array.isArray(c.weak_password.reasons)&&c.weak_password.reasons.length&&c.weak_password.reasons.reduce((a,b)=>a&&"string"==typeof b,!0))throw new ce(cE(c),a.status,c.weak_password.reasons);throw new b3(cE(c),a.status||500,d)}async function cH(a,b,c,d){var e;let f=Object.assign({},null==d?void 0:d.headers);f[b$]||(f[b$]=b_["2024-01-01"].name),(null==d?void 0:d.jwt)&&(f.Authorization=`Bearer ${d.jwt}`);let g=null!=(e=null==d?void 0:d.query)?e:{};(null==d?void 0:d.redirectTo)&&(g.redirect_to=d.redirectTo);let h=Object.keys(g).length?"?"+new URLSearchParams(g).toString():"",i=await cI(a,b,c+h,{headers:f,noResolveJson:null==d?void 0:d.noResolveJson},{},null==d?void 0:d.body);return(null==d?void 0:d.xform)?null==d?void 0:d.xform(i):{data:Object.assign({},i),error:null}}async function cI(a,b,c,d,e,f){let g,h,i=(h={method:b,headers:(null==d?void 0:d.headers)||{}},"GET"===b?h:(h.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==d?void 0:d.headers),h.body=JSON.stringify(f),Object.assign(Object.assign({},h),e)));try{g=await a(c,Object.assign({},i))}catch(a){throw console.error(a),new cc(cE(a),0)}if(g.ok||await cG(g),null==d?void 0:d.noResolveJson)return g;try{return await g.json()}catch(a){await cG(a)}}function cJ(a){var b,c,d;let e=null;(d=a).access_token&&d.refresh_token&&d.expires_in&&(e=Object.assign({},a),a.expires_at||(e.expires_at=(c=a.expires_in,Math.round(Date.now()/1e3)+c)));return{data:{session:e,user:null!=(b=a.user)?b:a},error:null}}function cK(a){let b=cJ(a);return!b.error&&a.weak_password&&"object"==typeof a.weak_password&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.message&&"string"==typeof a.weak_password.message&&a.weak_password.reasons.reduce((a,b)=>a&&"string"==typeof b,!0)&&(b.data.weak_password=a.weak_password),b}function cL(a){var b;return{data:{user:null!=(b=a.user)?b:a},error:null}}function cM(a){return{data:a,error:null}}function cN(a){let{action_link:b,email_otp:c,hashed_token:d,redirect_to:e,verification_type:f}=a;return{data:{properties:{action_link:b,email_otp:c,hashed_token:d,redirect_to:e,verification_type:f},user:Object.assign({},aO(a,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function cO(a){return a}let cP=["global","local","others"];class cQ{constructor({url:a="",headers:b={},fetch:c}){this.url=a,this.headers=b,this.fetch=co(c),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(a,b=cP[0]){if(0>cP.indexOf(b))throw Error(`@supabase/auth-js: Parameter scope must be one of ${cP.join(", ")}`);try{return await cH(this.fetch,"POST",`${this.url}/logout?scope=${b}`,{headers:this.headers,jwt:a,noResolveJson:!0}),{data:null,error:null}}catch(a){if(b2(a))return{data:null,error:a};throw a}}async inviteUserByEmail(a,b={}){try{return await cH(this.fetch,"POST",`${this.url}/invite`,{body:{email:a,data:b.data},headers:this.headers,redirectTo:b.redirectTo,xform:cL})}catch(a){if(b2(a))return{data:{user:null},error:a};throw a}}async generateLink(a){try{let{options:b}=a,c=aO(a,["options"]),d=Object.assign(Object.assign({},c),b);return"newEmail"in c&&(d.new_email=null==c?void 0:c.newEmail,delete d.newEmail),await cH(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:d,headers:this.headers,xform:cN,redirectTo:null==b?void 0:b.redirectTo})}catch(a){if(b2(a))return{data:{properties:null,user:null},error:a};throw a}}async createUser(a){try{return await cH(this.fetch,"POST",`${this.url}/admin/users`,{body:a,headers:this.headers,xform:cL})}catch(a){if(b2(a))return{data:{user:null},error:a};throw a}}async listUsers(a){var b,c,d,e,f,g,h;try{let i={nextPage:null,lastPage:0,total:0},j=await cH(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!=(c=null==(b=null==a?void 0:a.page)?void 0:b.toString())?c:"",per_page:null!=(e=null==(d=null==a?void 0:a.perPage)?void 0:d.toString())?e:""},xform:cO});if(j.error)throw j.error;let k=await j.json(),l=null!=(f=j.headers.get("x-total-count"))?f:0,m=null!=(h=null==(g=j.headers.get("link"))?void 0:g.split(","))?h:[];return m.length>0&&(m.forEach(a=>{let b=parseInt(a.split(";")[0].split("=")[1].substring(0,1)),c=JSON.parse(a.split(";")[1].split("=")[1]);i[`${c}Page`]=b}),i.total=parseInt(l)),{data:Object.assign(Object.assign({},k),i),error:null}}catch(a){if(b2(a))return{data:{users:[]},error:a};throw a}}async getUserById(a){cB(a);try{return await cH(this.fetch,"GET",`${this.url}/admin/users/${a}`,{headers:this.headers,xform:cL})}catch(a){if(b2(a))return{data:{user:null},error:a};throw a}}async updateUserById(a,b){cB(a);try{return await cH(this.fetch,"PUT",`${this.url}/admin/users/${a}`,{body:b,headers:this.headers,xform:cL})}catch(a){if(b2(a))return{data:{user:null},error:a};throw a}}async deleteUser(a,b=!1){cB(a);try{return await cH(this.fetch,"DELETE",`${this.url}/admin/users/${a}`,{headers:this.headers,body:{should_soft_delete:b},xform:cL})}catch(a){if(b2(a))return{data:{user:null},error:a};throw a}}async _listFactors(a){cB(a.userId);try{let{data:b,error:c}=await cH(this.fetch,"GET",`${this.url}/admin/users/${a.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:b,error:c}}catch(a){if(b2(a))return{data:null,error:a};throw a}}async _deleteFactor(a){cB(a.userId),cB(a.id);try{return{data:await cH(this.fetch,"DELETE",`${this.url}/admin/users/${a.userId}/factors/${a.id}`,{headers:this.headers}),error:null}}catch(a){if(b2(a))return{data:null,error:a};throw a}}async _listOAuthClients(a){var b,c,d,e,f,g,h;try{let i={nextPage:null,lastPage:0,total:0},j=await cH(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:null!=(c=null==(b=null==a?void 0:a.page)?void 0:b.toString())?c:"",per_page:null!=(e=null==(d=null==a?void 0:a.perPage)?void 0:d.toString())?e:""},xform:cO});if(j.error)throw j.error;let k=await j.json(),l=null!=(f=j.headers.get("x-total-count"))?f:0,m=null!=(h=null==(g=j.headers.get("link"))?void 0:g.split(","))?h:[];return m.length>0&&(m.forEach(a=>{let b=parseInt(a.split(";")[0].split("=")[1].substring(0,1)),c=JSON.parse(a.split(";")[1].split("=")[1]);i[`${c}Page`]=b}),i.total=parseInt(l)),{data:Object.assign(Object.assign({},k),i),error:null}}catch(a){if(b2(a))return{data:{clients:[]},error:a};throw a}}async _createOAuthClient(a){try{return await cH(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:a,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(b2(a))return{data:null,error:a};throw a}}async _getOAuthClient(a){try{return await cH(this.fetch,"GET",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(b2(a))return{data:null,error:a};throw a}}async _updateOAuthClient(a,b){try{return await cH(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${a}`,{body:b,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(b2(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(a){try{return await cH(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(a){if(b2(a))return{data:null,error:a};throw a}}async _regenerateOAuthClientSecret(a){try{return await cH(this.fetch,"POST",`${this.url}/admin/oauth/clients/${a}/regenerate_secret`,{headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(b2(a))return{data:null,error:a};throw a}}}function cR(a={}){return{getItem:b=>a[b]||null,setItem:(b,c)=>{a[b]=c},removeItem:b=>{delete a[b]}}}globalThis;class cS extends Error{constructor(a){super(a),this.isAcquireTimeout=!0}}function cT(a){if(!/^0x[a-fA-F0-9]{40}$/.test(a))throw Error(`@supabase/auth-js: Address "${a}" is invalid.`);return a.toLowerCase()}class cU extends Error{constructor({message:a,code:b,cause:c,name:d}){var e;super(a,{cause:c}),this.__isWebAuthnError=!0,this.name=null!=(e=null!=d?d:c instanceof Error?c.name:void 0)?e:"Unknown Error",this.code=b}}class cV extends cU{constructor(a,b){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:b,message:a}),this.name="WebAuthnUnknownError",this.originalError=b}}let cW=new class{createNewAbortSignal(){if(this.controller){let a=Error("Cancelling existing WebAuthn API call for new one");a.name="AbortError",this.controller.abort(a)}let a=new AbortController;return this.controller=a,a.signal}cancelCeremony(){if(this.controller){let a=Error("Manually cancelling existing WebAuthn API call");a.name="AbortError",this.controller.abort(a),this.controller=void 0}}};function cX(a){return"localhost"===a||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(a)}async function cY(a){try{let b=await navigator.credentials.create(a);if(!b)return{data:null,error:new cV("Empty credential response",b)};if(!(b instanceof PublicKeyCredential))return{data:null,error:new cV("Browser returned unexpected credential type",b)};return{data:b,error:null}}catch(b){return{data:null,error:function({error:a,options:b}){var c,d,e;let{publicKey:f}=b;if(!f)throw Error("options was missing required publicKey property");if("AbortError"===a.name){if(b.signal instanceof AbortSignal)return new cU({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else if("ConstraintError"===a.name){if((null==(c=f.authenticatorSelection)?void 0:c.requireResidentKey)===!0)return new cU({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:a});else if("conditional"===b.mediation&&(null==(d=f.authenticatorSelection)?void 0:d.userVerification)==="required")return new cU({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:a});else if((null==(e=f.authenticatorSelection)?void 0:e.userVerification)==="required")return new cU({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:a})}else if("InvalidStateError"===a.name)return new cU({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:a});else if("NotAllowedError"===a.name)return new cU({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});else if("NotSupportedError"===a.name)return new cU(0===f.pubKeyCredParams.filter(a=>"public-key"===a.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:a}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:a});else if("SecurityError"===a.name){let b=window.location.hostname;if(!cX(b))return new cU({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a});if(f.rp.id!==b)return new cU({message:`The RP ID "${f.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else if("TypeError"===a.name){if(f.user.id.byteLength<1||f.user.id.byteLength>64)return new cU({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:a})}else if("UnknownError"===a.name)return new cU({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a});return new cU({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a})}({error:b,options:a})}}}async function cZ(a){try{let b=await navigator.credentials.get(a);if(!b)return{data:null,error:new cV("Empty credential response",b)};if(!(b instanceof PublicKeyCredential))return{data:null,error:new cV("Browser returned unexpected credential type",b)};return{data:b,error:null}}catch(b){return{data:null,error:function({error:a,options:b}){let{publicKey:c}=b;if(!c)throw Error("options was missing required publicKey property");if("AbortError"===a.name){if(b.signal instanceof AbortSignal)return new cU({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else if("NotAllowedError"===a.name)return new cU({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});else if("SecurityError"===a.name){let b=window.location.hostname;if(!cX(b))return new cU({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a});if(c.rpId!==b)return new cU({message:`The RP ID "${c.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else if("UnknownError"===a.name)return new cU({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a});return new cU({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a})}({error:b,options:a})}}}let c$={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},c_={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function c0(...a){let b=a=>null!==a&&"object"==typeof a&&!Array.isArray(a),c=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),d={};for(let e of a)if(e)for(let a in e){let f=e[a];if(void 0!==f)if(Array.isArray(f))d[a]=f;else if(c(f))d[a]=f;else if(b(f)){let c=d[a];b(c)?d[a]=c0(c,f):d[a]=c0(f)}else d[a]=f}return d}class c1{constructor(a){this.client=a,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(a){return this.client.mfa.enroll(Object.assign(Object.assign({},a),{factorType:"webauthn"}))}async _challenge({factorId:a,webauthn:b,friendlyName:c,signal:d},e){var f,g,h,i,j;try{let{data:k,error:l}=await this.client.mfa.challenge({factorId:a,webauthn:b});if(!k)return{data:null,error:l};let m=null!=d?d:cW.createNewAbortSignal();if("create"===k.webauthn.type){let{user:a}=k.webauthn.credential_options.publicKey;if(!a.name)if(c)a.name=`${a.id}:${c}`;else{let b=(await this.client.getUser()).data.user,c=(null==(f=null==b?void 0:b.user_metadata)?void 0:f.name)||(null==b?void 0:b.email)||(null==b?void 0:b.id)||"User";a.name=`${a.id}:${c}`}a.displayName||(a.displayName=a.name)}switch(k.webauthn.type){case"create":{let b=(g=k.webauthn.credential_options.publicKey,h=null==e?void 0:e.create,c0(c$,g,h||{})),{data:c,error:d}=await cY({publicKey:b,signal:m});if(c)return{data:{factorId:a,challengeId:k.id,webauthn:{type:k.webauthn.type,credential_response:c}},error:null};return{data:null,error:d}}case"request":{let b=(i=k.webauthn.credential_options.publicKey,j=null==e?void 0:e.request,c0(c_,i,j||{})),{data:c,error:d}=await cZ(Object.assign(Object.assign({},k.webauthn.credential_options),{publicKey:b,signal:m}));if(c)return{data:{factorId:a,challengeId:k.id,webauthn:{type:k.webauthn.type,credential_response:c}},error:null};return{data:null,error:d}}}}catch(a){if(b2(a))return{data:null,error:a};return{data:null,error:new b4("Unexpected error in challenge",a)}}}async _verify({challengeId:a,factorId:b,webauthn:c}){return this.client.mfa.verify({factorId:b,challengeId:a,webauthn:c})}async _authenticate({factorId:a,webauthn:{rpId:b,rpOrigins:c,signal:d}={}},e){if(!b)return{data:null,error:new b1("rpId is required for WebAuthn authentication")};try{1;return{data:null,error:new b4("Browser does not support WebAuthn",null)}}catch(a){if(b2(a))return{data:null,error:a};return{data:null,error:new b4("Unexpected error in authenticate",a)}}}async _register({friendlyName:a,webauthn:{rpId:b,rpOrigins:c,signal:d}={}},e){if(!b)return{data:null,error:new b1("rpId is required for WebAuthn registration")};try{1;return{data:null,error:new b4("Browser does not support WebAuthn",null)}}catch(a){if(b2(a))return{data:null,error:a};return{data:null,error:new b4("Unexpected error in register",a)}}}}if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(a){"u">typeof self&&(self.globalThis=self)}let c2={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:bZ,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4,skipAutoInitialize:!1};async function c3(a,b,c){return await c()}let c4={};class c5{get jwks(){var a,b;return null!=(b=null==(a=c4[this.storageKey])?void 0:a.jwks)?b:{keys:[]}}set jwks(a){c4[this.storageKey]=Object.assign(Object.assign({},c4[this.storageKey]),{jwks:a})}get jwks_cached_at(){var a,b;return null!=(b=null==(a=c4[this.storageKey])?void 0:a.cachedAt)?b:Number.MIN_SAFE_INTEGER}set jwks_cached_at(a){c4[this.storageKey]=Object.assign(Object.assign({},c4[this.storageKey]),{cachedAt:a})}constructor(a){var b;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const c=Object.assign(Object.assign({},c2),a);this.storageKey=c.storageKey,this.instanceID=null!=(b=c5.nextInstanceID[this.storageKey])?b:0,c5.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!c.debug,"function"==typeof c.debug&&(this.logger=c.debug),this.instanceID,this.persistSession=c.persistSession,this.autoRefreshToken=c.autoRefreshToken,this.admin=new cQ({url:c.url,headers:c.headers,fetch:c.fetch}),this.url=c.url,this.headers=c.headers,this.fetch=co(c.fetch),this.lock=c.lock||c3,this.detectSessionInUrl=c.detectSessionInUrl,this.flowType=c.flowType,this.hasCustomAuthorizationHeader=c.hasCustomAuthorizationHeader,this.throwOnError=c.throwOnError,this.lockAcquireTimeout=c.lockAcquireTimeout,c.lock?this.lock=c.lock:(this.persistSession,this.lock=c3),this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new c1(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(c.storage?this.storage=c.storage:(this.memoryStorage={},this.storage=cR(this.memoryStorage)),c.userStorage&&(this.userStorage=c.userStorage)):(this.memoryStorage={},this.storage=cR(this.memoryStorage)),c.skipAutoInitialize||this.initialize().catch(a=>{this._debug("#initialize()","error",a)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(a){if(this.throwOnError&&a&&a.error)throw a.error;return a}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${bY}) ${new Date().toISOString()}`}_debug(...a){return this.logDebugMessages&&this.logger(this._logPrefix(),...a),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){try{return await this._recoverAndRefresh(),{error:null}}catch(a){if(b2(a))return this._returnResult({error:a});return this._returnResult({error:new b4("Unexpected error during initialization",a)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(a){var b,c,d;try{let{data:e,error:f}=await cH(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!=(c=null==(b=null==a?void 0:a.options)?void 0:b.data)?c:{},gotrue_meta_security:{captcha_token:null==(d=null==a?void 0:a.options)?void 0:d.captchaToken}},xform:cJ});if(f||!e)return this._returnResult({data:{user:null,session:null},error:f});let g=e.session,h=e.user;return e.session&&(await this._saveSession(e.session),await this._notifyAllSubscribers("SIGNED_IN",g)),this._returnResult({data:{user:h,session:g},error:null})}catch(a){if(b2(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(a){var b,c,d;try{let e;if("email"in a){let{email:c,password:d,options:f}=a,g=null,h=null;"pkce"===this.flowType&&([g,h]=await cy(this.storage,this.storageKey)),e=await cH(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==f?void 0:f.emailRedirectTo,body:{email:c,password:d,data:null!=(b=null==f?void 0:f.data)?b:{},gotrue_meta_security:{captcha_token:null==f?void 0:f.captchaToken},code_challenge:g,code_challenge_method:h},xform:cJ})}else if("phone"in a){let{phone:b,password:f,options:g}=a;e=await cH(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:b,password:f,data:null!=(c=null==g?void 0:g.data)?c:{},channel:null!=(d=null==g?void 0:g.channel)?d:"sms",gotrue_meta_security:{captcha_token:null==g?void 0:g.captchaToken}},xform:cJ})}else throw new b9("You must provide either an email or phone number and a password");let{data:f,error:g}=e;if(g||!f)return await cr(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:g});let h=f.session,i=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:i,session:h},error:null})}catch(a){if(await cr(this.storage,`${this.storageKey}-code-verifier`),b2(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(a){try{let b;if("email"in a){let{email:c,password:d,options:e}=a;b=await cH(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:c,password:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}},xform:cK})}else if("phone"in a){let{phone:c,password:d,options:e}=a;b=await cH(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:c,password:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}},xform:cK})}else throw new b9("You must provide either an email or phone number and a password");let{data:c,error:d}=b;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){let a=new b8;return this._returnResult({data:{user:null,session:null},error:a})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:Object.assign({user:c.user,session:c.session},c.weak_password?{weakPassword:c.weak_password}:null),error:d})}catch(a){if(b2(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithOAuth(a){var b,c,d,e;return await this._handleProviderSignIn(a.provider,{redirectTo:null==(b=a.options)?void 0:b.redirectTo,scopes:null==(c=a.options)?void 0:c.scopes,queryParams:null==(d=a.options)?void 0:d.queryParams,skipBrowserRedirect:null==(e=a.options)?void 0:e.skipBrowserRedirect})}async exchangeCodeForSession(a){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(a))}async signInWithWeb3(a){let{chain:b}=a;switch(b){case"ethereum":return await this.signInWithEthereum(a);case"solana":return await this.signInWithSolana(a);default:throw Error(`@supabase/auth-js: Unsupported chain "${b}"`)}}async signInWithEthereum(a){var b,c,d,e,f,g,h,i,j,k,l,m;let n,o;if("message"in a)n=a.message,o=a.signature;else{let{chain:k,wallet:l,statement:p,options:q}=a;if("object"!=typeof l||!(null==q?void 0:q.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");let r=new URL(null!=(b=null==q?void 0:q.url)?b:window.location.href),s=await l.request({method:"eth_requestAccounts"}).then(a=>a).catch(()=>{throw Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!s||0===s.length)throw Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");let t=cT(s[0]),u=null==(c=null==q?void 0:q.signInWithEthereum)?void 0:c.chainId;u||(u=parseInt(await l.request({method:"eth_chainId"}),16)),n=function(a){var b;let{chainId:c,domain:d,expirationTime:e,issuedAt:f=new Date,nonce:g,notBefore:h,requestId:i,resources:j,scheme:k,uri:l,version:m}=a;if(!Number.isInteger(c))throw Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${c}`);if(!d)throw Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(g&&g.length<8)throw Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${g}`);if(!l)throw Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==m)throw Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${m}`);if(null==(b=a.statement)?void 0:b.includes("\n"))throw Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${a.statement}`);let n=cT(a.address),o=k?`${k}://${d}`:d,p=a.statement?`${a.statement}
`:"",q=`${o} wants you to sign in with your Ethereum account:
${n}

${p}`,r=`URI: ${l}
Version: ${m}
Chain ID: ${c}${g?`
Nonce: ${g}`:""}
Issued At: ${f.toISOString()}`;if(e&&(r+=`
Expiration Time: ${e.toISOString()}`),h&&(r+=`
Not Before: ${h.toISOString()}`),i&&(r+=`
Request ID: ${i}`),j){let a="\nResources:";for(let b of j){if(!b||"string"!=typeof b)throw Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${b}`);a+=`
- ${b}`}r+=a}return`${q}
${r}`}({domain:r.host,address:t,statement:p,uri:r.href,version:"1",chainId:u,nonce:null==(d=null==q?void 0:q.signInWithEthereum)?void 0:d.nonce,issuedAt:null!=(f=null==(e=null==q?void 0:q.signInWithEthereum)?void 0:e.issuedAt)?f:new Date,expirationTime:null==(g=null==q?void 0:q.signInWithEthereum)?void 0:g.expirationTime,notBefore:null==(h=null==q?void 0:q.signInWithEthereum)?void 0:h.notBefore,requestId:null==(i=null==q?void 0:q.signInWithEthereum)?void 0:i.requestId,resources:null==(j=null==q?void 0:q.signInWithEthereum)?void 0:j.resources}),o=await l.request({method:"personal_sign",params:[(m=n,"0x"+Array.from(new TextEncoder().encode(m),a=>a.toString(16).padStart(2,"0")).join("")),t]})}try{let{data:b,error:c}=await cH(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:n,signature:o},(null==(k=a.options)?void 0:k.captchaToken)?{gotrue_meta_security:{captcha_token:null==(l=a.options)?void 0:l.captchaToken}}:null),xform:cJ});if(c)throw c;if(!b||!b.session||!b.user){let a=new b8;return this._returnResult({data:{user:null,session:null},error:a})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:c})}catch(a){if(b2(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSolana(a){var b,c,d,e,f,g,h,i,j,k,l,m;let n,o;if("message"in a)n=a.message,o=a.signature;else{let{chain:l,wallet:m,statement:p,options:q}=a;if("object"!=typeof m||!(null==q?void 0:q.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");let r=new URL(null!=(b=null==q?void 0:q.url)?b:window.location.href);if("signIn"in m&&m.signIn){let a,b=await m.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},null==q?void 0:q.signInWithSolana),{version:"1",domain:r.host,uri:r.href}),p?{statement:p}:null));if(Array.isArray(b)&&b[0]&&"object"==typeof b[0])a=b[0];else if(b&&"object"==typeof b&&"signedMessage"in b&&"signature"in b)a=b;else throw Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in a&&"signature"in a&&("string"==typeof a.signedMessage||a.signedMessage instanceof Uint8Array)&&a.signature instanceof Uint8Array)n="string"==typeof a.signedMessage?a.signedMessage:new TextDecoder().decode(a.signedMessage),o=a.signature;else throw Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in m)||"function"!=typeof m.signMessage||!("publicKey"in m)||"object"!=typeof m||!m.publicKey||!("toBase58"in m.publicKey)||"function"!=typeof m.publicKey.toBase58)throw Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");n=[`${r.host} wants you to sign in with your Solana account:`,m.publicKey.toBase58(),...p?["",p,""]:[""],"Version: 1",`URI: ${r.href}`,`Issued At: ${null!=(d=null==(c=null==q?void 0:q.signInWithSolana)?void 0:c.issuedAt)?d:new Date().toISOString()}`,...(null==(e=null==q?void 0:q.signInWithSolana)?void 0:e.notBefore)?[`Not Before: ${q.signInWithSolana.notBefore}`]:[],...(null==(f=null==q?void 0:q.signInWithSolana)?void 0:f.expirationTime)?[`Expiration Time: ${q.signInWithSolana.expirationTime}`]:[],...(null==(g=null==q?void 0:q.signInWithSolana)?void 0:g.chainId)?[`Chain ID: ${q.signInWithSolana.chainId}`]:[],...(null==(h=null==q?void 0:q.signInWithSolana)?void 0:h.nonce)?[`Nonce: ${q.signInWithSolana.nonce}`]:[],...(null==(i=null==q?void 0:q.signInWithSolana)?void 0:i.requestId)?[`Request ID: ${q.signInWithSolana.requestId}`]:[],...(null==(k=null==(j=null==q?void 0:q.signInWithSolana)?void 0:j.resources)?void 0:k.length)?["Resources",...q.signInWithSolana.resources.map(a=>`- ${a}`)]:[]].join("\n");let a=await m.signMessage(new TextEncoder().encode(n),"utf8");if(!a||!(a instanceof Uint8Array))throw Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");o=a}}try{let{data:b,error:c}=await cH(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:n,signature:cn(o)},(null==(l=a.options)?void 0:l.captchaToken)?{gotrue_meta_security:{captcha_token:null==(m=a.options)?void 0:m.captchaToken}}:null),xform:cJ});if(c)throw c;if(!b||!b.session||!b.user){let a=new b8;return this._returnResult({data:{user:null,session:null},error:a})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:c})}catch(a){if(b2(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async _exchangeCodeForSession(a){let b=await cq(this.storage,`${this.storageKey}-code-verifier`),[c,d]=(null!=b?b:"").split("/");try{if(!c&&"pkce"===this.flowType)throw new cb;let{data:b,error:e}=await cH(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:a,code_verifier:c},xform:cJ});if(await cr(this.storage,`${this.storageKey}-code-verifier`),e)throw e;if(!b||!b.session||!b.user){let a=new b8;return this._returnResult({data:{user:null,session:null,redirectType:null},error:a})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign(Object.assign({},b),{redirectType:null!=d?d:null}),error:e})}catch(a){if(await cr(this.storage,`${this.storageKey}-code-verifier`),b2(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(a){try{let{options:b,provider:c,token:d,access_token:e,nonce:f}=a,{data:g,error:h}=await cH(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:c,id_token:d,access_token:e,nonce:f,gotrue_meta_security:{captcha_token:null==b?void 0:b.captchaToken}},xform:cJ});if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!g||!g.session||!g.user){let a=new b8;return this._returnResult({data:{user:null,session:null},error:a})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:g,error:h})}catch(a){if(b2(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithOtp(a){var b,c,d,e,f;try{if("email"in a){let{email:d,options:e}=a,f=null,g=null;"pkce"===this.flowType&&([f,g]=await cy(this.storage,this.storageKey));let{error:h}=await cH(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:null!=(b=null==e?void 0:e.data)?b:{},create_user:null==(c=null==e?void 0:e.shouldCreateUser)||c,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken},code_challenge:f,code_challenge_method:g},redirectTo:null==e?void 0:e.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in a){let{phone:b,options:c}=a,{data:g,error:h}=await cH(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:b,data:null!=(d=null==c?void 0:c.data)?d:{},create_user:null==(e=null==c?void 0:c.shouldCreateUser)||e,gotrue_meta_security:{captcha_token:null==c?void 0:c.captchaToken},channel:null!=(f=null==c?void 0:c.channel)?f:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:null==g?void 0:g.message_id},error:h})}throw new b9("You must provide either an email or phone number.")}catch(a){if(await cr(this.storage,`${this.storageKey}-code-verifier`),b2(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async verifyOtp(a){var b,c;try{let d,e;"options"in a&&(d=null==(b=a.options)?void 0:b.redirectTo,e=null==(c=a.options)?void 0:c.captchaToken);let{data:f,error:g}=await cH(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},a),{gotrue_meta_security:{captcha_token:e}}),redirectTo:d,xform:cJ});if(g)throw g;if(!f)throw Error("An error occurred on token verification.");let h=f.session,i=f.user;return(null==h?void 0:h.access_token)&&(await this._saveSession(h),await this._notifyAllSubscribers("recovery"==a.type?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:i,session:h},error:null})}catch(a){if(b2(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(a){var b,c,d,e;try{let f=null,g=null;"pkce"===this.flowType&&([f,g]=await cy(this.storage,this.storageKey));let h=await cH(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in a?{provider_id:a.providerId}:null),"domain"in a?{domain:a.domain}:null),{redirect_to:null!=(c=null==(b=a.options)?void 0:b.redirectTo)?c:void 0}),(null==(d=null==a?void 0:a.options)?void 0:d.captchaToken)?{gotrue_meta_security:{captcha_token:a.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:f,code_challenge_method:g}),headers:this.headers,xform:cM});return null==(e=h.data)||e.url,this._returnResult(h)}catch(a){if(await cr(this.storage,`${this.storageKey}-code-verifier`),b2(a))return this._returnResult({data:null,error:a});throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async a=>{let{data:{session:b},error:c}=a;if(c)throw c;if(!b)throw new b6;let{error:d}=await cH(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:b.access_token});return this._returnResult({data:{user:null,session:null},error:d})})}catch(a){if(b2(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async resend(a){try{let b=`${this.url}/resend`;if("email"in a){let{email:c,type:d,options:e}=a,{error:f}=await cH(this.fetch,"POST",b,{headers:this.headers,body:{email:c,type:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}},redirectTo:null==e?void 0:e.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in a){let{phone:c,type:d,options:e}=a,{data:f,error:g}=await cH(this.fetch,"POST",b,{headers:this.headers,body:{phone:c,type:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:null==f?void 0:f.message_id},error:g})}throw new b9("You must provide either an email or phone number and a type")}catch(a){if(b2(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async a=>a))}async _acquireLock(a,b){this._debug("#_acquireLock","begin",a);try{if(this.lockAcquired){let a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),c=(async()=>(await a,await b()))();return this.pendingInLock.push((async()=>{try{await c}catch(a){}})()),c}return await this.lock(`lock:${this.storageKey}`,a,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let a=b();for(this.pendingInLock.push((async()=>{try{await a}catch(a){}})()),await a;this.pendingInLock.length;){let a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(a){this._debug("#_useSession","begin");try{let b=await this.__loadSession();return await a(b)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let b=null,c=await cq(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",c),null!==c&&(this._isValidSession(c)?b=c:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!b)return{data:{session:null},error:null};let d=!!b.expires_at&&1e3*b.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()",`session has${d?"":" not"} expired`,"expires_at",b.expires_at),!d){if(this.userStorage){let a=await cq(this.userStorage,this.storageKey+"-user");(null==a?void 0:a.user)?b.user=a.user:b.user=cC()}if(this.storage.isServer&&b.user&&!b.user.__isUserNotAvailableProxy){var a;let c={value:this.suppressGetSessionWarning};b.user=(a=b.user,new Proxy(a,{get:(a,b,d)=>{if("__isInsecureUserWarningProxy"===b)return!0;if("symbol"==typeof b){let c=b.toString();if("Symbol(Symbol.toPrimitive)"===c||"Symbol(Symbol.toStringTag)"===c||"Symbol(util.inspect.custom)"===c||"Symbol(nodejs.util.inspect.custom)"===c)return Reflect.get(a,b,d)}return c.value||"string"!=typeof b||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c.value=!0),Reflect.get(a,b,d)}})),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:b},error:null}}let{data:e,error:f}=await this._callRefreshToken(b.refresh_token);if(f)return this._returnResult({data:{session:null},error:f});return this._returnResult({data:{session:e},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(a){if(a)return await this._getUser(a);await this.initializePromise;let b=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return b.data.user&&(this.suppressGetSessionWarning=!0),b}async _getUser(a){try{if(a)return await cH(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:a,xform:cL});return await this._useSession(async a=>{var b,c,d;let{data:e,error:f}=a;if(f)throw f;return(null==(b=e.session)?void 0:b.access_token)||this.hasCustomAuthorizationHeader?await cH(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!=(d=null==(c=e.session)?void 0:c.access_token)?d:void 0,xform:cL}):{data:{user:null},error:new b6}})}catch(a){if(b2(a))return b7(a)&&(await this._removeSession(),await cr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:a});throw a}}async updateUser(a,b={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(a,b))}async _updateUser(a,b={}){try{return await this._useSession(async c=>{let{data:d,error:e}=c;if(e)throw e;if(!d.session)throw new b6;let f=d.session,g=null,h=null;"pkce"===this.flowType&&null!=a.email&&([g,h]=await cy(this.storage,this.storageKey));let{data:i,error:j}=await cH(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==b?void 0:b.emailRedirectTo,body:Object.assign(Object.assign({},a),{code_challenge:g,code_challenge_method:h}),jwt:f.access_token,xform:cL});if(j)throw j;return f.user=i.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),this._returnResult({data:{user:f.user},error:null})})}catch(a){if(await cr(this.storage,`${this.storageKey}-code-verifier`),b2(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(a){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(a))}async _setSession(a){try{if(!a.access_token||!a.refresh_token)throw new b6;let b=Date.now()/1e3,c=b,d=!0,e=null,{payload:f}=ct(a.access_token);if(f.exp&&(d=(c=f.exp)<=b),d){let{data:b,error:c}=await this._callRefreshToken(a.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!b)return{data:{user:null,session:null},error:null};e=b}else{let{data:d,error:f}=await this._getUser(a.access_token);if(f)return this._returnResult({data:{user:null,session:null},error:f});e={access_token:a.access_token,refresh_token:a.refresh_token,user:d.user,token_type:"bearer",expires_in:c-b,expires_at:c},await this._saveSession(e),await this._notifyAllSubscribers("SIGNED_IN",e)}return this._returnResult({data:{user:e.user,session:e},error:null})}catch(a){if(b2(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}}async refreshSession(a){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(a))}async _refreshSession(a){try{return await this._useSession(async b=>{var c;if(!a){let{data:d,error:e}=b;if(e)throw e;a=null!=(c=d.session)?c:void 0}if(!(null==a?void 0:a.refresh_token))throw new b6;let{data:d,error:e}=await this._callRefreshToken(a.refresh_token);return e?this._returnResult({data:{user:null,session:null},error:e}):d?this._returnResult({data:{user:d.user,session:d},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(a){if(b2(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async _getSessionFromURL(a,b){try{throw new ca("No browser detected.")}catch(a){if(b2(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(a){return"function"==typeof this.detectSessionInUrl?this.detectSessionInUrl(new URL(window.location.href),a):!!(a.access_token||a.error_description)}async _isPKCECallback(a){let b=await cq(this.storage,`${this.storageKey}-code-verifier`);return!!(a.code&&b)}async signOut(a={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(a))}async _signOut({scope:a}={scope:"global"}){return await this._useSession(async b=>{var c;let{data:d,error:e}=b;if(e&&!b7(e))return this._returnResult({error:e});let f=null==(c=d.session)?void 0:c.access_token;if(f){let{error:b}=await this.admin.signOut(f,a);if(b&&!(b2(b)&&"AuthApiError"===b.name&&(404===b.status||401===b.status||403===b.status)||b7(b)))return this._returnResult({error:b})}return"others"!==a&&(await this._removeSession(),await cr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(a){let b=Symbol("auth-callback"),c={id:b,callback:a,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",b),this.stateChangeEmitters.delete(b)}};return this._debug("#onAuthStateChange()","registered callback with id",b),this.stateChangeEmitters.set(b,c),(async()=>{await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(b)})})(),{data:{subscription:c}}}async _emitInitialSession(a){return await this._useSession(async b=>{var c,d;try{let{data:{session:d},error:e}=b;if(e)throw e;await (null==(c=this.stateChangeEmitters.get(a))?void 0:c.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",a,"session",d)}catch(b){await (null==(d=this.stateChangeEmitters.get(a))?void 0:d.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",a,"error",b),console.error(b)}})}async resetPasswordForEmail(a,b={}){let c=null,d=null;"pkce"===this.flowType&&([c,d]=await cy(this.storage,this.storageKey,!0));try{return await cH(this.fetch,"POST",`${this.url}/recover`,{body:{email:a,code_challenge:c,code_challenge_method:d,gotrue_meta_security:{captcha_token:b.captchaToken}},headers:this.headers,redirectTo:b.redirectTo})}catch(a){if(await cr(this.storage,`${this.storageKey}-code-verifier`),b2(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var a;try{let{data:b,error:c}=await this.getUser();if(c)throw c;return this._returnResult({data:{identities:null!=(a=b.user.identities)?a:[]},error:null})}catch(a){if(b2(a))return this._returnResult({data:null,error:a});throw a}}async linkIdentity(a){return"token"in a?this.linkIdentityIdToken(a):this.linkIdentityOAuth(a)}async linkIdentityOAuth(a){try{let{data:b,error:c}=await this._useSession(async b=>{var c,d,e,f,g;let{data:h,error:i}=b;if(i)throw i;let j=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,a.provider,{redirectTo:null==(c=a.options)?void 0:c.redirectTo,scopes:null==(d=a.options)?void 0:d.scopes,queryParams:null==(e=a.options)?void 0:e.queryParams,skipBrowserRedirect:!0});return await cH(this.fetch,"GET",j,{headers:this.headers,jwt:null!=(g=null==(f=h.session)?void 0:f.access_token)?g:void 0})});if(c)throw c;return this._returnResult({data:{provider:a.provider,url:null==b?void 0:b.url},error:null})}catch(b){if(b2(b))return this._returnResult({data:{provider:a.provider,url:null},error:b});throw b}}async linkIdentityIdToken(a){return await this._useSession(async b=>{var c;try{let{error:d,data:{session:e}}=b;if(d)throw d;let{options:f,provider:g,token:h,access_token:i,nonce:j}=a,{data:k,error:l}=await cH(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:null!=(c=null==e?void 0:e.access_token)?c:void 0,body:{provider:g,id_token:h,access_token:i,nonce:j,link_identity:!0,gotrue_meta_security:{captcha_token:null==f?void 0:f.captchaToken}},xform:cJ});if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!k||!k.session||!k.user)return this._returnResult({data:{user:null,session:null},error:new b8});return k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("USER_UPDATED",k.session)),this._returnResult({data:k,error:l})}catch(a){if(await cr(this.storage,`${this.storageKey}-code-verifier`),b2(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(a){try{return await this._useSession(async b=>{var c,d;let{data:e,error:f}=b;if(f)throw f;return await cH(this.fetch,"DELETE",`${this.url}/user/identities/${a.identity_id}`,{headers:this.headers,jwt:null!=(d=null==(c=e.session)?void 0:c.access_token)?d:void 0})})}catch(a){if(b2(a))return this._returnResult({data:null,error:a});throw a}}async _refreshAccessToken(a){let b=`#_refreshAccessToken(${a.substring(0,5)}...)`;this._debug(b,"begin");try{var c,d;let e=Date.now();return await (c=async c=>(c>0&&await cu(200*Math.pow(2,c-1)),this._debug(b,"refreshing attempt",c),await cH(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:a},headers:this.headers,xform:cJ})),d=(a,b)=>{let c=200*Math.pow(2,a);return b&&cd(b)&&Date.now()+c-e<3e4},new Promise((a,b)=>{(async()=>{for(let e=0;e<1/0;e++)try{let b=await c(e);if(!d(e,null,b))return void a(b)}catch(a){if(!d(e,a))return void b(a)}})()}))}catch(a){if(this._debug(b,"error",a),b2(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(b,"end")}}_isValidSession(a){return"object"==typeof a&&null!==a&&"access_token"in a&&"refresh_token"in a&&"expires_at"in a}async _handleProviderSignIn(a,b){let c=await this._getUrlForProvider(`${this.url}/authorize`,a,{redirectTo:b.redirectTo,scopes:b.scopes,queryParams:b.queryParams});return this._debug("#_handleProviderSignIn()","provider",a,"options",b,"url",c),{data:{provider:a,url:c},error:null}}async _recoverAndRefresh(){var a,b;let c="#_recoverAndRefresh()";this._debug(c,"begin");try{let d=await cq(this.storage,this.storageKey);if(d&&this.userStorage){let b=await cq(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!b&&(b={user:d.user},await cp(this.userStorage,this.storageKey+"-user",b)),d.user=null!=(a=null==b?void 0:b.user)?a:cC()}else if(d&&!d.user&&!d.user){let a=await cq(this.storage,this.storageKey+"-user");a&&(null==a?void 0:a.user)?(d.user=a.user,await cr(this.storage,this.storageKey+"-user"),await cp(this.storage,this.storageKey,d)):d.user=cC()}if(this._debug(c,"session from storage",d),!this._isValidSession(d)){this._debug(c,"session is not valid"),null!==d&&await this._removeSession();return}let e=(null!=(b=d.expires_at)?b:1/0)*1e3-Date.now()<9e4;if(this._debug(c,`session has${e?"":" not"} expired with margin of 90000s`),e){if(this.autoRefreshToken&&d.refresh_token){let{error:a}=await this._callRefreshToken(d.refresh_token);a&&(console.error(a),cd(a)||(this._debug(c,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(d.user&&!0===d.user.__isUserNotAvailableProxy)try{let{data:a,error:b}=await this._getUser(d.access_token);!b&&(null==a?void 0:a.user)?(d.user=a.user,await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)):this._debug(c,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(c,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",d)}catch(a){this._debug(c,"error",a),console.error(a);return}finally{this._debug(c,"end")}}async _callRefreshToken(a){var b,c;if(!a)throw new b6;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let d=`#_callRefreshToken(${a.substring(0,5)}...)`;this._debug(d,"begin");try{this.refreshingDeferred=new cs;let{data:b,error:c}=await this._refreshAccessToken(a);if(c)throw c;if(!b.session)throw new b6;await this._saveSession(b.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",b.session);let d={data:b.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(a){if(this._debug(d,"error",a),b2(a)){let c={data:null,error:a};return cd(a)||await this._removeSession(),null==(b=this.refreshingDeferred)||b.resolve(c),c}throw null==(c=this.refreshingDeferred)||c.reject(a),a}finally{this.refreshingDeferred=null,this._debug(d,"end")}}async _notifyAllSubscribers(a,b,c=!0){let d=`#_notifyAllSubscribers(${a})`;this._debug(d,"begin",b,`broadcast = ${c}`);try{this.broadcastChannel&&c&&this.broadcastChannel.postMessage({event:a,session:b});let d=[],e=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(a,b)}catch(a){d.push(a)}});if(await Promise.all(e),d.length>0){for(let a=0;a<d.length;a+=1)console.error(d[a]);throw d[0]}}finally{this._debug(d,"end")}}async _saveSession(a){this._debug("#_saveSession()",a),this.suppressGetSessionWarning=!0,await cr(this.storage,`${this.storageKey}-code-verifier`);let b=Object.assign({},a),c=b.user&&!0===b.user.__isUserNotAvailableProxy;if(this.userStorage){!c&&b.user&&await cp(this.userStorage,this.storageKey+"-user",{user:b.user});let a=Object.assign({},b);delete a.user;let d=cD(a);await cp(this.storage,this.storageKey,d)}else{let a=cD(b);await cp(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await cr(this.storage,this.storageKey),await cr(this.storage,this.storageKey+"-code-verifier"),await cr(this.storage,this.storageKey+"-user"),this.userStorage&&await cr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()"),this.visibilityChangedCallback,this.visibilityChangedCallback=null}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let a=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=a,a&&"object"==typeof a&&"function"==typeof a.unref?a.unref():"u">typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(a);let b=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=b,b&&"object"==typeof b&&"function"==typeof b.unref?b.unref():"u">typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(b)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let a=this.autoRefreshTicker;this.autoRefreshTicker=null,a&&clearInterval(a);let b=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,b&&clearTimeout(b)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let a=Date.now();try{return await this._useSession(async b=>{let{data:{session:c}}=b;if(!c||!c.refresh_token||!c.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");let d=Math.floor((1e3*c.expires_at-a)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${d} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),d<=3&&await this._callRefreshToken(c.refresh_token)})}catch(a){console.error("Auto refresh tick failed with error. This is likely a transient error.",a)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(a){if(a.isAcquireTimeout||a instanceof cS)this._debug("auto refresh token tick lock not available");else throw a}}async _handleVisibilityChange(){return this._debug("#_handleVisibilityChange()"),this.autoRefreshToken&&this.startAutoRefresh(),!1}async _onVisibilityChanged(a){let b=`#_onVisibilityChanged(${a})`;this._debug(b,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),a||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{"visible"!==document.visibilityState?this._debug(b,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting"):await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(a,b,c){let d=[`provider=${encodeURIComponent(b)}`];if((null==c?void 0:c.redirectTo)&&d.push(`redirect_to=${encodeURIComponent(c.redirectTo)}`),(null==c?void 0:c.scopes)&&d.push(`scopes=${encodeURIComponent(c.scopes)}`),"pkce"===this.flowType){let[a,b]=await cy(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(b)}`});d.push(c.toString())}if(null==c?void 0:c.queryParams){let a=new URLSearchParams(c.queryParams);d.push(a.toString())}return(null==c?void 0:c.skipBrowserRedirect)&&d.push(`skip_http_redirect=${c.skipBrowserRedirect}`),`${a}?${d.join("&")}`}async _unenroll(a){try{return await this._useSession(async b=>{var c;let{data:d,error:e}=b;return e?this._returnResult({data:null,error:e}):await cH(this.fetch,"DELETE",`${this.url}/factors/${a.factorId}`,{headers:this.headers,jwt:null==(c=null==d?void 0:d.session)?void 0:c.access_token})})}catch(a){if(b2(a))return this._returnResult({data:null,error:a});throw a}}async _enroll(a){try{return await this._useSession(async b=>{var c,d;let{data:e,error:f}=b;if(f)return this._returnResult({data:null,error:f});let g=Object.assign({friendly_name:a.friendlyName,factor_type:a.factorType},"phone"===a.factorType?{phone:a.phone}:"totp"===a.factorType?{issuer:a.issuer}:{}),{data:h,error:i}=await cH(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:null==(c=null==e?void 0:e.session)?void 0:c.access_token});return i?this._returnResult({data:null,error:i}):("totp"===a.factorType&&"totp"===h.type&&(null==(d=null==h?void 0:h.totp)?void 0:d.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(a){if(b2(a))return this._returnResult({data:null,error:a});throw a}}async _verify(a){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async b=>{var c,d,e;let{data:f,error:g}=b;if(g)return this._returnResult({data:null,error:g});let h=Object.assign({challenge_id:a.challengeId},"webauthn"in a?{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_response:"create"===a.webauthn.type?(d=a.webauthn.credential_response,"toJSON"in d&&"function"==typeof d.toJSON?d.toJSON():{id:d.id,rawId:d.id,response:{attestationObject:cn(new Uint8Array(d.response.attestationObject)),clientDataJSON:cn(new Uint8Array(d.response.clientDataJSON))},type:"public-key",clientExtensionResults:d.getClientExtensionResults(),authenticatorAttachment:null!=(e=d.authenticatorAttachment)?e:void 0}):function(a){var b;if("toJSON"in a&&"function"==typeof a.toJSON)return a.toJSON();let c=a.getClientExtensionResults(),d=a.response;return{id:a.id,rawId:a.id,response:{authenticatorData:cn(new Uint8Array(d.authenticatorData)),clientDataJSON:cn(new Uint8Array(d.clientDataJSON)),signature:cn(new Uint8Array(d.signature)),userHandle:d.userHandle?cn(new Uint8Array(d.userHandle)):void 0},type:"public-key",clientExtensionResults:c,authenticatorAttachment:null!=(b=a.authenticatorAttachment)?b:void 0}}(a.webauthn.credential_response)})}:{code:a.code}),{data:i,error:j}=await cH(this.fetch,"POST",`${this.url}/factors/${a.factorId}/verify`,{body:h,headers:this.headers,jwt:null==(c=null==f?void 0:f.session)?void 0:c.access_token});return j?this._returnResult({data:null,error:j}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),this._returnResult({data:i,error:j}))})}catch(a){if(b2(a))return this._returnResult({data:null,error:a});throw a}})}async _challenge(a){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async b=>{var c;let{data:d,error:e}=b;if(e)return this._returnResult({data:null,error:e});let f=await cH(this.fetch,"POST",`${this.url}/factors/${a.factorId}/challenge`,{body:a,headers:this.headers,jwt:null==(c=null==d?void 0:d.session)?void 0:c.access_token});if(f.error)return f;let{data:g}=f;if("webauthn"!==g.type)return{data:g,error:null};switch(g.webauthn.type){case"create":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:function(a){if(!a)throw Error("Credential creation options are required");if("u">typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(a);let{challenge:b,user:c,excludeCredentials:d}=a,e=aO(a,["challenge","user","excludeCredentials"]),f=cm(b).buffer,g=Object.assign(Object.assign({},c),{id:cm(c.id).buffer}),h=Object.assign(Object.assign({},e),{challenge:f,user:g});if(d&&d.length>0){h.excludeCredentials=Array(d.length);for(let a=0;a<d.length;a++){let b=d[a];h.excludeCredentials[a]=Object.assign(Object.assign({},b),{id:cm(b.id).buffer,type:b.type||"public-key",transports:b.transports})}}return h}(g.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:function(a){if(!a)throw Error("Credential request options are required");if("u">typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(a);let{challenge:b,allowCredentials:c}=a,d=aO(a,["challenge","allowCredentials"]),e=cm(b).buffer,f=Object.assign(Object.assign({},d),{challenge:e});if(c&&c.length>0){f.allowCredentials=Array(c.length);for(let a=0;a<c.length;a++){let b=c[a];f.allowCredentials[a]=Object.assign(Object.assign({},b),{id:cm(b.id).buffer,type:b.type||"public-key",transports:b.transports})}}return f}(g.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(a){if(b2(a))return this._returnResult({data:null,error:a});throw a}})}async _challengeAndVerify(a){let{data:b,error:c}=await this._challenge({factorId:a.factorId});return c?this._returnResult({data:null,error:c}):await this._verify({factorId:a.factorId,challengeId:b.id,code:a.code})}async _listFactors(){var a;let{data:{user:b},error:c}=await this.getUser();if(c)return{data:null,error:c};let d={all:[],phone:[],totp:[],webauthn:[]};for(let c of null!=(a=null==b?void 0:b.factors)?a:[])d.all.push(c),"verified"===c.status&&d[c.factor_type].push(c);return{data:d,error:null}}async _getAuthenticatorAssuranceLevel(a){var b,c,d,e;if(a)try{let{payload:d}=ct(a),e=null;d.aal&&(e=d.aal);let f=e,{data:{user:g},error:h}=await this.getUser(a);if(h)return this._returnResult({data:null,error:h});(null!=(c=null==(b=null==g?void 0:g.factors)?void 0:b.filter(a=>"verified"===a.status))?c:[]).length>0&&(f="aal2");let i=d.amr||[];return{data:{currentLevel:e,nextLevel:f,currentAuthenticationMethods:i},error:null}}catch(a){if(b2(a))return this._returnResult({data:null,error:a});throw a}let{data:{session:f},error:g}=await this.getSession();if(g)return this._returnResult({data:null,error:g});if(!f)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:h}=ct(f.access_token),i=null;h.aal&&(i=h.aal);let j=i;return(null!=(e=null==(d=f.user.factors)?void 0:d.filter(a=>"verified"===a.status))?e:[]).length>0&&(j="aal2"),{data:{currentLevel:i,nextLevel:j,currentAuthenticationMethods:h.amr||[]},error:null}}async _getAuthorizationDetails(a){try{return await this._useSession(async b=>{let{data:{session:c},error:d}=b;return d?this._returnResult({data:null,error:d}):c?await cH(this.fetch,"GET",`${this.url}/oauth/authorizations/${a}`,{headers:this.headers,jwt:c.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new b6})})}catch(a){if(b2(a))return this._returnResult({data:null,error:a});throw a}}async _approveAuthorization(a,b){try{return await this._useSession(async b=>{let{data:{session:c},error:d}=b;if(d)return this._returnResult({data:null,error:d});if(!c)return this._returnResult({data:null,error:new b6});let e=await cH(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:c.access_token,body:{action:"approve"},xform:a=>({data:a,error:null})});return e.data&&e.data.redirect_url,e})}catch(a){if(b2(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(a,b){try{return await this._useSession(async b=>{let{data:{session:c},error:d}=b;if(d)return this._returnResult({data:null,error:d});if(!c)return this._returnResult({data:null,error:new b6});let e=await cH(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:c.access_token,body:{action:"deny"},xform:a=>({data:a,error:null})});return e.data&&e.data.redirect_url,e})}catch(a){if(b2(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async a=>{let{data:{session:b},error:c}=a;return c?this._returnResult({data:null,error:c}):b?await cH(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:b.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new b6})})}catch(a){if(b2(a))return this._returnResult({data:null,error:a});throw a}}async _revokeOAuthGrant(a){try{return await this._useSession(async b=>{let{data:{session:c},error:d}=b;return d?this._returnResult({data:null,error:d}):c?(await cH(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:c.access_token,query:{client_id:a.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new b6})})}catch(a){if(b2(a))return this._returnResult({data:null,error:a});throw a}}async fetchJwk(a,b={keys:[]}){let c=b.keys.find(b=>b.kid===a);if(c)return c;let d=Date.now();if((c=this.jwks.keys.find(b=>b.kid===a))&&this.jwks_cached_at+6e5>d)return c;let{data:e,error:f}=await cH(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return e.keys&&0!==e.keys.length&&(this.jwks=e,this.jwks_cached_at=d,c=e.keys.find(b=>b.kid===a))?c:null}async getClaims(a,b={}){try{var c;let d,e=a;if(!e){let{data:a,error:b}=await this.getSession();if(b||!a.session)return this._returnResult({data:null,error:b});e=a.session.access_token}let{header:f,payload:g,signature:h,raw:{header:i,payload:j}}=ct(e);(null==b?void 0:b.allowExpired)||function(a){if(!a)throw Error("Missing exp claim");if(a<=Math.floor(Date.now()/1e3))throw Error("JWT has expired")}(g.exp);let k=!f.alg||f.alg.startsWith("HS")||!f.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(f.kid,(null==b?void 0:b.keys)?{keys:b.keys}:null==b?void 0:b.jwks);if(!k){let{error:a}=await this.getUser(e);if(a)throw a;return{data:{claims:g,header:f,signature:h},error:null}}let l=function(a){switch(a){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw Error("Invalid alg claim")}}(f.alg),m=await crypto.subtle.importKey("jwk",k,l,!0,["verify"]);if(!await crypto.subtle.verify(l,m,h,(c=`${i}.${j}`,d=[],!function(a,b){for(let c=0;c<a.length;c+=1){let d=a.charCodeAt(c);if(d>55295&&d<=56319){let b=(d-55296)*1024&65535;d=(a.charCodeAt(c+1)-56320&65535|b)+65536,c+=1}!function(a,b){if(a<=127)return b(a);if(a<=2047){b(192|a>>6),b(128|63&a);return}if(a<=65535){b(224|a>>12),b(128|a>>6&63),b(128|63&a);return}if(a<=1114111){b(240|a>>18),b(128|a>>12&63),b(128|a>>6&63),b(128|63&a);return}throw Error(`Unrecognized Unicode codepoint: ${a.toString(16)}`)}(d,b)}}(c,a=>d.push(a)),new Uint8Array(d))))throw new cf("Invalid JWT signature");return{data:{claims:g,header:f,signature:h},error:null}}catch(a){if(b2(a))return this._returnResult({data:null,error:a});throw a}}}c5.nextInstanceID={};let c6=c5,c7="";c7="u">typeof Deno?"deno":"u">typeof document?"web":"u">typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";let c8={headers:{"X-Client-Info":`supabase-js-${c7}/2.97.0`}},c9={schema:"public"},da={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},db={};function dc(a){return(dc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function dd(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function de(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?dd(Object(c),!0).forEach(function(b){!function(a,b,c){var d;(d=function(a,b){if("object"!=dc(a)||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=dc(d))return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(b,"string"),(b="symbol"==dc(d)?d:d+"")in a)?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c}(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):dd(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}var df=class extends c6{constructor(a){super(a)}},dg=class{constructor(a,b,c){var d,e,f;this.supabaseUrl=a,this.supabaseKey=b;const g=function(a){let b=null==a?void 0:a.trim();if(!b)throw Error("supabaseUrl is required.");if(!b.match(/^https?:\/\//i))throw Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(b.endsWith("/")?b:b+"/")}catch(a){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}(a);if(!b)throw Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",g),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",g),this.storageUrl=new URL("storage/v1",g),this.functionsUrl=new URL("functions/v1",g);const h=`sb-${g.hostname.split(".")[0]}-auth-token`,i=function(a,b){var c,d;let{db:e,auth:f,realtime:g,global:h}=a,{db:i,auth:j,realtime:k,global:l}=b,m={db:de(de({},i),e),auth:de(de({},j),f),realtime:de(de({},k),g),storage:{},global:de(de(de({},l),h),{},{headers:de(de({},null!=(c=null==l?void 0:l.headers)?c:{}),null!=(d=null==h?void 0:h.headers)?d:{})}),accessToken:async()=>""};return a.accessToken?m.accessToken=a.accessToken:delete m.accessToken,m}(null!=c?c:{},{db:c9,realtime:db,auth:de(de({},da),{},{storageKey:h}),global:c8});this.storageKey=null!=(d=i.auth.storageKey)?d:"",this.headers=null!=(e=i.global.headers)?e:{},i.accessToken?(this.accessToken=i.accessToken,this.auth=new Proxy({},{get:(a,b)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(b)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!=(f=i.auth)?f:{},this.headers,i.global.fetch),this.fetch=((a,b,c)=>{let d=c?(...a)=>c(...a):(...a)=>fetch(...a),e=Headers;return async(c,f)=>{var g;let h=null!=(g=await b())?g:a,i=new e(null==f?void 0:f.headers);return i.has("apikey")||i.set("apikey",a),i.has("Authorization")||i.set("Authorization",`Bearer ${h}`),d(c,de(de({},f),{},{headers:i}))}})(b,this._getAccessToken.bind(this),i.global.fetch),this.realtime=this._initRealtimeClient(de({headers:this.headers,accessToken:this._getAccessToken.bind(this)},i.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(a=>this.realtime.setAuth(a)).catch(a=>console.warn("Failed to set initial Realtime auth token:",a)),this.rest=new aZ(new URL("rest/v1",g).href,{headers:this.headers,schema:i.db.schema,fetch:this.fetch,timeout:i.db.timeout,urlLengthLimit:i.db.urlLengthLimit}),this.storage=new bX(this.storageUrl.href,this.headers,this.fetch,null==c?void 0:c.storage),i.accessToken||this._listenForAuthEvents()}get functions(){return new aP(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(a){return this.rest.from(a)}schema(a){return this.rest.schema(a)}rpc(a,b={},c={head:!1,get:!1,count:void 0}){return this.rest.rpc(a,b,c)}channel(a,b={config:{}}){return this.realtime.channel(a,b)}getChannels(){return this.realtime.getChannels()}removeChannel(a){return this.realtime.removeChannel(a)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var a,b;if(this.accessToken)return await this.accessToken();let{data:c}=await this.auth.getSession();return null!=(a=null==(b=c.session)?void 0:b.access_token)?a:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:a,persistSession:b,detectSessionInUrl:c,storage:d,userStorage:e,storageKey:f,flowType:g,lock:h,debug:i,throwOnError:j},k,l){let m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new df({url:this.authUrl.href,headers:de(de({},m),k),storageKey:f,autoRefreshToken:a,persistSession:b,detectSessionInUrl:c,storage:d,userStorage:e,flowType:g,lock:h,debug:i,throwOnError:j,fetch:l,hasCustomAuthorizationHeader:Object.keys(this.headers).some(a=>"authorization"===a.toLowerCase())})}_initRealtimeClient(a){return new bi(this.realtimeUrl.href,de(de({},a),{},{params:de(de({},{apikey:this.supabaseKey}),null==a?void 0:a.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((a,b)=>{this._handleTokenChanged(a,"CLIENT",null==b?void 0:b.access_token)})}_handleTokenChanged(a,b,c){("TOKEN_REFRESHED"===a||"SIGNED_IN"===a)&&this.changedAccessToken!==c?(this.changedAccessToken=c,this.realtime.setAuth(c)):"SIGNED_OUT"===a&&(this.realtime.setAuth(),"STORAGE"==b&&this.auth.signOut(),this.changedAccessToken=void 0)}};(function(){let a=globalThis.process;if(!a)return!1;let b=a.version;if(null==b)return!1;let c=b.match(/^v(\d+)\./);return!!c&&18>=parseInt(c[1],10)})()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");var dh=a.i(19866);dh.parse,dh.serialize;let di={path:"/",sameSite:"lax",httpOnly:!1,maxAge:3456e4},dj=/^(.*)[.](0|[1-9][0-9]*)$/;function dk(a,b){if(a===b)return!0;let c=a.match(dj);return!!c&&c[1]===b}function dl(a,b,c){let d=c??3180,e=encodeURIComponent(b);if(e.length<=d)return[{name:a,value:b}];let f=[];for(;e.length>0;){let a=e.slice(0,d),b=a.lastIndexOf("%");b>d-3&&(a=a.slice(0,b));let c="";for(;a.length>0;)try{c=decodeURIComponent(a);break}catch(b){if(b instanceof URIError&&"%"===a.at(-3)&&a.length>3)a=a.slice(0,a.length-3);else throw b}f.push(c),e=e.slice(a.length)}return f.map((b,c)=>({name:`${a}.${c}`,value:b}))}async function dm(a,b){let c=await b(a);if(c)return c;let d=[];for(let c=0;;c++){let e=`${a}.${c}`,f=await b(e);if(!f)break;d.push(f)}return d.length>0?d.join(""):null}let dn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),dp=" 	\n\r=".split(""),dq=(()=>{let a=Array(128);for(let b=0;b<a.length;b+=1)a[b]=-1;for(let b=0;b<dp.length;b+=1)a[dp[b].charCodeAt(0)]=-2;for(let b=0;b<dn.length;b+=1)a[dn[b].charCodeAt(0)]=b;return a})();function dr(a){let b=[],c=0,d=0;if(function(a,b){for(let c=0;c<a.length;c+=1){let d=a.charCodeAt(c);if(d>55295&&d<=56319){let b=(d-55296)*1024&65535;d=(a.charCodeAt(c+1)-56320&65535|b)+65536,c+=1}!function(a,b){if(a<=127)return b(a);if(a<=2047){b(192|a>>6),b(128|63&a);return}if(a<=65535){b(224|a>>12),b(128|a>>6&63),b(128|63&a);return}if(a<=1114111){b(240|a>>18),b(128|a>>12&63),b(128|a>>6&63),b(128|63&a);return}throw Error(`Unrecognized Unicode codepoint: ${a.toString(16)}`)}(d,b)}}(a,a=>{for(c=c<<8|a,d+=8;d>=6;){let a=c>>d-6&63;b.push(dn[a]),d-=6}}),d>0)for(c<<=6-d,d=6;d>=6;){let a=c>>d-6&63;b.push(dn[a]),d-=6}return b.join("")}function ds(a){let b=[],c=a=>{b.push(String.fromCodePoint(a))},d={utf8seq:0,codepoint:0},e=0,f=0;for(let b=0;b<a.length;b+=1){let g=dq[a.charCodeAt(b)];if(g>-1)for(e=e<<6|g,f+=6;f>=8;)(function(a,b,c){if(0===b.utf8seq){if(a<=127)return c(a);for(let c=1;c<6;c+=1)if((a>>7-c&1)==0){b.utf8seq=c;break}if(2===b.utf8seq)b.codepoint=31&a;else if(3===b.utf8seq)b.codepoint=15&a;else if(4===b.utf8seq)b.codepoint=7&a;else throw Error("Invalid UTF-8 sequence");b.utf8seq-=1}else if(b.utf8seq>0){if(a<=127)throw Error("Invalid UTF-8 sequence");b.codepoint=b.codepoint<<6|63&a,b.utf8seq-=1,0===b.utf8seq&&c(b.codepoint)}})(e>>f-8&255,d,c),f-=8;else if(-2===g)continue;else throw Error(`Invalid Base64-URL character "${a.at(b)}" at position ${b}`)}return b.join("")}let dt="base64-";async function du({getAll:a,setAll:b,setItems:c,removedItems:d},e){let f=e.cookieEncoding,g=e.cookieOptions??null,h=await a([...c?Object.keys(c):[],...d?Object.keys(d):[]]),i=h?.map(({name:a})=>a)||[],j=Object.keys(d).flatMap(a=>i.filter(b=>dk(b,a))),k=Object.keys(c).flatMap(a=>{let b=new Set(i.filter(b=>dk(b,a))),d=c[a];"base64url"===f&&(d=dt+dr(d));let e=dl(a,d);return e.forEach(a=>{b.delete(a.name)}),j.push(...b),e}),l={...di,...g,maxAge:0},m={...di,...g,maxAge:di.maxAge};delete l.name,delete m.name,await b([...j.map(a=>({name:a,value:"",options:l})),...k.map(({name:a,value:b})=>({name:a,value:b,options:m}))])}if(a.i(27922),"u">typeof process&&process.env?.npm_package_name){let a=process.env.npm_package_name;["@supabase/auth-helpers-nextjs","@supabase/auth-helpers-react","@supabase/auth-helpers-remix","@supabase/auth-helpers-sveltekit"].includes(a)&&console.warn(`

   IMPORTANT: Package Consolidation Notice                                
                                                                            
 The ${a.padEnd(35)} package name is deprecated.  
                                                                            
 You are now using @supabase/ssr - a unified solution for all frameworks.  
                                                                            
 The auth-helpers packages have been consolidated into @supabase/ssr       
 to provide better maintenance and consistent APIs across frameworks.      
                                                                            
 Please update your package.json to use @supabase/ssr directly:            
   npm uninstall ${a.padEnd(42)} 
   npm install @supabase/ssr                                               
                                                                            
 For more information, visit:                                              
 https://supabase.com/docs/guides/auth/server-side                         

    `)}var dv=a.i(77241);function dw(){return(0,G.useMemo)(()=>(function(a,b,c){0;if(!a||!b)throw Error(`@supabase/ssr: Your project's URL and API key are required to create a Supabase client!

Check your Supabase project's API settings to find these values

https://supabase.com/dashboard/project/_/settings/api`);let{storage:d}=function(a,b){let c,d,e=a.cookies??null,f=a.cookieEncoding,g={},h={};if(e)if("get"in e){let a=async a=>{let b=a.flatMap(a=>[a,...Array.from({length:5}).map((b,c)=>`${a}.${c}`)]),c=[];for(let a=0;a<b.length;a+=1){let d=await e.get(b[a]);(d||"string"==typeof d)&&c.push({name:b[a],value:d})}return c};if(c=async b=>await a(b),"set"in e&&"remove"in e)d=async a=>{for(let b=0;b<a.length;b+=1){let{name:c,value:d,options:f}=a[b];d?await e.set(c,d,f):await e.remove(c,f)}};else if(b)d=async()=>{console.warn("@supabase/ssr: createServerClient was configured without set and remove cookie methods, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness. Consider switching to the getAll and setAll cookie methods instead of get, set and remove which are deprecated and can be difficult to use correctly.")};else throw Error("@supabase/ssr: createBrowserClient requires configuring a getAll and setAll cookie method (deprecated: alternatively both get, set and remove can be used)")}else if("getAll"in e)if(c=async()=>await e.getAll(),"setAll"in e)d=e.setAll;else if(b)d=async()=>{console.warn("@supabase/ssr: createServerClient was configured without the setAll cookie method, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness.")};else throw Error("@supabase/ssr: createBrowserClient requires configuring both getAll and setAll cookie methods (deprecated: alternatively both get, set and remove can be used)");else throw Error(`@supabase/ssr: ${b?"createServerClient":"createBrowserClient"} requires configuring getAll and setAll cookie methods (deprecated: alternatively use get, set and remove).`);else if(b||1)if(b)throw Error("@supabase/ssr: createServerClient must be initialized with cookie options that specify getAll and setAll functions (deprecated, not recommended: alternatively use get, set and remove)");else c=()=>[],d=()=>{throw Error("@supabase/ssr: createBrowserClient in non-browser runtimes (including Next.js pre-rendering mode) was not initialized cookie options that specify getAll and setAll functions (deprecated: alternatively use get, set and remove), but they were needed")};else c=()=>{let a;return Object.keys(a=(0,dh.parse)(document.cookie)).map(b=>({name:b,value:a[b]??""}))},d=a=>{a.forEach(({name:a,value:b,options:c})=>{document.cookie=(0,dh.serialize)(a,b,c)})};return b?{getAll:c,setAll:d,setItems:g,removedItems:h,storage:{isServer:!0,getItem:async a=>{if("string"==typeof g[a])return g[a];if(h[a])return null;let b=await c([a]),d=await dm(a,async a=>{let c=b?.find(({name:b})=>b===a)||null;return c?c.value:null});if(!d)return null;let e=d;return"string"==typeof d&&d.startsWith(dt)&&(e=ds(d.substring(dt.length))),e},setItem:async(b,e)=>{b.endsWith("-code-verifier")&&await du({getAll:c,setAll:d,setItems:{[b]:e},removedItems:{}},{cookieOptions:a?.cookieOptions??null,cookieEncoding:f}),g[b]=e,delete h[b]},removeItem:async a=>{delete g[a],h[a]=!0}}}:{getAll:c,setAll:d,setItems:g,removedItems:h,storage:{isServer:!1,getItem:async a=>{let b=await c([a]),d=await dm(a,async a=>{let c=b?.find(({name:b})=>b===a)||null;return c?c.value:null});if(!d)return null;let e=d;return d.startsWith(dt)&&(e=ds(d.substring(dt.length))),e},setItem:async(b,e)=>{let g=await c([b]),h=new Set((g?.map(({name:a})=>a)||[]).filter(a=>dk(a,b))),i=e;"base64url"===f&&(i=dt+dr(e));let j=dl(b,i);j.forEach(({name:a})=>{h.delete(a)});let k={...di,...a?.cookieOptions,maxAge:0},l={...di,...a?.cookieOptions,maxAge:di.maxAge};delete k.name,delete l.name;let m=[...[...h].map(a=>({name:a,value:"",options:k})),...j.map(({name:a,value:b})=>({name:a,value:b,options:l}))];m.length>0&&await d(m)},removeItem:async b=>{let e=await c([b]),f=(e?.map(({name:a})=>a)||[]).filter(a=>dk(a,b)),g={...di,...a?.cookieOptions,maxAge:0};delete g.name,f.length>0&&await d(f.map(a=>({name:a,value:"",options:g})))}}}}({...void 0,cookieEncoding:(void 0)??"base64url"},!1),e=new dg(a,b,{...void 0,global:{...void 0,headers:{...void 0,"X-Client-Info":"supabase-ssr/0.8.0 createBrowserClient"}},auth:{...void 0,flowType:"pkce",autoRefreshToken:!1,detectSessionInUrl:!1,persistSession:!0,storage:d}});return e})(dv.config.supabase.url,dv.config.supabase.anonKey),[])}a.s(["useSupabase",()=>dw],42205),a.s([],96705),a.i(96705),(o=C||(C={})).assertEqual=a=>{},o.assertIs=function(a){},o.assertNever=function(a){throw Error()},o.arrayToEnum=a=>{let b={};for(let c of a)b[c]=c;return b},o.getValidEnumValues=a=>{let b=o.objectKeys(a).filter(b=>"number"!=typeof a[a[b]]),c={};for(let d of b)c[d]=a[d];return o.objectValues(c)},o.objectValues=a=>o.objectKeys(a).map(function(b){return a[b]}),o.objectKeys="function"==typeof Object.keys?a=>Object.keys(a):a=>{let b=[];for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b},o.find=(a,b)=>{for(let c of a)if(b(c))return c},o.isInteger="function"==typeof Number.isInteger?a=>Number.isInteger(a):a=>"number"==typeof a&&Number.isFinite(a)&&Math.floor(a)===a,o.joinValues=function(a,b=" | "){return a.map(a=>"string"==typeof a?`'${a}'`:a).join(b)},o.jsonStringifyReplacer=(a,b)=>"bigint"==typeof b?b.toString():b,(D||(D={})).mergeShapes=(a,b)=>({...a,...b});let dx=C.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),dy=a=>{switch(typeof a){case"undefined":return dx.undefined;case"string":return dx.string;case"number":return Number.isNaN(a)?dx.nan:dx.number;case"boolean":return dx.boolean;case"function":return dx.function;case"bigint":return dx.bigint;case"symbol":return dx.symbol;case"object":if(Array.isArray(a))return dx.array;if(null===a)return dx.null;if(a.then&&"function"==typeof a.then&&a.catch&&"function"==typeof a.catch)return dx.promise;if("u">typeof Map&&a instanceof Map)return dx.map;if("u">typeof Set&&a instanceof Set)return dx.set;if("u">typeof Date&&a instanceof Date)return dx.date;return dx.object;default:return dx.unknown}};a.s(["ZodParsedType",0,dx,"getParsedType",0,dy,"objectUtil",()=>D,"util",()=>C],15660);let dz=C.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),dA=a=>JSON.stringify(a,null,2).replace(/"([^"]+)":/g,"$1:");class dB extends Error{get errors(){return this.issues}constructor(a){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};const b=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,b):this.__proto__=b,this.name="ZodError",this.issues=a}format(a){let b=a||function(a){return a.message},c={_errors:[]},d=a=>{for(let e of a.issues)if("invalid_union"===e.code)e.unionErrors.map(d);else if("invalid_return_type"===e.code)d(e.returnTypeError);else if("invalid_arguments"===e.code)d(e.argumentsError);else if(0===e.path.length)c._errors.push(b(e));else{let a=c,d=0;for(;d<e.path.length;){let c=e.path[d];d===e.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(b(e))):a[c]=a[c]||{_errors:[]},a=a[c],d++}}};return d(this),c}static assert(a){if(!(a instanceof dB))throw Error(`Not a ZodError: ${a}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,C.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(a=a=>a.message){let b={},c=[];for(let d of this.issues)if(d.path.length>0){let c=d.path[0];b[c]=b[c]||[],b[c].push(a(d))}else c.push(a(d));return{formErrors:c,fieldErrors:b}}get formErrors(){return this.flatten()}}dB.create=a=>new dB(a),a.s(["ZodError",()=>dB,"ZodIssueCode",0,dz,"quotelessJson",0,dA],2364);let dC=(a,b)=>{let c;switch(a.code){case dz.invalid_type:c=a.received===dx.undefined?"Required":`Expected ${a.expected}, received ${a.received}`;break;case dz.invalid_literal:c=`Invalid literal value, expected ${JSON.stringify(a.expected,C.jsonStringifyReplacer)}`;break;case dz.unrecognized_keys:c=`Unrecognized key(s) in object: ${C.joinValues(a.keys,", ")}`;break;case dz.invalid_union:c="Invalid input";break;case dz.invalid_union_discriminator:c=`Invalid discriminator value. Expected ${C.joinValues(a.options)}`;break;case dz.invalid_enum_value:c=`Invalid enum value. Expected ${C.joinValues(a.options)}, received '${a.received}'`;break;case dz.invalid_arguments:c="Invalid function arguments";break;case dz.invalid_return_type:c="Invalid function return type";break;case dz.invalid_date:c="Invalid date";break;case dz.invalid_string:"object"==typeof a.validation?"includes"in a.validation?(c=`Invalid input: must include "${a.validation.includes}"`,"number"==typeof a.validation.position&&(c=`${c} at one or more positions greater than or equal to ${a.validation.position}`)):"startsWith"in a.validation?c=`Invalid input: must start with "${a.validation.startsWith}"`:"endsWith"in a.validation?c=`Invalid input: must end with "${a.validation.endsWith}"`:C.assertNever(a.validation):c="regex"!==a.validation?`Invalid ${a.validation}`:"Invalid";break;case dz.too_small:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at least":"more than"} ${a.minimum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at least":"over"} ${a.minimum} character(s)`:"number"===a.type||"bigint"===a.type?`Number must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${a.minimum}`:"date"===a.type?`Date must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(a.minimum))}`:"Invalid input";break;case dz.too_big:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at most":"less than"} ${a.maximum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at most":"under"} ${a.maximum} character(s)`:"number"===a.type?`Number must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"bigint"===a.type?`BigInt must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"date"===a.type?`Date must be ${a.exact?"exactly":a.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(a.maximum))}`:"Invalid input";break;case dz.custom:c="Invalid input";break;case dz.invalid_intersection_types:c="Intersection results could not be merged";break;case dz.not_multiple_of:c=`Number must be a multiple of ${a.multipleOf}`;break;case dz.not_finite:c="Number must be finite";break;default:c=b.defaultError,C.assertNever(a)}return{message:c}},dD=dC;function dE(a){dD=a}function dF(){return dD}a.s(["getErrorMap",()=>dF,"setErrorMap",()=>dE],51960),a.i(51960),a.s(["defaultErrorMap",0,dC,"getErrorMap",()=>dF,"setErrorMap",()=>dE],39772),a.i(39772);let dG=a=>{let{data:b,path:c,errorMaps:d,issueData:e}=a,f=[...c,...e.path||[]],g={...e,path:f};if(void 0!==e.message)return{...e,path:f,message:e.message};let h="";for(let a of d.filter(a=>!!a).slice().reverse())h=a(g,{data:b,defaultError:h}).message;return{...e,path:f,message:h}},dH=[];function dI(a,b){let c=dD,d=dG({issueData:b,data:a.data,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,c,c===dC?void 0:dC].filter(a=>!!a)});a.common.issues.push(d)}class dJ{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(a,b){let c=[];for(let d of b){if("aborted"===d.status)return dK;"dirty"===d.status&&a.dirty(),c.push(d.value)}return{status:a.value,value:c}}static async mergeObjectAsync(a,b){let c=[];for(let a of b){let b=await a.key,d=await a.value;c.push({key:b,value:d})}return dJ.mergeObjectSync(a,c)}static mergeObjectSync(a,b){let c={};for(let d of b){let{key:b,value:e}=d;if("aborted"===b.status||"aborted"===e.status)return dK;"dirty"===b.status&&a.dirty(),"dirty"===e.status&&a.dirty(),"__proto__"!==b.value&&(void 0!==e.value||d.alwaysSet)&&(c[b.value]=e.value)}return{status:a.value,value:c}}}let dK=Object.freeze({status:"aborted"}),dL=a=>({status:"dirty",value:a}),dM=a=>({status:"valid",value:a}),dN=a=>"aborted"===a.status,dO=a=>"dirty"===a.status,dP=a=>"valid"===a.status,dQ=a=>"u">typeof Promise&&a instanceof Promise;a.s(["DIRTY",0,dL,"EMPTY_PATH",0,dH,"INVALID",0,dK,"OK",0,dM,"ParseStatus",()=>dJ,"addIssueToContext",()=>dI,"isAborted",0,dN,"isAsync",0,dQ,"isDirty",0,dO,"isValid",0,dP,"makeIssue",0,dG],44),a.i(44),a.s([],17767),a.i(17767),a.i(15660),(p=E||(E={})).errToObj=a=>"string"==typeof a?{message:a}:a||{},p.toString=a=>"string"==typeof a?a:a?.message;class dR{constructor(a,b,c,d){this._cachedPath=[],this.parent=a,this.data=b,this._path=c,this._key=d}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let dS=(a,b)=>{if(dP(b))return{success:!0,data:b.value};if(!a.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let b=new dB(a.common.issues);return this._error=b,this._error}}};function dT(a){if(!a)return{};let{errorMap:b,invalid_type_error:c,required_error:d,description:e}=a;if(b&&(c||d))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return b?{errorMap:b,description:e}:{errorMap:(b,e)=>{let{message:f}=a;return"invalid_enum_value"===b.code?{message:f??e.defaultError}:void 0===e.data?{message:f??d??e.defaultError}:"invalid_type"!==b.code?{message:e.defaultError}:{message:f??c??e.defaultError}},description:e}}class dU{get description(){return this._def.description}_getType(a){return dy(a.data)}_getOrReturnCtx(a,b){return b||{common:a.parent.common,data:a.data,parsedType:dy(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}_processInputParams(a){return{status:new dJ,ctx:{common:a.parent.common,data:a.data,parsedType:dy(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}}_parseSync(a){let b=this._parse(a);if(dQ(b))throw Error("Synchronous parse encountered promise.");return b}_parseAsync(a){return Promise.resolve(this._parse(a))}parse(a,b){let c=this.safeParse(a,b);if(c.success)return c.data;throw c.error}safeParse(a,b){let c={common:{issues:[],async:b?.async??!1,contextualErrorMap:b?.errorMap},path:b?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:dy(a)},d=this._parseSync({data:a,path:c.path,parent:c});return dS(c,d)}"~validate"(a){let b={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:dy(a)};if(!this["~standard"].async)try{let c=this._parseSync({data:a,path:[],parent:b});return dP(c)?{value:c.value}:{issues:b.common.issues}}catch(a){a?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),b.common={issues:[],async:!0}}return this._parseAsync({data:a,path:[],parent:b}).then(a=>dP(a)?{value:a.value}:{issues:b.common.issues})}async parseAsync(a,b){let c=await this.safeParseAsync(a,b);if(c.success)return c.data;throw c.error}async safeParseAsync(a,b){let c={common:{issues:[],contextualErrorMap:b?.errorMap,async:!0},path:b?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:dy(a)},d=this._parse({data:a,path:c.path,parent:c});return dS(c,await (dQ(d)?d:Promise.resolve(d)))}refine(a,b){return this._refinement((c,d)=>{let e=a(c),f=()=>d.addIssue({code:dz.custom,..."string"==typeof b||void 0===b?{message:b}:"function"==typeof b?b(c):b});return"u">typeof Promise&&e instanceof Promise?e.then(a=>!!a||(f(),!1)):!!e||(f(),!1)})}refinement(a,b){return this._refinement((c,d)=>!!a(c)||(d.addIssue("function"==typeof b?b(c,d):b),!1))}_refinement(a){return new eE({schema:this,typeName:F.ZodEffects,effect:{type:"refinement",refinement:a}})}superRefine(a){return this._refinement(a)}constructor(a){this.spa=this.safeParseAsync,this._def=a,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return eF.create(this,this._def)}nullable(){return eG.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return en.create(this)}promise(){return eD.create(this,this._def)}or(a){return ep.create([this,a],this._def)}and(a){return es.create(this,a,this._def)}transform(a){return new eE({...dT(this._def),schema:this,typeName:F.ZodEffects,effect:{type:"transform",transform:a}})}default(a){return new eH({...dT(this._def),innerType:this,defaultValue:"function"==typeof a?a:()=>a,typeName:F.ZodDefault})}brand(){return new eL({typeName:F.ZodBranded,type:this,...dT(this._def)})}catch(a){return new eI({...dT(this._def),innerType:this,catchValue:"function"==typeof a?a:()=>a,typeName:F.ZodCatch})}describe(a){return new this.constructor({...this._def,description:a})}pipe(a){return eM.create(this,a)}readonly(){return eN.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let dV=/^c[^\s-]{8,}$/i,dW=/^[0-9a-z]+$/,dX=/^[0-9A-HJKMNP-TV-Z]{26}$/i,dY=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,dZ=/^[a-z0-9_-]{21}$/i,d$=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,d_=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,d0=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,d1=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,d2=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,d3=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,d4=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,d5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,d6=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,d7="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",d8=RegExp(`^${d7}$`);function d9(a){let b="[0-5]\\d";a.precision?b=`${b}\\.\\d{${a.precision}}`:null==a.precision&&(b=`${b}(\\.\\d+)?`);let c=a.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${b})${c}`}function ea(a){let b=`${d7}T${d9(a)}`,c=[];return c.push(a.local?"Z?":"Z"),a.offset&&c.push("([+-]\\d{2}:?\\d{2})"),b=`${b}(${c.join("|")})`,RegExp(`^${b}$`)}class eb extends dU{_parse(a){var b,c,e,f;let g;if(this._def.coerce&&(a.data=String(a.data)),this._getType(a)!==dx.string){let b=this._getOrReturnCtx(a);return dI(b,{code:dz.invalid_type,expected:dx.string,received:b.parsedType}),dK}let h=new dJ;for(let i of this._def.checks)if("min"===i.kind)a.data.length<i.value&&(dI(g=this._getOrReturnCtx(a,g),{code:dz.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),h.dirty());else if("max"===i.kind)a.data.length>i.value&&(dI(g=this._getOrReturnCtx(a,g),{code:dz.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),h.dirty());else if("length"===i.kind){let b=a.data.length>i.value,c=a.data.length<i.value;(b||c)&&(g=this._getOrReturnCtx(a,g),b?dI(g,{code:dz.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&dI(g,{code:dz.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),h.dirty())}else if("email"===i.kind)d0.test(a.data)||(dI(g=this._getOrReturnCtx(a,g),{validation:"email",code:dz.invalid_string,message:i.message}),h.dirty());else if("emoji"===i.kind)d||(d=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),d.test(a.data)||(dI(g=this._getOrReturnCtx(a,g),{validation:"emoji",code:dz.invalid_string,message:i.message}),h.dirty());else if("uuid"===i.kind)dY.test(a.data)||(dI(g=this._getOrReturnCtx(a,g),{validation:"uuid",code:dz.invalid_string,message:i.message}),h.dirty());else if("nanoid"===i.kind)dZ.test(a.data)||(dI(g=this._getOrReturnCtx(a,g),{validation:"nanoid",code:dz.invalid_string,message:i.message}),h.dirty());else if("cuid"===i.kind)dV.test(a.data)||(dI(g=this._getOrReturnCtx(a,g),{validation:"cuid",code:dz.invalid_string,message:i.message}),h.dirty());else if("cuid2"===i.kind)dW.test(a.data)||(dI(g=this._getOrReturnCtx(a,g),{validation:"cuid2",code:dz.invalid_string,message:i.message}),h.dirty());else if("ulid"===i.kind)dX.test(a.data)||(dI(g=this._getOrReturnCtx(a,g),{validation:"ulid",code:dz.invalid_string,message:i.message}),h.dirty());else if("url"===i.kind)try{new URL(a.data)}catch{dI(g=this._getOrReturnCtx(a,g),{validation:"url",code:dz.invalid_string,message:i.message}),h.dirty()}else"regex"===i.kind?(i.regex.lastIndex=0,i.regex.test(a.data)||(dI(g=this._getOrReturnCtx(a,g),{validation:"regex",code:dz.invalid_string,message:i.message}),h.dirty())):"trim"===i.kind?a.data=a.data.trim():"includes"===i.kind?a.data.includes(i.value,i.position)||(dI(g=this._getOrReturnCtx(a,g),{code:dz.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),h.dirty()):"toLowerCase"===i.kind?a.data=a.data.toLowerCase():"toUpperCase"===i.kind?a.data=a.data.toUpperCase():"startsWith"===i.kind?a.data.startsWith(i.value)||(dI(g=this._getOrReturnCtx(a,g),{code:dz.invalid_string,validation:{startsWith:i.value},message:i.message}),h.dirty()):"endsWith"===i.kind?a.data.endsWith(i.value)||(dI(g=this._getOrReturnCtx(a,g),{code:dz.invalid_string,validation:{endsWith:i.value},message:i.message}),h.dirty()):"datetime"===i.kind?ea(i).test(a.data)||(dI(g=this._getOrReturnCtx(a,g),{code:dz.invalid_string,validation:"datetime",message:i.message}),h.dirty()):"date"===i.kind?d8.test(a.data)||(dI(g=this._getOrReturnCtx(a,g),{code:dz.invalid_string,validation:"date",message:i.message}),h.dirty()):"time"===i.kind?RegExp(`^${d9(i)}$`).test(a.data)||(dI(g=this._getOrReturnCtx(a,g),{code:dz.invalid_string,validation:"time",message:i.message}),h.dirty()):"duration"===i.kind?d_.test(a.data)||(dI(g=this._getOrReturnCtx(a,g),{validation:"duration",code:dz.invalid_string,message:i.message}),h.dirty()):"ip"===i.kind?(b=a.data,!(("v4"===(c=i.version)||!c)&&d1.test(b)||("v6"===c||!c)&&d3.test(b))&&1&&(dI(g=this._getOrReturnCtx(a,g),{validation:"ip",code:dz.invalid_string,message:i.message}),h.dirty())):"jwt"===i.kind?!function(a,b){if(!d$.test(a))return!1;try{let[c]=a.split(".");if(!c)return!1;let d=c.replace(/-/g,"+").replace(/_/g,"/").padEnd(c.length+(4-c.length%4)%4,"="),e=JSON.parse(atob(d));if("object"!=typeof e||null===e||"typ"in e&&e?.typ!=="JWT"||!e.alg||b&&e.alg!==b)return!1;return!0}catch{return!1}}(a.data,i.alg)&&(dI(g=this._getOrReturnCtx(a,g),{validation:"jwt",code:dz.invalid_string,message:i.message}),h.dirty()):"cidr"===i.kind?(e=a.data,!(("v4"===(f=i.version)||!f)&&d2.test(e)||("v6"===f||!f)&&d4.test(e))&&1&&(dI(g=this._getOrReturnCtx(a,g),{validation:"cidr",code:dz.invalid_string,message:i.message}),h.dirty())):"base64"===i.kind?d5.test(a.data)||(dI(g=this._getOrReturnCtx(a,g),{validation:"base64",code:dz.invalid_string,message:i.message}),h.dirty()):"base64url"===i.kind?d6.test(a.data)||(dI(g=this._getOrReturnCtx(a,g),{validation:"base64url",code:dz.invalid_string,message:i.message}),h.dirty()):C.assertNever(i);return{status:h.value,value:a.data}}_regex(a,b,c){return this.refinement(b=>a.test(b),{validation:b,code:dz.invalid_string,...E.errToObj(c)})}_addCheck(a){return new eb({...this._def,checks:[...this._def.checks,a]})}email(a){return this._addCheck({kind:"email",...E.errToObj(a)})}url(a){return this._addCheck({kind:"url",...E.errToObj(a)})}emoji(a){return this._addCheck({kind:"emoji",...E.errToObj(a)})}uuid(a){return this._addCheck({kind:"uuid",...E.errToObj(a)})}nanoid(a){return this._addCheck({kind:"nanoid",...E.errToObj(a)})}cuid(a){return this._addCheck({kind:"cuid",...E.errToObj(a)})}cuid2(a){return this._addCheck({kind:"cuid2",...E.errToObj(a)})}ulid(a){return this._addCheck({kind:"ulid",...E.errToObj(a)})}base64(a){return this._addCheck({kind:"base64",...E.errToObj(a)})}base64url(a){return this._addCheck({kind:"base64url",...E.errToObj(a)})}jwt(a){return this._addCheck({kind:"jwt",...E.errToObj(a)})}ip(a){return this._addCheck({kind:"ip",...E.errToObj(a)})}cidr(a){return this._addCheck({kind:"cidr",...E.errToObj(a)})}datetime(a){return"string"==typeof a?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:a}):this._addCheck({kind:"datetime",precision:void 0===a?.precision?null:a?.precision,offset:a?.offset??!1,local:a?.local??!1,...E.errToObj(a?.message)})}date(a){return this._addCheck({kind:"date",message:a})}time(a){return"string"==typeof a?this._addCheck({kind:"time",precision:null,message:a}):this._addCheck({kind:"time",precision:void 0===a?.precision?null:a?.precision,...E.errToObj(a?.message)})}duration(a){return this._addCheck({kind:"duration",...E.errToObj(a)})}regex(a,b){return this._addCheck({kind:"regex",regex:a,...E.errToObj(b)})}includes(a,b){return this._addCheck({kind:"includes",value:a,position:b?.position,...E.errToObj(b?.message)})}startsWith(a,b){return this._addCheck({kind:"startsWith",value:a,...E.errToObj(b)})}endsWith(a,b){return this._addCheck({kind:"endsWith",value:a,...E.errToObj(b)})}min(a,b){return this._addCheck({kind:"min",value:a,...E.errToObj(b)})}max(a,b){return this._addCheck({kind:"max",value:a,...E.errToObj(b)})}length(a,b){return this._addCheck({kind:"length",value:a,...E.errToObj(b)})}nonempty(a){return this.min(1,E.errToObj(a))}trim(){return new eb({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new eb({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new eb({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(a=>"datetime"===a.kind)}get isDate(){return!!this._def.checks.find(a=>"date"===a.kind)}get isTime(){return!!this._def.checks.find(a=>"time"===a.kind)}get isDuration(){return!!this._def.checks.find(a=>"duration"===a.kind)}get isEmail(){return!!this._def.checks.find(a=>"email"===a.kind)}get isURL(){return!!this._def.checks.find(a=>"url"===a.kind)}get isEmoji(){return!!this._def.checks.find(a=>"emoji"===a.kind)}get isUUID(){return!!this._def.checks.find(a=>"uuid"===a.kind)}get isNANOID(){return!!this._def.checks.find(a=>"nanoid"===a.kind)}get isCUID(){return!!this._def.checks.find(a=>"cuid"===a.kind)}get isCUID2(){return!!this._def.checks.find(a=>"cuid2"===a.kind)}get isULID(){return!!this._def.checks.find(a=>"ulid"===a.kind)}get isIP(){return!!this._def.checks.find(a=>"ip"===a.kind)}get isCIDR(){return!!this._def.checks.find(a=>"cidr"===a.kind)}get isBase64(){return!!this._def.checks.find(a=>"base64"===a.kind)}get isBase64url(){return!!this._def.checks.find(a=>"base64url"===a.kind)}get minLength(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxLength(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}eb.create=a=>new eb({checks:[],typeName:F.ZodString,coerce:a?.coerce??!1,...dT(a)});class ec extends dU{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(a){let b;if(this._def.coerce&&(a.data=Number(a.data)),this._getType(a)!==dx.number){let b=this._getOrReturnCtx(a);return dI(b,{code:dz.invalid_type,expected:dx.number,received:b.parsedType}),dK}let c=new dJ;for(let d of this._def.checks)"int"===d.kind?C.isInteger(a.data)||(dI(b=this._getOrReturnCtx(a,b),{code:dz.invalid_type,expected:"integer",received:"float",message:d.message}),c.dirty()):"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(dI(b=this._getOrReturnCtx(a,b),{code:dz.too_small,minimum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(dI(b=this._getOrReturnCtx(a,b),{code:dz.too_big,maximum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"multipleOf"===d.kind?0!==function(a,b){let c=(a.toString().split(".")[1]||"").length,d=(b.toString().split(".")[1]||"").length,e=c>d?c:d;return Number.parseInt(a.toFixed(e).replace(".",""))%Number.parseInt(b.toFixed(e).replace(".",""))/10**e}(a.data,d.value)&&(dI(b=this._getOrReturnCtx(a,b),{code:dz.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):"finite"===d.kind?Number.isFinite(a.data)||(dI(b=this._getOrReturnCtx(a,b),{code:dz.not_finite,message:d.message}),c.dirty()):C.assertNever(d);return{status:c.value,value:a.data}}gte(a,b){return this.setLimit("min",a,!0,E.toString(b))}gt(a,b){return this.setLimit("min",a,!1,E.toString(b))}lte(a,b){return this.setLimit("max",a,!0,E.toString(b))}lt(a,b){return this.setLimit("max",a,!1,E.toString(b))}setLimit(a,b,c,d){return new ec({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:E.toString(d)}]})}_addCheck(a){return new ec({...this._def,checks:[...this._def.checks,a]})}int(a){return this._addCheck({kind:"int",message:E.toString(a)})}positive(a){return this._addCheck({kind:"min",value:0,inclusive:!1,message:E.toString(a)})}negative(a){return this._addCheck({kind:"max",value:0,inclusive:!1,message:E.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:0,inclusive:!0,message:E.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:0,inclusive:!0,message:E.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:E.toString(b)})}finite(a){return this._addCheck({kind:"finite",message:E.toString(a)})}safe(a){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:E.toString(a)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:E.toString(a)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}get isInt(){return!!this._def.checks.find(a=>"int"===a.kind||"multipleOf"===a.kind&&C.isInteger(a.value))}get isFinite(){let a=null,b=null;for(let c of this._def.checks)if("finite"===c.kind||"int"===c.kind||"multipleOf"===c.kind)return!0;else"min"===c.kind?(null===b||c.value>b)&&(b=c.value):"max"===c.kind&&(null===a||c.value<a)&&(a=c.value);return Number.isFinite(b)&&Number.isFinite(a)}}ec.create=a=>new ec({checks:[],typeName:F.ZodNumber,coerce:a?.coerce||!1,...dT(a)});class ed extends dU{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(a){let b;if(this._def.coerce)try{a.data=BigInt(a.data)}catch{return this._getInvalidInput(a)}if(this._getType(a)!==dx.bigint)return this._getInvalidInput(a);let c=new dJ;for(let d of this._def.checks)"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(dI(b=this._getOrReturnCtx(a,b),{code:dz.too_small,type:"bigint",minimum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(dI(b=this._getOrReturnCtx(a,b),{code:dz.too_big,type:"bigint",maximum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"multipleOf"===d.kind?a.data%d.value!==BigInt(0)&&(dI(b=this._getOrReturnCtx(a,b),{code:dz.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):C.assertNever(d);return{status:c.value,value:a.data}}_getInvalidInput(a){let b=this._getOrReturnCtx(a);return dI(b,{code:dz.invalid_type,expected:dx.bigint,received:b.parsedType}),dK}gte(a,b){return this.setLimit("min",a,!0,E.toString(b))}gt(a,b){return this.setLimit("min",a,!1,E.toString(b))}lte(a,b){return this.setLimit("max",a,!0,E.toString(b))}lt(a,b){return this.setLimit("max",a,!1,E.toString(b))}setLimit(a,b,c,d){return new ed({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:E.toString(d)}]})}_addCheck(a){return new ed({...this._def,checks:[...this._def.checks,a]})}positive(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:E.toString(a)})}negative(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:E.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:E.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:E.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:E.toString(b)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}ed.create=a=>new ed({checks:[],typeName:F.ZodBigInt,coerce:a?.coerce??!1,...dT(a)});class ee extends dU{_parse(a){if(this._def.coerce&&(a.data=!!a.data),this._getType(a)!==dx.boolean){let b=this._getOrReturnCtx(a);return dI(b,{code:dz.invalid_type,expected:dx.boolean,received:b.parsedType}),dK}return dM(a.data)}}ee.create=a=>new ee({typeName:F.ZodBoolean,coerce:a?.coerce||!1,...dT(a)});class ef extends dU{_parse(a){let b;if(this._def.coerce&&(a.data=new Date(a.data)),this._getType(a)!==dx.date){let b=this._getOrReturnCtx(a);return dI(b,{code:dz.invalid_type,expected:dx.date,received:b.parsedType}),dK}if(Number.isNaN(a.data.getTime()))return dI(this._getOrReturnCtx(a),{code:dz.invalid_date}),dK;let c=new dJ;for(let d of this._def.checks)"min"===d.kind?a.data.getTime()<d.value&&(dI(b=this._getOrReturnCtx(a,b),{code:dz.too_small,message:d.message,inclusive:!0,exact:!1,minimum:d.value,type:"date"}),c.dirty()):"max"===d.kind?a.data.getTime()>d.value&&(dI(b=this._getOrReturnCtx(a,b),{code:dz.too_big,message:d.message,inclusive:!0,exact:!1,maximum:d.value,type:"date"}),c.dirty()):C.assertNever(d);return{status:c.value,value:new Date(a.data.getTime())}}_addCheck(a){return new ef({...this._def,checks:[...this._def.checks,a]})}min(a,b){return this._addCheck({kind:"min",value:a.getTime(),message:E.toString(b)})}max(a,b){return this._addCheck({kind:"max",value:a.getTime(),message:E.toString(b)})}get minDate(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return null!=a?new Date(a):null}get maxDate(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return null!=a?new Date(a):null}}ef.create=a=>new ef({checks:[],coerce:a?.coerce||!1,typeName:F.ZodDate,...dT(a)});class eg extends dU{_parse(a){if(this._getType(a)!==dx.symbol){let b=this._getOrReturnCtx(a);return dI(b,{code:dz.invalid_type,expected:dx.symbol,received:b.parsedType}),dK}return dM(a.data)}}eg.create=a=>new eg({typeName:F.ZodSymbol,...dT(a)});class eh extends dU{_parse(a){if(this._getType(a)!==dx.undefined){let b=this._getOrReturnCtx(a);return dI(b,{code:dz.invalid_type,expected:dx.undefined,received:b.parsedType}),dK}return dM(a.data)}}eh.create=a=>new eh({typeName:F.ZodUndefined,...dT(a)});class ei extends dU{_parse(a){if(this._getType(a)!==dx.null){let b=this._getOrReturnCtx(a);return dI(b,{code:dz.invalid_type,expected:dx.null,received:b.parsedType}),dK}return dM(a.data)}}ei.create=a=>new ei({typeName:F.ZodNull,...dT(a)});class ej extends dU{constructor(){super(...arguments),this._any=!0}_parse(a){return dM(a.data)}}ej.create=a=>new ej({typeName:F.ZodAny,...dT(a)});class ek extends dU{constructor(){super(...arguments),this._unknown=!0}_parse(a){return dM(a.data)}}ek.create=a=>new ek({typeName:F.ZodUnknown,...dT(a)});class el extends dU{_parse(a){let b=this._getOrReturnCtx(a);return dI(b,{code:dz.invalid_type,expected:dx.never,received:b.parsedType}),dK}}el.create=a=>new el({typeName:F.ZodNever,...dT(a)});class em extends dU{_parse(a){if(this._getType(a)!==dx.undefined){let b=this._getOrReturnCtx(a);return dI(b,{code:dz.invalid_type,expected:dx.void,received:b.parsedType}),dK}return dM(a.data)}}em.create=a=>new em({typeName:F.ZodVoid,...dT(a)});class en extends dU{_parse(a){let{ctx:b,status:c}=this._processInputParams(a),d=this._def;if(b.parsedType!==dx.array)return dI(b,{code:dz.invalid_type,expected:dx.array,received:b.parsedType}),dK;if(null!==d.exactLength){let a=b.data.length>d.exactLength.value,e=b.data.length<d.exactLength.value;(a||e)&&(dI(b,{code:a?dz.too_big:dz.too_small,minimum:e?d.exactLength.value:void 0,maximum:a?d.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:d.exactLength.message}),c.dirty())}if(null!==d.minLength&&b.data.length<d.minLength.value&&(dI(b,{code:dz.too_small,minimum:d.minLength.value,type:"array",inclusive:!0,exact:!1,message:d.minLength.message}),c.dirty()),null!==d.maxLength&&b.data.length>d.maxLength.value&&(dI(b,{code:dz.too_big,maximum:d.maxLength.value,type:"array",inclusive:!0,exact:!1,message:d.maxLength.message}),c.dirty()),b.common.async)return Promise.all([...b.data].map((a,c)=>d.type._parseAsync(new dR(b,a,b.path,c)))).then(a=>dJ.mergeArray(c,a));let e=[...b.data].map((a,c)=>d.type._parseSync(new dR(b,a,b.path,c)));return dJ.mergeArray(c,e)}get element(){return this._def.type}min(a,b){return new en({...this._def,minLength:{value:a,message:E.toString(b)}})}max(a,b){return new en({...this._def,maxLength:{value:a,message:E.toString(b)}})}length(a,b){return new en({...this._def,exactLength:{value:a,message:E.toString(b)}})}nonempty(a){return this.min(1,a)}}en.create=(a,b)=>new en({type:a,minLength:null,maxLength:null,exactLength:null,typeName:F.ZodArray,...dT(b)});class eo extends dU{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let a=this._def.shape(),b=C.objectKeys(a);return this._cached={shape:a,keys:b},this._cached}_parse(a){if(this._getType(a)!==dx.object){let b=this._getOrReturnCtx(a);return dI(b,{code:dz.invalid_type,expected:dx.object,received:b.parsedType}),dK}let{status:b,ctx:c}=this._processInputParams(a),{shape:d,keys:e}=this._getCached(),f=[];if(!(this._def.catchall instanceof el&&"strip"===this._def.unknownKeys))for(let a in c.data)e.includes(a)||f.push(a);let g=[];for(let a of e){let b=d[a],e=c.data[a];g.push({key:{status:"valid",value:a},value:b._parse(new dR(c,e,c.path,a)),alwaysSet:a in c.data})}if(this._def.catchall instanceof el){let a=this._def.unknownKeys;if("passthrough"===a)for(let a of f)g.push({key:{status:"valid",value:a},value:{status:"valid",value:c.data[a]}});else if("strict"===a)f.length>0&&(dI(c,{code:dz.unrecognized_keys,keys:f}),b.dirty());else if("strip"===a);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let a=this._def.catchall;for(let b of f){let d=c.data[b];g.push({key:{status:"valid",value:b},value:a._parse(new dR(c,d,c.path,b)),alwaysSet:b in c.data})}}return c.common.async?Promise.resolve().then(async()=>{let a=[];for(let b of g){let c=await b.key,d=await b.value;a.push({key:c,value:d,alwaysSet:b.alwaysSet})}return a}).then(a=>dJ.mergeObjectSync(b,a)):dJ.mergeObjectSync(b,g)}get shape(){return this._def.shape()}strict(a){return E.errToObj,new eo({...this._def,unknownKeys:"strict",...void 0!==a?{errorMap:(b,c)=>{let d=this._def.errorMap?.(b,c).message??c.defaultError;return"unrecognized_keys"===b.code?{message:E.errToObj(a).message??d}:{message:d}}}:{}})}strip(){return new eo({...this._def,unknownKeys:"strip"})}passthrough(){return new eo({...this._def,unknownKeys:"passthrough"})}extend(a){return new eo({...this._def,shape:()=>({...this._def.shape(),...a})})}merge(a){return new eo({unknownKeys:a._def.unknownKeys,catchall:a._def.catchall,shape:()=>({...this._def.shape(),...a._def.shape()}),typeName:F.ZodObject})}setKey(a,b){return this.augment({[a]:b})}catchall(a){return new eo({...this._def,catchall:a})}pick(a){let b={};for(let c of C.objectKeys(a))a[c]&&this.shape[c]&&(b[c]=this.shape[c]);return new eo({...this._def,shape:()=>b})}omit(a){let b={};for(let c of C.objectKeys(this.shape))a[c]||(b[c]=this.shape[c]);return new eo({...this._def,shape:()=>b})}deepPartial(){return function a(b){if(b instanceof eo){let c={};for(let d in b.shape){let e=b.shape[d];c[d]=eF.create(a(e))}return new eo({...b._def,shape:()=>c})}if(b instanceof en)return new en({...b._def,type:a(b.element)});if(b instanceof eF)return eF.create(a(b.unwrap()));if(b instanceof eG)return eG.create(a(b.unwrap()));if(b instanceof et)return et.create(b.items.map(b=>a(b)));else return b}(this)}partial(a){let b={};for(let c of C.objectKeys(this.shape)){let d=this.shape[c];a&&!a[c]?b[c]=d:b[c]=d.optional()}return new eo({...this._def,shape:()=>b})}required(a){let b={};for(let c of C.objectKeys(this.shape))if(a&&!a[c])b[c]=this.shape[c];else{let a=this.shape[c];for(;a instanceof eF;)a=a._def.innerType;b[c]=a}return new eo({...this._def,shape:()=>b})}keyof(){return eA(C.objectKeys(this.shape))}}eo.create=(a,b)=>new eo({shape:()=>a,unknownKeys:"strip",catchall:el.create(),typeName:F.ZodObject,...dT(b)}),eo.strictCreate=(a,b)=>new eo({shape:()=>a,unknownKeys:"strict",catchall:el.create(),typeName:F.ZodObject,...dT(b)}),eo.lazycreate=(a,b)=>new eo({shape:a,unknownKeys:"strip",catchall:el.create(),typeName:F.ZodObject,...dT(b)});class ep extends dU{_parse(a){let{ctx:b}=this._processInputParams(a),c=this._def.options;if(b.common.async)return Promise.all(c.map(async a=>{let c={...b,common:{...b.common,issues:[]},parent:null};return{result:await a._parseAsync({data:b.data,path:b.path,parent:c}),ctx:c}})).then(function(a){for(let b of a)if("valid"===b.result.status)return b.result;for(let c of a)if("dirty"===c.result.status)return b.common.issues.push(...c.ctx.common.issues),c.result;let c=a.map(a=>new dB(a.ctx.common.issues));return dI(b,{code:dz.invalid_union,unionErrors:c}),dK});{let a,d=[];for(let e of c){let c={...b,common:{...b.common,issues:[]},parent:null},f=e._parseSync({data:b.data,path:b.path,parent:c});if("valid"===f.status)return f;"dirty"!==f.status||a||(a={result:f,ctx:c}),c.common.issues.length&&d.push(c.common.issues)}if(a)return b.common.issues.push(...a.ctx.common.issues),a.result;let e=d.map(a=>new dB(a));return dI(b,{code:dz.invalid_union,unionErrors:e}),dK}}get options(){return this._def.options}}ep.create=(a,b)=>new ep({options:a,typeName:F.ZodUnion,...dT(b)});let eq=a=>{if(a instanceof ey)return eq(a.schema);if(a instanceof eE)return eq(a.innerType());if(a instanceof ez)return[a.value];if(a instanceof eB)return a.options;if(a instanceof eC)return C.objectValues(a.enum);else if(a instanceof eH)return eq(a._def.innerType);else if(a instanceof eh)return[void 0];else if(a instanceof ei)return[null];else if(a instanceof eF)return[void 0,...eq(a.unwrap())];else if(a instanceof eG)return[null,...eq(a.unwrap())];else if(a instanceof eL)return eq(a.unwrap());else if(a instanceof eN)return eq(a.unwrap());else if(a instanceof eI)return eq(a._def.innerType);else return[]};class er extends dU{_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==dx.object)return dI(b,{code:dz.invalid_type,expected:dx.object,received:b.parsedType}),dK;let c=this.discriminator,d=b.data[c],e=this.optionsMap.get(d);return e?b.common.async?e._parseAsync({data:b.data,path:b.path,parent:b}):e._parseSync({data:b.data,path:b.path,parent:b}):(dI(b,{code:dz.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[c]}),dK)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(a,b,c){let d=new Map;for(let c of b){let b=eq(c.shape[a]);if(!b.length)throw Error(`A discriminator value for key \`${a}\` could not be extracted from all schema options`);for(let e of b){if(d.has(e))throw Error(`Discriminator property ${String(a)} has duplicate value ${String(e)}`);d.set(e,c)}}return new er({typeName:F.ZodDiscriminatedUnion,discriminator:a,options:b,optionsMap:d,...dT(c)})}}class es extends dU{_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=(a,d)=>{if(dN(a)||dN(d))return dK;let e=function a(b,c){let d=dy(b),e=dy(c);if(b===c)return{valid:!0,data:b};if(d===dx.object&&e===dx.object){let d=C.objectKeys(c),e=C.objectKeys(b).filter(a=>-1!==d.indexOf(a)),f={...b,...c};for(let d of e){let e=a(b[d],c[d]);if(!e.valid)return{valid:!1};f[d]=e.data}return{valid:!0,data:f}}if(d===dx.array&&e===dx.array){if(b.length!==c.length)return{valid:!1};let d=[];for(let e=0;e<b.length;e++){let f=a(b[e],c[e]);if(!f.valid)return{valid:!1};d.push(f.data)}return{valid:!0,data:d}}if(d===dx.date&&e===dx.date&&+b==+c)return{valid:!0,data:b};return{valid:!1}}(a.value,d.value);return e.valid?((dO(a)||dO(d))&&b.dirty(),{status:b.value,value:e.data}):(dI(c,{code:dz.invalid_intersection_types}),dK)};return c.common.async?Promise.all([this._def.left._parseAsync({data:c.data,path:c.path,parent:c}),this._def.right._parseAsync({data:c.data,path:c.path,parent:c})]).then(([a,b])=>d(a,b)):d(this._def.left._parseSync({data:c.data,path:c.path,parent:c}),this._def.right._parseSync({data:c.data,path:c.path,parent:c}))}}es.create=(a,b,c)=>new es({left:a,right:b,typeName:F.ZodIntersection,...dT(c)});class et extends dU{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==dx.array)return dI(c,{code:dz.invalid_type,expected:dx.array,received:c.parsedType}),dK;if(c.data.length<this._def.items.length)return dI(c,{code:dz.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),dK;!this._def.rest&&c.data.length>this._def.items.length&&(dI(c,{code:dz.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),b.dirty());let d=[...c.data].map((a,b)=>{let d=this._def.items[b]||this._def.rest;return d?d._parse(new dR(c,a,c.path,b)):null}).filter(a=>!!a);return c.common.async?Promise.all(d).then(a=>dJ.mergeArray(b,a)):dJ.mergeArray(b,d)}get items(){return this._def.items}rest(a){return new et({...this._def,rest:a})}}et.create=(a,b)=>{if(!Array.isArray(a))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new et({items:a,typeName:F.ZodTuple,rest:null,...dT(b)})};class eu extends dU{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==dx.object)return dI(c,{code:dz.invalid_type,expected:dx.object,received:c.parsedType}),dK;let d=[],e=this._def.keyType,f=this._def.valueType;for(let a in c.data)d.push({key:e._parse(new dR(c,a,c.path,a)),value:f._parse(new dR(c,c.data[a],c.path,a)),alwaysSet:a in c.data});return c.common.async?dJ.mergeObjectAsync(b,d):dJ.mergeObjectSync(b,d)}get element(){return this._def.valueType}static create(a,b,c){return new eu(b instanceof dU?{keyType:a,valueType:b,typeName:F.ZodRecord,...dT(c)}:{keyType:eb.create(),valueType:a,typeName:F.ZodRecord,...dT(b)})}}class ev extends dU{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==dx.map)return dI(c,{code:dz.invalid_type,expected:dx.map,received:c.parsedType}),dK;let d=this._def.keyType,e=this._def.valueType,f=[...c.data.entries()].map(([a,b],f)=>({key:d._parse(new dR(c,a,c.path,[f,"key"])),value:e._parse(new dR(c,b,c.path,[f,"value"]))}));if(c.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of f){let d=await c.key,e=await c.value;if("aborted"===d.status||"aborted"===e.status)return dK;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}})}{let a=new Map;for(let c of f){let d=c.key,e=c.value;if("aborted"===d.status||"aborted"===e.status)return dK;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}}}}ev.create=(a,b,c)=>new ev({valueType:b,keyType:a,typeName:F.ZodMap,...dT(c)});class ew extends dU{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==dx.set)return dI(c,{code:dz.invalid_type,expected:dx.set,received:c.parsedType}),dK;let d=this._def;null!==d.minSize&&c.data.size<d.minSize.value&&(dI(c,{code:dz.too_small,minimum:d.minSize.value,type:"set",inclusive:!0,exact:!1,message:d.minSize.message}),b.dirty()),null!==d.maxSize&&c.data.size>d.maxSize.value&&(dI(c,{code:dz.too_big,maximum:d.maxSize.value,type:"set",inclusive:!0,exact:!1,message:d.maxSize.message}),b.dirty());let e=this._def.valueType;function f(a){let c=new Set;for(let d of a){if("aborted"===d.status)return dK;"dirty"===d.status&&b.dirty(),c.add(d.value)}return{status:b.value,value:c}}let g=[...c.data.values()].map((a,b)=>e._parse(new dR(c,a,c.path,b)));return c.common.async?Promise.all(g).then(a=>f(a)):f(g)}min(a,b){return new ew({...this._def,minSize:{value:a,message:E.toString(b)}})}max(a,b){return new ew({...this._def,maxSize:{value:a,message:E.toString(b)}})}size(a,b){return this.min(a,b).max(a,b)}nonempty(a){return this.min(1,a)}}ew.create=(a,b)=>new ew({valueType:a,minSize:null,maxSize:null,typeName:F.ZodSet,...dT(b)});class ex extends dU{constructor(){super(...arguments),this.validate=this.implement}_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==dx.function)return dI(b,{code:dz.invalid_type,expected:dx.function,received:b.parsedType}),dK;function c(a,c){return dG({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,dD,dC].filter(a=>!!a),issueData:{code:dz.invalid_arguments,argumentsError:c}})}function d(a,c){return dG({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,dD,dC].filter(a=>!!a),issueData:{code:dz.invalid_return_type,returnTypeError:c}})}let e={errorMap:b.common.contextualErrorMap},f=b.data;if(this._def.returns instanceof eD){let a=this;return dM(async function(...b){let g=new dB([]),h=await a._def.args.parseAsync(b,e).catch(a=>{throw g.addIssue(c(b,a)),g}),i=await Reflect.apply(f,this,h);return await a._def.returns._def.type.parseAsync(i,e).catch(a=>{throw g.addIssue(d(i,a)),g})})}{let a=this;return dM(function(...b){let g=a._def.args.safeParse(b,e);if(!g.success)throw new dB([c(b,g.error)]);let h=Reflect.apply(f,this,g.data),i=a._def.returns.safeParse(h,e);if(!i.success)throw new dB([d(h,i.error)]);return i.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...a){return new ex({...this._def,args:et.create(a).rest(ek.create())})}returns(a){return new ex({...this._def,returns:a})}implement(a){return this.parse(a)}strictImplement(a){return this.parse(a)}static create(a,b,c){return new ex({args:a||et.create([]).rest(ek.create()),returns:b||ek.create(),typeName:F.ZodFunction,...dT(c)})}}class ey extends dU{get schema(){return this._def.getter()}_parse(a){let{ctx:b}=this._processInputParams(a);return this._def.getter()._parse({data:b.data,path:b.path,parent:b})}}ey.create=(a,b)=>new ey({getter:a,typeName:F.ZodLazy,...dT(b)});class ez extends dU{_parse(a){if(a.data!==this._def.value){let b=this._getOrReturnCtx(a);return dI(b,{received:b.data,code:dz.invalid_literal,expected:this._def.value}),dK}return{status:"valid",value:a.data}}get value(){return this._def.value}}function eA(a,b){return new eB({values:a,typeName:F.ZodEnum,...dT(b)})}ez.create=(a,b)=>new ez({value:a,typeName:F.ZodLiteral,...dT(b)});class eB extends dU{_parse(a){if("string"!=typeof a.data){let b=this._getOrReturnCtx(a),c=this._def.values;return dI(b,{expected:C.joinValues(c),received:b.parsedType,code:dz.invalid_type}),dK}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(a.data)){let b=this._getOrReturnCtx(a),c=this._def.values;return dI(b,{received:b.data,code:dz.invalid_enum_value,options:c}),dK}return dM(a.data)}get options(){return this._def.values}get enum(){let a={};for(let b of this._def.values)a[b]=b;return a}get Values(){let a={};for(let b of this._def.values)a[b]=b;return a}get Enum(){let a={};for(let b of this._def.values)a[b]=b;return a}extract(a,b=this._def){return eB.create(a,{...this._def,...b})}exclude(a,b=this._def){return eB.create(this.options.filter(b=>!a.includes(b)),{...this._def,...b})}}eB.create=eA;class eC extends dU{_parse(a){let b=C.getValidEnumValues(this._def.values),c=this._getOrReturnCtx(a);if(c.parsedType!==dx.string&&c.parsedType!==dx.number){let a=C.objectValues(b);return dI(c,{expected:C.joinValues(a),received:c.parsedType,code:dz.invalid_type}),dK}if(this._cache||(this._cache=new Set(C.getValidEnumValues(this._def.values))),!this._cache.has(a.data)){let a=C.objectValues(b);return dI(c,{received:c.data,code:dz.invalid_enum_value,options:a}),dK}return dM(a.data)}get enum(){return this._def.values}}eC.create=(a,b)=>new eC({values:a,typeName:F.ZodNativeEnum,...dT(b)});class eD extends dU{unwrap(){return this._def.type}_parse(a){let{ctx:b}=this._processInputParams(a);return b.parsedType!==dx.promise&&!1===b.common.async?(dI(b,{code:dz.invalid_type,expected:dx.promise,received:b.parsedType}),dK):dM((b.parsedType===dx.promise?b.data:Promise.resolve(b.data)).then(a=>this._def.type.parseAsync(a,{path:b.path,errorMap:b.common.contextualErrorMap})))}}eD.create=(a,b)=>new eD({type:a,typeName:F.ZodPromise,...dT(b)});class eE extends dU{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===F.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=this._def.effect||null,e={addIssue:a=>{dI(c,a),a.fatal?b.abort():b.dirty()},get path(){return c.path}};if(e.addIssue=e.addIssue.bind(e),"preprocess"===d.type){let a=d.transform(c.data,e);if(c.common.async)return Promise.resolve(a).then(async a=>{if("aborted"===b.value)return dK;let d=await this._def.schema._parseAsync({data:a,path:c.path,parent:c});return"aborted"===d.status?dK:"dirty"===d.status||"dirty"===b.value?dL(d.value):d});{if("aborted"===b.value)return dK;let d=this._def.schema._parseSync({data:a,path:c.path,parent:c});return"aborted"===d.status?dK:"dirty"===d.status||"dirty"===b.value?dL(d.value):d}}if("refinement"===d.type){let a=a=>{let b=d.refinement(a,e);if(c.common.async)return Promise.resolve(b);if(b instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(c=>"aborted"===c.status?dK:("dirty"===c.status&&b.dirty(),a(c.value).then(()=>({status:b.value,value:c.value}))));{let d=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===d.status?dK:("dirty"===d.status&&b.dirty(),a(d.value),{status:b.value,value:d.value})}}if("transform"===d.type)if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(a=>dP(a)?Promise.resolve(d.transform(a.value,e)).then(a=>({status:b.value,value:a})):dK);else{let a=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});if(!dP(a))return dK;let f=d.transform(a.value,e);if(f instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:b.value,value:f}}C.assertNever(d)}}eE.create=(a,b,c)=>new eE({schema:a,typeName:F.ZodEffects,effect:b,...dT(c)}),eE.createWithPreprocess=(a,b,c)=>new eE({schema:b,effect:{type:"preprocess",transform:a},typeName:F.ZodEffects,...dT(c)});class eF extends dU{_parse(a){return this._getType(a)===dx.undefined?dM(void 0):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}eF.create=(a,b)=>new eF({innerType:a,typeName:F.ZodOptional,...dT(b)});class eG extends dU{_parse(a){return this._getType(a)===dx.null?dM(null):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}eG.create=(a,b)=>new eG({innerType:a,typeName:F.ZodNullable,...dT(b)});class eH extends dU{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return b.parsedType===dx.undefined&&(c=this._def.defaultValue()),this._def.innerType._parse({data:c,path:b.path,parent:b})}removeDefault(){return this._def.innerType}}eH.create=(a,b)=>new eH({innerType:a,typeName:F.ZodDefault,defaultValue:"function"==typeof b.default?b.default:()=>b.default,...dT(b)});class eI extends dU{_parse(a){let{ctx:b}=this._processInputParams(a),c={...b,common:{...b.common,issues:[]}},d=this._def.innerType._parse({data:c.data,path:c.path,parent:{...c}});return dQ(d)?d.then(a=>({status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new dB(c.common.issues)},input:c.data})})):{status:"valid",value:"valid"===d.status?d.value:this._def.catchValue({get error(){return new dB(c.common.issues)},input:c.data})}}removeCatch(){return this._def.innerType}}eI.create=(a,b)=>new eI({innerType:a,typeName:F.ZodCatch,catchValue:"function"==typeof b.catch?b.catch:()=>b.catch,...dT(b)});class eJ extends dU{_parse(a){if(this._getType(a)!==dx.nan){let b=this._getOrReturnCtx(a);return dI(b,{code:dz.invalid_type,expected:dx.nan,received:b.parsedType}),dK}return{status:"valid",value:a.data}}}eJ.create=a=>new eJ({typeName:F.ZodNaN,...dT(a)});let eK=Symbol("zod_brand");class eL extends dU{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return this._def.type._parse({data:c,path:b.path,parent:b})}unwrap(){return this._def.type}}class eM extends dU{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.common.async)return(async()=>{let a=await this._def.in._parseAsync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?dK:"dirty"===a.status?(b.dirty(),dL(a.value)):this._def.out._parseAsync({data:a.value,path:c.path,parent:c})})();{let a=this._def.in._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?dK:"dirty"===a.status?(b.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:c.path,parent:c})}}static create(a,b){return new eM({in:a,out:b,typeName:F.ZodPipeline})}}class eN extends dU{_parse(a){let b=this._def.innerType._parse(a),c=a=>(dP(a)&&(a.value=Object.freeze(a.value)),a);return dQ(b)?b.then(a=>c(a)):c(b)}unwrap(){return this._def.innerType}}function eO(a,b){let c="function"==typeof a?a(b):"string"==typeof a?{message:a}:a;return"string"==typeof c?{message:c}:c}function eP(a,b={},c){return a?ej.create().superRefine((d,e)=>{let f=a(d);if(f instanceof Promise)return f.then(a=>{if(!a){let a=eO(b,d),f=a.fatal??c??!0;e.addIssue({code:"custom",...a,fatal:f})}});if(!f){let a=eO(b,d),f=a.fatal??c??!0;e.addIssue({code:"custom",...a,fatal:f})}}):ej.create()}eN.create=(a,b)=>new eN({innerType:a,typeName:F.ZodReadonly,...dT(b)});let eQ={object:eo.lazycreate};(q=F||(F={})).ZodString="ZodString",q.ZodNumber="ZodNumber",q.ZodNaN="ZodNaN",q.ZodBigInt="ZodBigInt",q.ZodBoolean="ZodBoolean",q.ZodDate="ZodDate",q.ZodSymbol="ZodSymbol",q.ZodUndefined="ZodUndefined",q.ZodNull="ZodNull",q.ZodAny="ZodAny",q.ZodUnknown="ZodUnknown",q.ZodNever="ZodNever",q.ZodVoid="ZodVoid",q.ZodArray="ZodArray",q.ZodObject="ZodObject",q.ZodUnion="ZodUnion",q.ZodDiscriminatedUnion="ZodDiscriminatedUnion",q.ZodIntersection="ZodIntersection",q.ZodTuple="ZodTuple",q.ZodRecord="ZodRecord",q.ZodMap="ZodMap",q.ZodSet="ZodSet",q.ZodFunction="ZodFunction",q.ZodLazy="ZodLazy",q.ZodLiteral="ZodLiteral",q.ZodEnum="ZodEnum",q.ZodEffects="ZodEffects",q.ZodNativeEnum="ZodNativeEnum",q.ZodOptional="ZodOptional",q.ZodNullable="ZodNullable",q.ZodDefault="ZodDefault",q.ZodCatch="ZodCatch",q.ZodPromise="ZodPromise",q.ZodBranded="ZodBranded",q.ZodPipeline="ZodPipeline",q.ZodReadonly="ZodReadonly";let eR=(a,b={message:`Input not instance of ${a.name}`})=>eP(b=>b instanceof a,b),eS=eb.create,eT=ec.create,eU=eJ.create,eV=ed.create,eW=ee.create,eX=ef.create,eY=eg.create,eZ=eh.create,e$=ei.create,e_=ej.create,e0=ek.create,e1=el.create,e2=em.create,e3=en.create,e4=eo.create,e5=eo.strictCreate,e6=ep.create,e7=er.create,e8=es.create,e9=et.create,fa=eu.create,fb=ev.create,fc=ew.create,fd=ex.create,fe=ey.create,ff=ez.create,fg=eB.create,fh=eC.create,fi=eD.create,fj=eE.create,fk=eF.create,fl=eG.create,fm=eE.createWithPreprocess,fn=eM.create,fo=()=>eS().optional(),fp=()=>eT().optional(),fq=()=>eW().optional(),fr={string:a=>eb.create({...a,coerce:!0}),number:a=>ec.create({...a,coerce:!0}),boolean:a=>ee.create({...a,coerce:!0}),bigint:a=>ed.create({...a,coerce:!0}),date:a=>ef.create({...a,coerce:!0})};a.s(["BRAND",0,eK,"NEVER",0,dK,"Schema",()=>dU,"ZodAny",()=>ej,"ZodArray",()=>en,"ZodBigInt",()=>ed,"ZodBoolean",()=>ee,"ZodBranded",()=>eL,"ZodCatch",()=>eI,"ZodDate",()=>ef,"ZodDefault",()=>eH,"ZodDiscriminatedUnion",()=>er,"ZodEffects",()=>eE,"ZodEnum",()=>eB,"ZodFirstPartyTypeKind",()=>F,"ZodFunction",()=>ex,"ZodIntersection",()=>es,"ZodLazy",()=>ey,"ZodLiteral",()=>ez,"ZodMap",()=>ev,"ZodNaN",()=>eJ,"ZodNativeEnum",()=>eC,"ZodNever",()=>el,"ZodNull",()=>ei,"ZodNullable",()=>eG,"ZodNumber",()=>ec,"ZodObject",()=>eo,"ZodOptional",()=>eF,"ZodPipeline",()=>eM,"ZodPromise",()=>eD,"ZodReadonly",()=>eN,"ZodRecord",()=>eu,"ZodSchema",()=>dU,"ZodSet",()=>ew,"ZodString",()=>eb,"ZodSymbol",()=>eg,"ZodTransformer",()=>eE,"ZodTuple",()=>et,"ZodType",()=>dU,"ZodUndefined",()=>eh,"ZodUnion",()=>ep,"ZodUnknown",()=>ek,"ZodVoid",()=>em,"any",()=>e_,"array",()=>e3,"bigint",()=>eV,"boolean",()=>eW,"coerce",0,fr,"custom",()=>eP,"date",()=>eX,"datetimeRegex",()=>ea,"discriminatedUnion",()=>e7,"effect",()=>fj,"enum",()=>fg,"function",()=>fd,"instanceof",()=>eR,"intersection",()=>e8,"late",0,eQ,"lazy",()=>fe,"literal",()=>ff,"map",()=>fb,"nan",()=>eU,"nativeEnum",()=>fh,"never",()=>e1,"null",()=>e$,"nullable",()=>fl,"number",()=>eT,"object",()=>e4,"oboolean",()=>fq,"onumber",()=>fp,"optional",()=>fk,"ostring",()=>fo,"pipeline",()=>fn,"preprocess",()=>fm,"promise",()=>fi,"record",()=>fa,"set",()=>fc,"strictObject",()=>e5,"string",()=>eS,"symbol",()=>eY,"transformer",()=>fj,"tuple",()=>e9,"undefined",()=>eZ,"union",()=>e6,"unknown",()=>e0,"void",()=>e2],71),a.i(71),a.i(2364),a.s(["BRAND",0,eK,"DIRTY",0,dL,"EMPTY_PATH",0,dH,"INVALID",0,dK,"NEVER",0,dK,"OK",0,dM,"ParseStatus",()=>dJ,"Schema",()=>dU,"ZodAny",()=>ej,"ZodArray",()=>en,"ZodBigInt",()=>ed,"ZodBoolean",()=>ee,"ZodBranded",()=>eL,"ZodCatch",()=>eI,"ZodDate",()=>ef,"ZodDefault",()=>eH,"ZodDiscriminatedUnion",()=>er,"ZodEffects",()=>eE,"ZodEnum",()=>eB,"ZodError",()=>dB,"ZodFirstPartyTypeKind",()=>F,"ZodFunction",()=>ex,"ZodIntersection",()=>es,"ZodIssueCode",0,dz,"ZodLazy",()=>ey,"ZodLiteral",()=>ez,"ZodMap",()=>ev,"ZodNaN",()=>eJ,"ZodNativeEnum",()=>eC,"ZodNever",()=>el,"ZodNull",()=>ei,"ZodNullable",()=>eG,"ZodNumber",()=>ec,"ZodObject",()=>eo,"ZodOptional",()=>eF,"ZodParsedType",0,dx,"ZodPipeline",()=>eM,"ZodPromise",()=>eD,"ZodReadonly",()=>eN,"ZodRecord",()=>eu,"ZodSchema",()=>dU,"ZodSet",()=>ew,"ZodString",()=>eb,"ZodSymbol",()=>eg,"ZodTransformer",()=>eE,"ZodTuple",()=>et,"ZodType",()=>dU,"ZodUndefined",()=>eh,"ZodUnion",()=>ep,"ZodUnknown",()=>ek,"ZodVoid",()=>em,"addIssueToContext",()=>dI,"any",()=>e_,"array",()=>e3,"bigint",()=>eV,"boolean",()=>eW,"coerce",0,fr,"custom",()=>eP,"date",()=>eX,"datetimeRegex",()=>ea,"defaultErrorMap",0,dC,"discriminatedUnion",()=>e7,"effect",()=>fj,"enum",()=>fg,"function",()=>fd,"getErrorMap",()=>dF,"getParsedType",0,dy,"instanceof",()=>eR,"intersection",()=>e8,"isAborted",0,dN,"isAsync",0,dQ,"isDirty",0,dO,"isValid",0,dP,"late",0,eQ,"lazy",()=>fe,"literal",()=>ff,"makeIssue",0,dG,"map",()=>fb,"nan",()=>eU,"nativeEnum",()=>fh,"never",()=>e1,"null",()=>e$,"nullable",()=>fl,"number",()=>eT,"object",()=>e4,"objectUtil",()=>D,"oboolean",()=>fq,"onumber",()=>fp,"optional",()=>fk,"ostring",()=>fo,"pipeline",()=>fn,"preprocess",()=>fm,"promise",()=>fi,"quotelessJson",0,dA,"record",()=>fa,"set",()=>fc,"setErrorMap",()=>dE,"strictObject",()=>e5,"string",()=>eS,"symbol",()=>eY,"transformer",()=>fj,"tuple",()=>e9,"undefined",()=>eZ,"union",()=>e6,"unknown",()=>e0,"util",()=>C,"void",()=>e2],54323);var fs=a.i(54323),fs=fs;let ft=fs.object({name:fs.string().min(2,"Name must be at least 2 characters").max(60,"Name is too long"),email:fs.string().email("Please enter a valid email address"),phone:fs.string().regex(/^\+?[\d\s\-().]{10,}$/,"Please enter a valid phone number"),password:fs.string().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Password must contain at least one uppercase letter").regex(/[0-9]/,"Password must contain at least one number"),profileType:fs.enum(["residential","business"]),preferredLanguage:fs.enum(["en","es"]).default("en"),businessName:fs.string().optional(),ein:fs.string().optional(),agreeToTerms:fs.boolean().refine(a=>!0===a,{message:"You must agree to the terms"})}),fu=a=>"business"!==a.profileType||!!a.businessName&&!!a.ein;ft.refine(fu,{message:"Business name and EIN are required for business accounts",path:["businessName"]});let fv=fs.object({email:fs.string().email("Please enter a valid email address"),password:fs.string().min(1,"Password is required")}),fw=fs.object({street:fs.string().min(5,"Please enter a valid street address"),apt:fs.string().optional(),city:fs.string().min(2,"City is required"),state:fs.string().length(2,"Please use 2-letter state code (e.g. NY)"),zip:fs.string().regex(/^\d{5}$/,"Please enter a valid 5-digit ZIP code"),instructions:fs.string().max(200,"Instructions too long").optional()}),fx=ft.extend({birthday:fs.string().min(1,"Birthday is required"),deliveryAddress:fw}).refine(fu,{message:"Business name and EIN are required for business accounts",path:["businessName"]});fs.object({deliveryAddress:fw,paymentMethodId:fs.string().min(1,"Please select a payment method"),saveAddress:fs.boolean().default(!1),notes:fs.string().max(200).optional()}),fs.object({customerPhone:fs.string().regex(/^\+?[\d\s\-().]{10,}$/,"Invalid phone number"),deliveryAddress:fw,items:fs.array(fs.object({productId:fs.string().uuid(),weightLbs:fs.enum(["10","20","30","40"]),quantity:fs.number().int().min(1).max(99)})).min(1,"Order must have at least one item"),paymentMethod:fs.enum(["card","cash_on_delivery"]),notes:fs.string().optional()}),a.s(["loginSchema",0,fv,"signupWithAddressSchema",0,fx],97855);var fy=a.i(53077),fz=a.i(39681);let fA=(0,G.forwardRef)(function({label:a,error:b,required:c,inputClassName:d,id:e,...f},g){let h=e??`field-${a.replace(/\s/g,"-").toLowerCase()}`;return(0,fy.jsxs)("div",{className:"w-full",children:[(0,fy.jsxs)("label",{htmlFor:h,className:"block text-xs font-semibold uppercase tracking-[0.06em] text-text-muted mb-1.5",children:[a,c&&(0,fy.jsx)("span",{className:"text-brand-sage ml-0.5",children:"*"})]}),(0,fy.jsx)("input",{ref:g,id:h,"aria-invalid":!!b,"aria-describedby":b?`${h}-error`:void 0,className:(0,fz.cn)("input",b&&"border-[color:var(--color-error)] focus:border-[color:var(--color-error)]",d),...f}),b&&(0,fy.jsx)("p",{id:`${h}-error`,role:"alert",className:"mt-1.5 text-sm text-[color:var(--color-error)]",children:b})]})});a.s(["FormField",0,fA],6354);let fB={sm:"w-6 h-6 border-2",md:"w-10 h-10 border-2",lg:"w-14 h-14 border-[3px]"},fC={sage:"border-brand-sage border-t-transparent",primary:"border-primary border-t-transparent",mint:"border-brand-mint border-t-transparent",white:"border-text-primary border-t-transparent"};function fD({size:a="md",color:b="sage",className:c}){return(0,fy.jsx)("div",{role:"status","aria-label":"Loading",className:(0,fz.cn)("rounded-full animate-spin",fB[a],fC[b],c)})}a.s(["Spinner",()=>fD],13820)}];

//# sourceMappingURL=db3c6_56526888._.js.map