{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/Developer/brasena/Brasena/apps/web/src/lib/env.ts"],"sourcesContent":["/**\n * Validates required environment variables at startup and exports a typed env object.\n * Uses static process.env.X references so Next.js inlines them in the client bundle.\n */\n\nfunction validateEnv(): {\n  NEXT_PUBLIC_SUPABASE_URL: string\n  NEXT_PUBLIC_SUPABASE_ANON_KEY: string\n  NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY: string\n} {\n  const url = process.env.NEXT_PUBLIC_SUPABASE_URL ?? \"\"\n  const anonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY ?? \"\"\n  const stripeKey = process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY ?? \"\"\n\n  if (url.trim() === \"\") {\n    throw new Error(\n      \"Missing required environment variable: NEXT_PUBLIC_SUPABASE_URL - check your .env.local file\"\n    )\n  }\n  if (anonKey.trim() === \"\") {\n    throw new Error(\n      \"Missing required environment variable: NEXT_PUBLIC_SUPABASE_ANON_KEY - check your .env.local file\"\n    )\n  }\n  if (stripeKey.trim() === \"\") {\n    throw new Error(\n      \"Missing required environment variable: NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY - check your .env.local file\"\n    )\n  }\n\n  if (!url.startsWith(\"https://\") || !url.includes(\".supabase.co\")) {\n    throw new Error(\n      \"NEXT_PUBLIC_SUPABASE_URL must be the Supabase API URL (e.g. https://YOUR_REF.supabase.co). Use Project Settings → API → Project URL in the dashboard, not the Postgres connection string.\"\n    )\n  }\n\n  if (typeof process !== \"undefined\" && process.env.NODE_ENV === \"development\") {\n    // eslint-disable-next-line no-console\n    console.log(\n      \"[Brasena] Env loaded: NEXT_PUBLIC_SUPABASE_URL, NEXT_PUBLIC_SUPABASE_ANON_KEY, NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY\"\n    )\n  }\n\n  return {\n    NEXT_PUBLIC_SUPABASE_URL: url.trim(),\n    NEXT_PUBLIC_SUPABASE_ANON_KEY: anonKey.trim(),\n    NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY: stripeKey.trim(),\n  }\n}\n\nexport const env = validateEnv()\n"],"names":[],"mappings":";;;;AAAA;;;CAGC,GAED,SAAS;IAKP,MAAM,MAAM,gFAAwC;IACpD,MAAM,UAAU,wPAA6C;IAC7D,MAAM,YAAY,2DAAkD;IAEpE,IAAI,IAAI,IAAI,OAAO,IAAI;QACrB,MAAM,IAAI,MACR;IAEJ;IACA,IAAI,QAAQ,IAAI,OAAO,IAAI;QACzB,MAAM,IAAI,MACR;IAEJ;IACA,IAAI,UAAU,IAAI,OAAO,IAAI;QAC3B,MAAM,IAAI,MACR;IAEJ;IAEA,IAAI,CAAC,IAAI,UAAU,CAAC,eAAe,CAAC,IAAI,QAAQ,CAAC,iBAAiB;QAChE,MAAM,IAAI,MACR;IAEJ;IAEA,IAAI,OAAO,YAAY,eAAe,oDAAyB,eAAe;QAC5E,sCAAsC;QACtC,QAAQ,GAAG,CACT;IAEJ;IAEA,OAAO;QACL,0BAA0B,IAAI,IAAI;QAClC,+BAA+B,QAAQ,IAAI;QAC3C,oCAAoC,UAAU,IAAI;IACpD;AACF;AAEO,MAAM,MAAM"}},
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/Developer/brasena/Brasena/apps/web/src/config/index.ts"],"sourcesContent":["// ─── Environment Variables ─────────────────────────────\n// All env vars flow through here. Never import process.env directly\n// in components - always use this config object instead.\n// Required vars are validated at boot via @/lib/env.\n\nimport { env } from \"@/lib/env\"\n\nexport const config = {\n  app: {\n    name: \"Brasena\",\n    url: process.env.NEXT_PUBLIC_APP_URL ?? \"http://localhost:3000\",\n    env: process.env.NODE_ENV ?? \"development\",\n  },\n\n  supabase: {\n    url: env.NEXT_PUBLIC_SUPABASE_URL,\n    anonKey: env.NEXT_PUBLIC_SUPABASE_ANON_KEY,\n  },\n\n  stripe: {\n    publishableKey: env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY,\n    // secretKey only on server - never expose to client\n  },\n\n  maps: {\n    mapboxToken: process.env.NEXT_PUBLIC_MAPBOX_TOKEN,\n  },\n\n  delivery: {\n    uberDirectEnabled: process.env.NEXT_PUBLIC_UBER_DIRECT_ENABLED === \"true\",\n    maxWeightForUber: 30, // lbs - orders over 30lb go to private van\n  },\n} as const\n\n// ─── Business Constants ────────────────────────────────\nexport const BUSINESS = {\n  // Bulk pricing thresholds (lbs)\n  WEIGHT_TIERS: [10, 20, 30, 40] as const,\n\n  // Order routing\n  DRIVER_NOTIFY_DELAY_MS: 7 * 60 * 1000, // 5-10 min delay after vendor confirms\n\n  // Operating hours (EST)\n  HOURS: { open: 6, close: 23 }, // 6 AM - 11 PM\n\n  // Geographic\n  INITIAL_BOROUGH: \"Bronx\",\n  SERVICE_ZIPCODES: [\n    \"10451\", \"10452\", \"10453\", \"10454\", \"10455\",\n    \"10456\", \"10457\", \"10458\", \"10459\", \"10460\",\n    \"10461\", \"10462\", \"10463\", \"10464\", \"10465\",\n    \"10466\", \"10467\", \"10468\", \"10469\", \"10470\",\n    \"10471\", \"10472\", \"10473\", \"10474\", \"10475\",\n  ],\n\n  // Product\n  MAX_PHASE_1_PRODUCTS: 25,\n  CATEGORIES: [\"Beef\", \"Pork\", \"Chicken\"] as const,\n} as const\n\n// ─── Route Constants ───────────────────────────────────\nexport const ROUTES = {\n  // Public\n  HOME:     \"/\",\n  LANGUAGE: \"/language\",\n  LOGIN:    \"/login\",\n  SIGNUP:   \"/signup\",\n\n  // Shop (authenticated)\n  SHOP:       \"/home\",\n  CATEGORIES: \"/categories\",\n  PRODUCTS:   (category: string) => `/categories/${category}`,\n  PRODUCT:    (slug: string) => `/products/${slug}`,\n  CART:       \"/cart\",\n  CHECKOUT:   \"/checkout\",\n\n  // Orders\n  ORDERS:      \"/orders\",\n  ORDER:       (id: string) => `/orders/${id}`,\n  ORDER_TRACK: (id: string) => `/orders/${id}/track`,\n\n  // Account\n  ACCOUNT: \"/account\",\n\n  // Vendor (iPad interface)\n  VENDOR_QUEUE:  \"/vendor/queue\",\n  VENDOR_ORDER:  (id: string) => `/vendor/orders/${id}`,\n\n  // Admin\n  ADMIN_DASHBOARD: \"/admin/dashboard\",\n  ADMIN_PRODUCTS:  \"/admin/products\",\n  ADMIN_ORDERS:    \"/admin/orders\",\n} as const\n\n// ─── Profile Types ─────────────────────────────────────\nexport type ProfileType = \"residential\" | \"business\"\nexport type UserRole = \"customer\" | \"vendor\" | \"driver\" | \"csr\" | \"admin\"\n\n// ─── Order Status ──────────────────────────────────────\nexport const ORDER_STATUS = {\n  PENDING:         \"pending\",\n  CONFIRMED:       \"confirmed\",\n  PREPARING:       \"preparing\",\n  OUT_FOR_DELIVERY:\"out_for_delivery\",\n  DELIVERED:       \"delivered\",\n  CANCELLED:       \"cancelled\",\n} as const\n\nexport type OrderStatus = typeof ORDER_STATUS[keyof typeof ORDER_STATUS]\n"],"names":[],"mappings":";;;;;;;;;;AAAA,0DAA0D;AAC1D,oEAAoE;AACpE,yDAAyD;AACzD,qDAAqD;AAErD;;AAEO,MAAM,SAAS;IACpB,KAAK;QACH,MAAM;QACN,KAAK,6DAAmC;QACxC,KAAK,mDAAwB;IAC/B;IAEA,UAAU;QACR,KAAK,kLAAG,CAAC,wBAAwB;QACjC,SAAS,kLAAG,CAAC,6BAA6B;IAC5C;IAEA,QAAQ;QACN,gBAAgB,kLAAG,CAAC,kCAAkC;IAExD;IAEA,MAAM;QACJ,WAAW;IACb;IAEA,UAAU;QACR,mBAAmB,8CAAgD;QACnE,kBAAkB;IACpB;AACF;AAGO,MAAM,WAAW;IACtB,gCAAgC;IAChC,cAAc;QAAC;QAAI;QAAI;QAAI;KAAG;IAE9B,gBAAgB;IAChB,wBAAwB,IAAI,KAAK;IAEjC,wBAAwB;IACxB,OAAO;QAAE,MAAM;QAAG,OAAO;IAAG;IAE5B,aAAa;IACb,iBAAiB;IACjB,kBAAkB;QAChB;QAAS;QAAS;QAAS;QAAS;QACpC;QAAS;QAAS;QAAS;QAAS;QACpC;QAAS;QAAS;QAAS;QAAS;QACpC;QAAS;QAAS;QAAS;QAAS;QACpC;QAAS;QAAS;QAAS;QAAS;KACrC;IAED,UAAU;IACV,sBAAsB;IACtB,YAAY;QAAC;QAAQ;QAAQ;KAAU;AACzC;AAGO,MAAM,SAAS;IACpB,SAAS;IACT,MAAU;IACV,UAAU;IACV,OAAU;IACV,QAAU;IAEV,uBAAuB;IACvB,MAAY;IACZ,YAAY;IACZ,UAAY,CAAC,WAAqB,CAAC,YAAY,EAAE,UAAU;IAC3D,SAAY,CAAC,OAAiB,CAAC,UAAU,EAAE,MAAM;IACjD,MAAY;IACZ,UAAY;IAEZ,SAAS;IACT,QAAa;IACb,OAAa,CAAC,KAAe,CAAC,QAAQ,EAAE,IAAI;IAC5C,aAAa,CAAC,KAAe,CAAC,QAAQ,EAAE,GAAG,MAAM,CAAC;IAElD,UAAU;IACV,SAAS;IAET,0BAA0B;IAC1B,cAAe;IACf,cAAe,CAAC,KAAe,CAAC,eAAe,EAAE,IAAI;IAErD,QAAQ;IACR,iBAAiB;IACjB,gBAAiB;IACjB,cAAiB;AACnB;AAOO,MAAM,eAAe;IAC1B,SAAiB;IACjB,WAAiB;IACjB,WAAiB;IACjB,kBAAiB;IACjB,WAAiB;IACjB,WAAiB;AACnB"}},
    {"offset": {"line": 182, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/Developer/brasena/Brasena/apps/web/src/lib/supabase/middleware.ts"],"sourcesContent":["/**\n * Supabase session refresh for Next.js middleware.\n * Exports updateSession so the root middleware can refresh the auth session\n * on every request (keeping tokens valid) without duplicating client/cookie logic.\n */\n\nimport { createServerClient } from \"@supabase/ssr\"\nimport { NextResponse, type NextRequest } from \"next/server\"\nimport type { Database } from \"@/types/supabase\"\nimport { config } from \"@/config\"\n\ntype CookieEntry = { name: string; value: string; options?: Record<string, unknown> }\n\nexport async function updateSession(\n  request: NextRequest\n): Promise<{ response: NextResponse; user: { id: string } | null }> {\n  let supabaseResponse = NextResponse.next({ request })\n\n  const supabase = createServerClient<Database>(\n    config.supabase.url,\n    config.supabase.anonKey,\n    {\n      cookies: {\n        getAll() {\n          return request.cookies.getAll()\n        },\n        setAll(cookiesToSet: CookieEntry[]) {\n          cookiesToSet.forEach(({ name, value }: CookieEntry) =>\n            request.cookies.set(name, value)\n          )\n          supabaseResponse = NextResponse.next({ request })\n          cookiesToSet.forEach(({ name, value, options }: CookieEntry) =>\n            supabaseResponse.cookies.set(name, value, options)\n          )\n        },\n      },\n    }\n  )\n\n  const {\n    data: { user },\n  } = await supabase.auth.getUser()\n\n  return {\n    response: supabaseResponse,\n    user: user ? { id: user.id } : null,\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;;;CAIC,GAED;AAAA;AACA;AAAA;AAEA;;;;AAIO,eAAe,cACpB,OAAoB;IAEpB,IAAI,mBAAmB,mOAAY,CAAC,IAAI,CAAC;QAAE;IAAQ;IAEnD,MAAM,WAAW,IAAA,0OAAkB,EACjC,0LAAM,CAAC,QAAQ,CAAC,GAAG,EACnB,0LAAM,CAAC,QAAQ,CAAC,OAAO,EACvB;QACE,SAAS;YACP;gBACE,OAAO,QAAQ,OAAO,CAAC,MAAM;YAC/B;YACA,QAAO,YAA2B;gBAChC,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAe,GAChD,QAAQ,OAAO,CAAC,GAAG,CAAC,MAAM;gBAE5B,mBAAmB,mOAAY,CAAC,IAAI,CAAC;oBAAE;gBAAQ;gBAC/C,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAe,GACzD,iBAAiB,OAAO,CAAC,GAAG,CAAC,MAAM,OAAO;YAE9C;QACF;IACF;IAGF,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACf,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IAE/B,OAAO;QACL,UAAU;QACV,MAAM,OAAO;YAAE,IAAI,KAAK,EAAE;QAAC,IAAI;IACjC;AACF"}},
    {"offset": {"line": 228, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/Developer/brasena/Brasena/apps/web/src/middleware.ts"],"sourcesContent":["/**\n * Middleware runs on every request BEFORE the page renders.\n * It does two things:\n * 1. Refreshes the Supabase auth session (prevents expiry) via updateSession\n * 2. Protects routes that require authentication\n *\n * Why middleware vs page-level auth checks:\n * Middleware runs at the edge (before any JS executes), so\n * unauthenticated users never see a flash of protected content.\n */\n\nimport { NextResponse, type NextRequest } from \"next/server\"\nimport { ROUTES } from \"@/config\"\nimport { updateSession } from \"@/lib/supabase/middleware\"\n\nexport async function middleware(request: NextRequest) {\n  const { response, user } = await updateSession(request)\n\n  const pathname = request.nextUrl.pathname\n\n  // ── Protected route groups ──────────────────────────\n  const isShopRoute =\n    pathname.startsWith(\"/home\") ||\n    pathname.startsWith(\"/categories\") ||\n    pathname.startsWith(\"/products\") ||\n    pathname.startsWith(\"/cart\") ||\n    pathname.startsWith(\"/checkout\") ||\n    pathname.startsWith(\"/orders\") ||\n    pathname.startsWith(\"/account\")\n\n  const isVendorRoute = pathname.startsWith(\"/vendor\")\n  const isAdminRoute = pathname.startsWith(\"/admin\")\n  const isAuthRoute =\n    pathname.startsWith(\"/login\") || pathname.startsWith(\"/signup\")\n\n  // ── Redirect unauthenticated users ─────────────────\n  if (!user && (isShopRoute || isVendorRoute || isAdminRoute)) {\n    const redirectUrl = request.nextUrl.clone()\n    redirectUrl.pathname = ROUTES.LOGIN\n    redirectUrl.searchParams.set(\"redirectTo\", pathname)\n    return NextResponse.redirect(redirectUrl)\n  }\n\n  // ── Redirect authenticated users away from auth pages ──\n  if (user && isAuthRoute) {\n    const redirectUrl = request.nextUrl.clone()\n    redirectUrl.pathname = ROUTES.SHOP\n    return NextResponse.redirect(redirectUrl)\n  }\n\n  return response\n}\n\nexport const config = {\n  matcher: [\n    \"/((?!_next/static|_next/image|favicon.ico|api/webhooks).*)\",\n  ],\n}\n"],"names":[],"mappings":";;;;;;AAAA;;;;;;;;;CASC,GAED;AAAA;AACA;AACA;;;;AAEO,eAAe,WAAW,OAAoB;IACnD,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,GAAG,MAAM,IAAA,+MAAa,EAAC;IAE/C,MAAM,WAAW,QAAQ,OAAO,CAAC,QAAQ;IAEzC,uDAAuD;IACvD,MAAM,cACJ,SAAS,UAAU,CAAC,YACpB,SAAS,UAAU,CAAC,kBACpB,SAAS,UAAU,CAAC,gBACpB,SAAS,UAAU,CAAC,YACpB,SAAS,UAAU,CAAC,gBACpB,SAAS,UAAU,CAAC,cACpB,SAAS,UAAU,CAAC;IAEtB,MAAM,gBAAgB,SAAS,UAAU,CAAC;IAC1C,MAAM,eAAe,SAAS,UAAU,CAAC;IACzC,MAAM,cACJ,SAAS,UAAU,CAAC,aAAa,SAAS,UAAU,CAAC;IAEvD,sDAAsD;IACtD,IAAI,CAAC,QAAQ,CAAC,eAAe,iBAAiB,YAAY,GAAG;QAC3D,MAAM,cAAc,QAAQ,OAAO,CAAC,KAAK;QACzC,YAAY,QAAQ,GAAG,0LAAM,CAAC,KAAK;QACnC,YAAY,YAAY,CAAC,GAAG,CAAC,cAAc;QAC3C,OAAO,mOAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,0DAA0D;IAC1D,IAAI,QAAQ,aAAa;QACvB,MAAM,cAAc,QAAQ,OAAO,CAAC,KAAK;QACzC,YAAY,QAAQ,GAAG,0LAAM,CAAC,IAAI;QAClC,OAAO,mOAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,OAAO;AACT;AAEO,MAAM,SAAS;IACpB,SAAS;QACP;KACD;AACH"}}]
}